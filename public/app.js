"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[260],{569:(t,e,a)=>{var r=a(538),n=a(530),i=a(783),o=a(669),s=a.n(o),l=a(381),c=a.n(l);const d=[{path:"/",redirect:"/receipts"},{path:"/receipts",name:"receipts",component:a(792).Z},{path:"/receipts/:id",name:"receipt",component:a(859).Z}];var m=a(345),p=(a(734),document.head.querySelector('meta[name="csrf-token"]'));s().defaults.headers.common["X-Requested-With"]="XMLHttpRequest",p&&(s().defaults.headers.common["X-CSRF-TOKEN"]=p.content),r.default.use(n.ZPm),r.default.use(i),r.default.use(m.Z),r.default.component("pagination",a(606)),window.FiscalRegistrar.basePath="/"+window.FiscalRegistrar.path,r.default.prototype.$http=s().create(),r.default.prototype.$moment=c(),r.default.prototype.FiscalRegistrar=window.FiscalRegistrar;var u=window.FiscalRegistrar.basePath+"/";""!==window.FiscalRegistrar.path&&"/"!==window.FiscalRegistrar.path||(u="/",window.FiscalRegistrar.basePath="");var b=new m.Z({routes:d,mode:"history",base:u});new r.default({el:"#fiscal-registrar",router:b,data:{message:"Welcome to Fiscal Registrar home page!"}})},225:(t,e,a)=>{a.d(e,{Z:()=>i});var r=a(519),n=a.n(r)()((function(t){return t[1]}));n.push([t.id,"fieldset[data-v-6d6bf957]{margin:0}",""]);const i=n},347:()=>{},859:(t,e,a)=>{a.d(e,{Z:()=>v});function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}const n={props:["item","disabled"],data:function(){return{paymentMethods:[{value:"full_prepayment",text:"предоплата 100%"},{value:"prepayment",text:"предоплата"},{value:"advance",text:"аванс"},{value:"full_payment",text:"полный расчет"},{value:"partial_payment",text:"частичный расчет и кредит"},{value:"credit",text:"передача в кредит"},{value:"credit_payment",text:"оплата кредита"}],paymentObjects:[{value:"commodity",text:"товар"},{value:"excise",text:"подакцизный товар"},{value:"job",text:"работа"},{value:"service",text:"услуга"},{value:"gambling_bet",text:"ставка азартной игры"},{value:"gambling_prize",text:"выигрыш азартной игры"},{value:"lottery",text:"лотерейный билет"},{value:"lottery_prize",text:"выигрыш лотереи"},{value:"intellectual_activity",text:"предоставление результатов интеллектуальной деятельности"},{value:"payment",text:"платеж"},{value:"agent_commission",text:"агентское вознаграждение"},{value:"award",text:"взнос/штраф/вознаграждение/бонус"},{value:"composite",text:"составной предмет расчета"},{value:"another",text:"иной предмет расчета"},{value:"property_right",text:"имущественное право"},{value:"non-operating_gain",text:"внереализационный доход"},{value:"insurance_premium",text:"страховые взносы"},{value:"sales_tax",text:"торговый сбор"},{value:"resort_fee",text:"курортный сбор"},{value:"deposit",text:"залог"},{value:"expense",text:"расход"},{value:"pension_insurance_ip",text:"взносы на ОПС ИП"},{value:"pension_insurance",text:"взносы на ОПС"},{value:"medical_insurance_ip",text:"взносы на ОМС ИП"},{value:"medical_insurance",text:"взносы на ОМС"},{value:"social_insurance",text:"взносы на ОСС"},{value:"casino_payment",text:"платеж казино"}],vatTypes:[{value:"none",text:"нет"},{value:"vat0",text:"0%"},{value:"vat10",text:"10%"},{value:"vat18",text:"18%"},{value:"vat20",text:"20%"},{value:"vat110",text:"10/110"},{value:"vat118",text:"18/118"},{value:"vat120",text:"20/120"}],vatRates:{none:0,vat0:0,vat10:.1,vat18:.18,vat20:.2,vat110:10/110,vat118:18/118,vat120:20/120},agentTypes:[{value:null,text:"нет"},{value:"bank_paying_agent",text:"банковский платежный агент"},{value:"bank_paying_subagent",text:"банковский платежный субагент"},{value:"paying_agent",text:"платежный агент"},{value:"paying_subagent",text:"платежный субагент"},{value:"attorney",text:"поверенный"},{value:"commission_agent",text:"комиссионер"},{value:"another",text:"агент"}]}},methods:{extractVat:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.item.sum,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.item.vat.type;return parseFloat((t-t/(1+this.vatRates[e])).toFixed(2))},emptify:function(t){if(!t||"object"!==r(t))return t;for(var e in t)t[e]=this.emptify(t[e]),t[e]||(t[e]=null);return Object.values(t).every((function(t){return null===t}))&&(t=null),t}},computed:{id:function(){return this.$vnode.key+1},model:function(){return this.$deepModel(this.item)},vatSum:function(){return String(this.extractVat())},agentType:{get:function(){var t;return null!==(t=this.model["agent_info.type"])&&void 0!==t?t:null},set:function(t){this.model["agent_info.type"]=t}},payingAgentPhones:{get:function(){var t;return null===(t=this.model["agent_info.paying_agent.phones"])||void 0===t?void 0:t.join("\n")},set:function(t){t=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return null!=t&&""!==t})),this.model["agent_info.paying_agent.phones"]=t.length?t:null}},receivePaymentsOperatorPhones:{get:function(){var t;return null===(t=this.model["agent_info.receive_payments_operator.phones"])||void 0===t?void 0:t.join("\n")},set:function(t){t=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return null!=t&&""!==t})),this.model["agent_info.receive_payments_operator.phones"]=t.length?t:null}},moneyTransferOperatorPhones:{get:function(){var t;return null===(t=this.model["agent_info.money_transfer_operator.phones"])||void 0===t?void 0:t.join("\n")},set:function(t){t=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return null!=t&&""!==t})),this.model["agent_info.money_transfer_operator.phones"]=t.length?t:null}},supplierPhones:{get:function(){var t;return null===(t=this.model["supplier_info.phones"])||void 0===t?void 0:t.join("\n")},set:function(t){t=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return null!=t&&""!==t})),this.model["supplier_info.phones"]=t.length?t:null}}},watch:{"item.price":function(t){this.item.sum=t*this.item.quantity},"item.quantity":function(t){this.item.sum=this.item.price*t},"item.sum":function(t){this.item.vat.sum=this.extractVat(t,this.item.vat.type)},"item.vat.type":function(t){this.item.vat.sum=this.extractVat(this.item.sum,t)},"item.agent_info":{handler:function(t){this.item.agent_info=null===(null==t?void 0:t.type)?null:this.emptify(t)},deep:!0},"item.supplier_info":{handler:function(t){this.item.supplier_info=null===(null==t?void 0:t.type)?null:this.emptify(t)},deep:!0}}};var i=a(900);function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==a)return;var r,n,i=[],o=!0,s=!1;try{for(a=a.call(t);!(o=(r=a.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){s=!0,n=t}finally{try{o||null==a.return||a.return()}finally{if(s)throw n}}return i}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=c(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==a.return||a.return()}finally{if(s)throw i}}}}function c(t,e){if(t){if("string"==typeof t)return d(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}const m={components:{ReceiptItem:(0,i.Z)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"4",md:"6",sm:"12"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Наименование","label-for":"item"+t.id+"Name"}},[a("b-form-input",{attrs:{id:"item"+t.id+"Name",type:"text",size:"sm",required:"",disabled:t.disabled},model:{value:t.item.name,callback:function(e){t.$set(t.item,"name",e)},expression:"item.name"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Цена","label-for":"item"+t.id+"Price"}},[a("b-form-input",{attrs:{id:"item"+t.id+"Price",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0",required:"",disabled:t.disabled},model:{value:t.item.price,callback:function(e){t.$set(t.item,"price",e)},expression:"item.price"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Кол-во","label-for":"item"+t.id+"Quantity"}},[a("b-form-input",{attrs:{id:"item"+t.id+"Quantity",type:"number",min:".001",max:"99999.999",step:"any",size:"sm",placeholder:"1",required:"",disabled:t.disabled},model:{value:t.item.quantity,callback:function(e){t.$set(t.item,"quantity",e)},expression:"item.quantity"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Сумма","label-for":"item"+t.id+"Sum"}},[a("b-form-input",{attrs:{id:"item"+t.id+"Sum",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0",required:"",disabled:t.disabled},model:{value:t.item.sum,callback:function(e){t.$set(t.item,"sum",e)},expression:"item.sum"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[a("b-form-group",{attrs:{label:"Ед. изм.","label-for":"item"+t.id+"MeasurementUnit"}},[a("b-form-input",{attrs:{id:"item"+t.id+"MeasurementUnit",type:"text",size:"sm",placeholder:"шт.",maxlength:"16",disabled:t.disabled},model:{value:t.item.measurement_unit,callback:function(e){t.$set(t.item,"measurement_unit",e)},expression:"item.measurement_unit"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"2",sm:"4"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Способ расчета","label-for":"item"+t.id+"PaymentMethod"}},[a("b-form-select",{attrs:{id:"item"+t.id+"PaymentMethod",size:"sm",options:t.paymentMethods,disabled:t.disabled},model:{value:t.item.payment_method,callback:function(e){t.$set(t.item,"payment_method",e)},expression:"item.payment_method"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"2",sm:"4"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Предмет расчета","label-for":"item"+t.id+"PaymentObject"}},[a("b-form-select",{attrs:{id:"item"+t.id+"PaymentObject",size:"sm",options:t.paymentObjects,disabled:t.disabled},model:{value:t.item.payment_object,callback:function(e){t.$set(t.item,"payment_object",e)},expression:"item.payment_object"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[a("b-form-group",{staticClass:"required",attrs:{label:"НДС","label-for":"item"+t.id+"VatType"}},[a("b-form-select",{attrs:{id:"item"+t.id+"VatType",size:"sm",options:t.vatTypes,disabled:t.disabled},model:{value:t.item.vat.type,callback:function(e){t.$set(t.item.vat,"type",e)},expression:"item.vat.type"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[a("b-form-group",{attrs:{label:"Сумма НДС","label-for":"item"+t.id+"VatSum"}},[a("b-form-input",{attrs:{id:"item"+t.id+"VatSum",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:t.vatSum,disabled:t.disabled},model:{value:t.item.vat.sum,callback:function(e){t.$set(t.item.vat,"sum",e)},expression:"item.vat.sum"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Признак агента","label-for":"item"+t.id+"agentType"}},[a("b-form-select",{attrs:{id:"item"+t.id+"agentType",size:"sm",options:t.agentTypes,disabled:t.disabled},model:{value:t.agentType,callback:function(e){t.agentType=e},expression:"agentType"}})],1)],1),t._v(" "),a("b-col",{staticClass:"ml-auto mr-0",attrs:{"align-self":"end",lg:"1",md:"1",sm:"1"}},[a("b-form-group",{staticClass:"text-right"},[a("b-button",{attrs:{variant:"danger",size:"sm",title:"Удалить",disabled:t.disabled},on:{click:function(e){return t.$emit("remove")}}},[a("b",[t._v("×")])])],1)],1)],1),t._v(" "),null!==t.agentType?a("div",{staticClass:"accordion",attrs:{role:"tablist"}},[a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"item"+t.id+"payingAgent",expression:"'item' + id + 'payingAgent'"}],attrs:{block:""}},[t._v("Атрибуты платежного агента")])],1),t._v(" "),a("b-collapse",{attrs:{id:"item"+t.id+"payingAgent",accordion:"item"+t.id+"agentInfo",role:"tabpanel"}},[a("b-card-body",[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Наименование операции","label-for":"item"+t.id+"payingAgentOperation"}},[a("b-form-input",{attrs:{id:"item"+t.id+"payingAgentOperation",type:"text",size:"sm",disabled:t.disabled},model:{value:t.model["agent_info.paying_agent.operation"],callback:function(e){t.$set(t.model,"agent_info.paying_agent.operation",e)},expression:"model['agent_info.paying_agent.operation']"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"item"+t.id+"payingAgentPhones"}},[a("b-form-textarea",{attrs:{id:"item"+t.id+"payingAgentPhones",size:"sm","max-rows":"4",disabled:t.disabled},model:{value:t.payingAgentPhones,callback:function(e){t.payingAgentPhones=e},expression:"payingAgentPhones"}})],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"item"+t.id+"receivePaymentsOperator",expression:"'item' + id + 'receivePaymentsOperator'"}],attrs:{block:""}},[t._v("Атрибуты оператора по приему платежей")])],1),t._v(" "),a("b-collapse",{attrs:{id:"item"+t.id+"receivePaymentsOperator",accordion:"item"+t.id+"agentInfo",role:"tabpanel"}},[a("b-card-body",[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"item"+t.id+"receivePaymentsOperatorPhones"}},[a("b-form-textarea",{attrs:{id:"item"+t.id+"receivePaymentsOperatorPhones",size:"sm","max-rows":"4",disabled:t.disabled},model:{value:t.receivePaymentsOperatorPhones,callback:function(e){t.receivePaymentsOperatorPhones=e},expression:"receivePaymentsOperatorPhones"}})],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"item"+t.id+"moneyTransferOperator",expression:"'item' + id + 'moneyTransferOperator'"}],attrs:{block:""}},[t._v("Атрибуты оператора перевода")])],1),t._v(" "),a("b-collapse",{attrs:{id:"item"+t.id+"moneyTransferOperator",accordion:"item"+t.id+"agentInfo",role:"tabpanel"}},[a("b-card-body",[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"item"+t.id+"moneyTransferOperatorPhones"}},[a("b-form-textarea",{attrs:{id:"item"+t.id+"moneyTransferOperatorPhones",size:"sm","max-rows":"4",disabled:t.disabled},model:{value:t.moneyTransferOperatorPhones,callback:function(e){t.moneyTransferOperatorPhones=e},expression:"moneyTransferOperatorPhones"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Наименование","label-for":"item"+t.id+"moneyTransferOperatorName"}},[a("b-form-input",{attrs:{id:"item"+t.id+"moneyTransferOperatorName",type:"text",size:"sm",disabled:t.disabled},model:{value:t.model["agent_info.money_transfer_operator.name"],callback:function(e){t.$set(t.model,"agent_info.money_transfer_operator.name",e)},expression:"model['agent_info.money_transfer_operator.name']"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Адрес","label-for":"item"+t.id+"moneyTransferOperatorAddress"}},[a("b-form-input",{attrs:{id:"item"+t.id+"moneyTransferOperatorAddress",type:"text",size:"sm",disabled:t.disabled},model:{value:t.model["agent_info.money_transfer_operator.address"],callback:function(e){t.$set(t.model,"agent_info.money_transfer_operator.address",e)},expression:"model['agent_info.money_transfer_operator.address']"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"ИНН","label-for":"item"+t.id+"moneyTransferOperatorInn"}},[a("b-form-input",{attrs:{id:"item"+t.id+"moneyTransferOperatorInn",type:"text",size:"sm",disabled:t.disabled},model:{value:t.model["agent_info.money_transfer_operator.inn"],callback:function(e){t.$set(t.model,"agent_info.money_transfer_operator.inn",e)},expression:"model['agent_info.money_transfer_operator.inn']"}})],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"item"+t.id+"supplier",expression:"'item' + id + 'supplier'"}],attrs:{block:""}},[t._v("Атрибуты поставщика")])],1),t._v(" "),a("b-collapse",{attrs:{id:"item"+t.id+"supplier",accordion:"item"+t.id+"agentInfo",role:"tabpanel"}},[a("b-card-body",[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Телефон(ы)","label-for":"item"+t.id+"supplierPhones"}},[a("b-form-textarea",{attrs:{id:"item"+t.id+"supplierPhones",size:"sm","max-rows":"4",required:"",disabled:t.disabled},model:{value:t.supplierPhones,callback:function(e){t.supplierPhones=e},expression:"supplierPhones"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Наименование","label-for":"item"+t.id+"supplierName"}},[a("b-form-input",{attrs:{id:"item"+t.id+"supplierName",type:"text",size:"sm",disabled:t.disabled},model:{value:t.model["supplier_info.name"],callback:function(e){t.$set(t.model,"supplier_info.name",e)},expression:"model['supplier_info.name']"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"ИНН","label-for":"item"+t.id+"supplierInn"}},[a("b-form-input",{attrs:{id:"item"+t.id+"supplierInn",type:"text",size:"sm",disabled:t.disabled},model:{value:t.model["supplier_info.inn"],callback:function(e){t.$set(t.model,"supplier_info.inn",e)},expression:"model['supplier_info.inn']"}})],1)],1)],1)],1)],1)],1)],1)],1):t._e()],1)}),[],!1,null,null,null).exports},data:function(){return{ready:!1,showPreview:!1,receipt:{},agentTypes:[{value:null,text:"нет"},{value:"bank_paying_agent",text:"банковский платежный агент"},{value:"bank_paying_subagent",text:"банковский платежный субагент"},{value:"paying_agent",text:"платежный агент"},{value:"paying_subagent",text:"платежный субагент"},{value:"attorney",text:"поверенный"},{value:"commission_agent",text:"комиссионер"},{value:"another",text:"агент"}],connections:[],operations:[{value:"sell",text:"приход"},{value:"sell_refund",text:"возврат прихода"},{value:"buy",text:"расход"},{value:"buy_refund",text:"возврат расхода"}],taxSystems:[{value:null,text:"не выбрано"},{value:"osn",text:"общая система налогообложения"},{value:"usn_income",text:"упрощенная система налогообложения (доходы)"},{value:"usn_income_outcome",text:"упрощенная система налогообложения (доходы минус расходы)"},{value:"envd",text:"единый налог на вмененный доход"},{value:"esn",text:"единый сельскохозяйственный налог"},{value:"patent",text:"патентная система налогообложения"}],vats:{without_vat:null,with_vat0:null,vat10:null,vat20:null,vat110:null,vat120:null},vatRates:{none:0,vat0:0,vat10:.1,vat18:.18,vat20:.2,vat110:10/110,vat118:18/118,vat120:20/120},agentInfo:{type:null,paying_agent:{operation:null,phones:null},receive_payments_operator:{phones:null},money_transfer_operator:{phones:null,name:null,address:null,inn:null}}}},mounted:function(){this.loadReceipt(this.$route.params.id),this.enumConnections(),document.title="Fiscal Registrar - Receipt"},methods:{enumConnections:function(){var t=this;this.$http.get(FiscalRegistrar.basePath+"/api/v1/connection/").then((function(e){t.connections=e.data}))},loadReceipt:function(t){var e=this;this.ready=!1,this.$http.get(FiscalRegistrar.basePath+"/api/v1/receipts/"+t).then((function(t){e.receipt=t.data,e.ready=!0}))},saveReceipt:function(){this.$http.put(FiscalRegistrar.basePath+"/api/v1/receipts/"+this.receipt.id,this.receipt)},addItem:function(){this.receipt.data.items.push({agent_info:null,country_code:null,declaration_number:null,excise:null,measurement_unit:null,name:"",nomenclature_code:null,payment_method:"full_prepayment",payment_object:"commodity",price:null,quantity:1,sum:null,supplier_info:null,user_data:null,vat:{sum:null,type:"vat20"}})},removeItem:function(t){this.receipt.data.items.splice(t,1)},extractVat:function(t,e){return parseFloat((t-t/(1+this.vatRates[e])).toFixed(2))},getVats:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a={without_vat:0,with_vat0:0,vat10:0,vat20:0,vat110:0,vat120:0};if(e){var r,n=l(this.receipt.data.items);try{for(n.s();!(r=n.n()).done;){var i=r.value;switch(null!==(t=null==i?void 0:i.vat.type)&&void 0!==t?t:"none"){case"vat20":case"vat18":a.vat20+=this.extractVat(i.sum,i.vat.type);break;case"vat10":a.vat10+=this.extractVat(i.sum,i.vat.type);break;case"vat0":a.with_vat0+=i.sum;break;case"none":a.without_vat+=i.sum;break;case"vat120":case"vat118":a.vat120+=this.extractVat(i.sum,i.vat.type);break;case"vat110":a.vat110+=this.extractVat(i.sum,i.vat.type)}}}catch(t){n.e(t)}finally{n.f()}}return a},emptify:function(t){if(!t||"object"!==s(t))return t;for(var e in t)t[e]=this.emptify(t[e]),t[e]||(t[e]=null);return Object.values(t).every((function(t){return null===t}))&&(t=null),t},fitContent:function(t){t.target.style.height=t.target.contentDocument.body.scrollHeight+20+"px"},printReceipt:function(){var t=window.open(window.FiscalRegistrar.basePath+"/api/v1/receipts/"+this.receipt.id+"/preview","ReceiptPreview","popup,width=500,height=1000");t.onafterprint=t.close,t.onload=function(){t.setTimeout(t.print)}}},computed:{model:function(){return this.$deepModel(this.receipt.data)},isClientEmailRequired:function(){return!this.receipt.data.client.phone},isClientPhoneRequired:function(){return!this.receipt.data.client.email},selectConnections:function(){return Object.entries(this.connections).map((function(t){var e=o(t,2);return{value:e[0],text:e[1].display_name}}))},companyEmailPlaceholder:function(){var t,e;return null!==(t=null===(e=this.connections[this.receipt.connection])||void 0===e?void 0:e.email)&&void 0!==t?t:"user@domain.com"},companyInnPlaceholder:function(){var t,e;return null!==(t=null===(e=this.connections[this.receipt.connection])||void 0===e?void 0:e.inn)&&void 0!==t?t:"1234567890"},companyPaymentSitePlaceholder:function(){var t,e;return null!==(t=null===(e=this.connections[this.receipt.connection])||void 0===e?void 0:e.payment_site)&&void 0!==t?t:""},vatsPlaceholder:function(){return Object.fromEntries(Object.entries(this.getVats(!this.receipt.data.vats)).map((function(t){var e=o(t,2),a=e[0],r=e[1];return[a,String(r)]})))},vatsWithoutVat:{get:function(){var t,e;return null!==(t=null===(e=this.receipt.data.vats)||void 0===e?void 0:e.without_vat)&&void 0!==t?t:null},set:function(t){var e,a;null!==(a=(e=this.receipt.data).vats)&&void 0!==a||(e.vats=this.vats),this.receipt.data.vats.without_vat=t||null}},vatsWithVat0:{get:function(){var t,e;return null!==(t=null===(e=this.receipt.data.vats)||void 0===e?void 0:e.with_vat0)&&void 0!==t?t:null},set:function(t){var e,a;null!==(a=(e=this.receipt.data).vats)&&void 0!==a||(e.vats=this.vats),this.receipt.data.vats.with_vat0=t||null}},vatsVat10:{get:function(){var t,e;return null!==(t=null===(e=this.receipt.data.vats)||void 0===e?void 0:e.vat10)&&void 0!==t?t:null},set:function(t){var e,a;null!==(a=(e=this.receipt.data).vats)&&void 0!==a||(e.vats=this.vats),this.receipt.data.vats.vat10=t||null}},vatsVat20:{get:function(){var t,e;return null!==(t=null===(e=this.receipt.data.vats)||void 0===e?void 0:e.vat20)&&void 0!==t?t:null},set:function(t){var e,a;null!==(a=(e=this.receipt.data).vats)&&void 0!==a||(e.vats=this.vats),this.receipt.data.vats.vat20=t||null}},vatsVat110:{get:function(){var t,e;return null!==(t=null===(e=this.receipt.data.vats)||void 0===e?void 0:e.vat110)&&void 0!==t?t:null},set:function(t){var e,a;null!==(a=(e=this.receipt.data).vats)&&void 0!==a||(e.vats=this.vats),this.receipt.data.vats.vat110=t||null}},vatsVat120:{get:function(){var t,e;return null!==(t=null===(e=this.receipt.data.vats)||void 0===e?void 0:e.vat120)&&void 0!==t?t:null},set:function(t){var e,a;null!==(a=(e=this.receipt.data).vats)&&void 0!==a||(e.vats=this.vats),this.receipt.data.vats.vat120=t||null}},agentType:{get:function(){var t,e;return null!==(t=null===(e=this.receipt.data.agent_info)||void 0===e?void 0:e.type)&&void 0!==t?t:null},set:function(t){var e,a;null!==(a=(e=this.receipt.data).agent_info)&&void 0!==a||(e.agent_info=this.agentInfo),this.receipt.data.agent_info.type=t||null}},payingAgentPhones:{get:function(){var t;return null===(t=this.model["agent_info.paying_agent.phones"])||void 0===t?void 0:t.join("\n")},set:function(t){t=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return null!=t&&""!==t})),this.model["agent_info.paying_agent.phones"]=t.length?t:null}},receivePaymentsOperatorPhones:{get:function(){var t;return null===(t=this.model["agent_info.receive_payments_operator.phones"])||void 0===t?void 0:t.join("\n")},set:function(t){t=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return null!=t&&""!==t})),this.model["agent_info.receive_payments_operator.phones"]=t.length?t:null}},moneyTransferOperatorPhones:{get:function(){var t;return null===(t=this.model["agent_info.money_transfer_operator.phones"])||void 0===t?void 0:t.join("\n")},set:function(t){t=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return null!=t&&""!==t})),this.model["agent_info.money_transfer_operator.phones"]=t.length?t:null}},supplierPhones:{get:function(){var t;return null===(t=this.model["supplier_info.phones"])||void 0===t?void 0:t.join("\n")},set:function(t){t=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return null!=t&&""!==t})),this.model["supplier_info.phones"]=t.length?t:null}}},watch:{"receipt.data.vats":{handler:function(t){null!==t&&Object.values(t).every((function(t){return null===t}))&&(this.receipt.data.vats=null)},deep:!0},"receipt.data.agent_info":{handler:function(t){this.receipt.data.agent_info=null===(null==t?void 0:t.type)?null:this.emptify(t)},deep:!0}}};var p=a(379),u=a.n(p),b=a(225),f={insert:"head",singleton:!1};u()(b.Z,f);b.Z.locals;const v=(0,i.Z)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h2",{staticClass:"text-center"},[t._v(t._s(0!==t.receipt.state?"Просмотр кассового чека":"Редактирование кассового чека"))]),t._v(" "),t.ready?a("b-form",{attrs:{validated:""},on:{submit:function(e){return e.preventDefault(),t.saveReceipt.apply(null,arguments)}}},[a("div",{staticClass:"accordion",attrs:{role:"tablist"}},[a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-1",modifiers:{"accordion-1":!0}}],attrs:{block:"",variant:"info"}},[t._v("Атрибуты документа")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-1",visible:"",accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-card-text",[t._v("\n                            TODO\n                        ")]),t._v(" "),a("b-form-group",{attrs:{disabled:0!==t.receipt.state}},[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Подключение","label-for":"receiptConnection"}},[a("b-form-select",{attrs:{id:"receiptConnection",size:"sm",options:t.selectConnections},model:{value:t.receipt.connection,callback:function(e){t.$set(t.receipt,"connection",e)},expression:"receipt.connection"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Операция","label-for":"receiptOperation"}},[a("b-form-select",{attrs:{id:"receiptOperation",size:"sm",options:t.operations},model:{value:t.receipt.operation,callback:function(e){t.$set(t.receipt,"operation",e)},expression:"receipt.operation"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Уникальный идентификатор","label-for":"receiptExternalId"}},[a("b-form-input",{attrs:{id:"receiptExternalId",type:"text",size:"sm"},model:{value:t.receipt.external_id,callback:function(e){t.$set(t.receipt,"external_id",e)},expression:"receipt.external_id"}})],1)],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-2",modifiers:{"accordion-2":!0}}],attrs:{block:"",variant:"info"}},[t._v("Данные клиента")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-2",accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-card-text",[t._v("\n                            В запросе обязательно должно быть заполнено хотя бы одно из полей: "),a("code",[t._v("email")]),t._v(" или "),a("code",[t._v("phone")]),t._v("."),a("br"),t._v("\n                            Если заполнены оба поля, ОФД отправит электронный чек только на email.\n                        ")]),t._v(" "),a("b-form-group",{attrs:{disabled:0!==t.receipt.state}},[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{class:t.isClientEmailRequired&&"required",attrs:{label:"Электронный адрес","label-for":"clientEmail"}},[a("b-form-input",{attrs:{id:"clientEmail",type:"email",size:"sm",placeholder:"user@domain.com",required:t.isClientEmailRequired},model:{value:t.receipt.data.client.email,callback:function(e){t.$set(t.receipt.data.client,"email",e)},expression:"receipt.data.client.email"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{class:t.isClientPhoneRequired&&"required",attrs:{label:"Телефон","label-for":"clientPhone"}},[a("b-form-input",{attrs:{id:"clientPhone",type:"tel",size:"sm",placeholder:"+79001234567",required:t.isClientPhoneRequired},model:{value:t.receipt.data.client.phone,callback:function(e){t.$set(t.receipt.data.client,"phone",e)},expression:"receipt.data.client.phone"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Наименование","label-for":"clientName"}},[a("b-form-input",{attrs:{id:"clientName",type:"text",size:"sm",placeholder:"Иван Иванович Иванов"},model:{value:t.receipt.data.client.name,callback:function(e){t.$set(t.receipt.data.client,"name",e)},expression:"receipt.data.client.name"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"ИНН","label-for":"clientInn"}},[a("b-form-input",{attrs:{id:"clientInn",type:"text",size:"sm",placeholder:"1234567890",pattern:"\\d{10}|\\d{12}",maxlength:"12"},model:{value:t.receipt.data.client.inn,callback:function(e){t.$set(t.receipt.data.client,"inn",e)},expression:"receipt.data.client.inn"}})],1)],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-3",modifiers:{"accordion-3":!0}}],attrs:{block:"",variant:"info"}},[t._v("Данные организации")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-3",accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-card-text",[t._v("\n                            Оставьте поля пустыми для автоматической подстановки параметров из конфигурации подключения при проводке чека.\n                        ")]),t._v(" "),a("b-form-group",{attrs:{disabled:0!==t.receipt.state}},[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Электронный адрес","label-for":"companyEmail"}},[a("b-form-input",{attrs:{id:"companyEmail",type:"email",size:"sm",placeholder:t.companyEmailPlaceholder},model:{value:t.receipt.data.company.email,callback:function(e){t.$set(t.receipt.data.company,"email",e)},expression:"receipt.data.company.email"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Система налогообложения","label-for":"taxSystem"}},[a("b-form-select",{attrs:{id:"taxSystem",size:"sm",options:t.taxSystems},model:{value:t.receipt.data.company.tax_system,callback:function(e){t.$set(t.receipt.data.company,"tax_system",e)},expression:"receipt.data.company.tax_system"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"ИНН","label-for":"companyInn"}},[a("b-form-input",{attrs:{id:"companyInn",type:"text",size:"sm",placeholder:t.companyInnPlaceholder,pattern:"\\d{10}|\\d{12}",maxlength:"12"},model:{value:t.receipt.data.company.inn,callback:function(e){t.$set(t.receipt.data.company,"inn",e)},expression:"receipt.data.company.inn"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Место расчетов","label-for":"companyPaymentSite"}},[a("b-form-input",{attrs:{id:"companyPaymentSite",type:"text",size:"sm",placeholder:t.companyPaymentSitePlaceholder},model:{value:t.receipt.data.company.payment_site,callback:function(e){t.$set(t.receipt.data.company,"payment_site",e)},expression:"receipt.data.company.payment_site"}})],1)],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-7",modifiers:{"accordion-7":!0}}],attrs:{block:"",variant:"info"}},[t._v("Данные агента и поставщика")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-7",accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-card-text",[t._v("\n                            TODO\n                        ")]),t._v(" "),a("b-form-group",{attrs:{disabled:0!==t.receipt.state}},[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Признак агента","label-for":"agentType"}},[a("b-form-select",{attrs:{id:"agentType",size:"sm",options:t.agentTypes},model:{value:t.agentType,callback:function(e){t.agentType=e},expression:"agentType"}})],1)],1)],1)],1),t._v(" "),null!==t.agentType?a("div",{staticClass:"accordion",attrs:{role:"tablist"}},[a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-7-1",modifiers:{"accordion-7-1":!0}}],attrs:{block:""}},[t._v("Атрибуты платежного агента")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-7-1",accordion:"my-accordion2",role:"tabpanel"}},[a("b-card-body",[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Наименование операции","label-for":"payingAgentOperation"}},[a("b-form-input",{attrs:{id:"payingAgentOperation",type:"text",size:"sm"},model:{value:t.model["agent_info.paying_agent.operation"],callback:function(e){t.$set(t.model,"agent_info.paying_agent.operation",e)},expression:"model['agent_info.paying_agent.operation']"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"payingAgentPhones"}},[a("b-form-textarea",{attrs:{id:"payingAgentPhones",size:"sm","max-rows":"4"},model:{value:t.payingAgentPhones,callback:function(e){t.payingAgentPhones=e},expression:"payingAgentPhones"}})],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-7-2",modifiers:{"accordion-7-2":!0}}],attrs:{block:""}},[t._v("Атрибуты оператора по приему платежей")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-7-2",accordion:"my-accordion2",role:"tabpanel"}},[a("b-card-body",[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"receivePaymentsOperatorPhones"}},[a("b-form-textarea",{attrs:{id:"receivePaymentsOperatorPhones",size:"sm","max-rows":"4"},model:{value:t.receivePaymentsOperatorPhones,callback:function(e){t.receivePaymentsOperatorPhones=e},expression:"receivePaymentsOperatorPhones"}})],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-7-3",modifiers:{"accordion-7-3":!0}}],attrs:{block:""}},[t._v("Атрибуты оператора перевода")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-7-3",accordion:"my-accordion2",role:"tabpanel"}},[a("b-card-body",[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"moneyTransferOperatorPhones"}},[a("b-form-textarea",{attrs:{id:"moneyTransferOperatorPhones",size:"sm","max-rows":"4"},model:{value:t.moneyTransferOperatorPhones,callback:function(e){t.moneyTransferOperatorPhones=e},expression:"moneyTransferOperatorPhones"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Наименование","label-for":"moneyTransferOperatorName"}},[a("b-form-input",{attrs:{id:"moneyTransferOperatorName",type:"text",size:"sm"},model:{value:t.model["agent_info.money_transfer_operator.name"],callback:function(e){t.$set(t.model,"agent_info.money_transfer_operator.name",e)},expression:"model['agent_info.money_transfer_operator.name']"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Адрес","label-for":"moneyTransferOperatorAddress"}},[a("b-form-input",{attrs:{id:"moneyTransferOperatorAddress",type:"text",size:"sm"},model:{value:t.model["agent_info.money_transfer_operator.address"],callback:function(e){t.$set(t.model,"agent_info.money_transfer_operator.address",e)},expression:"model['agent_info.money_transfer_operator.address']"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"ИНН","label-for":"moneyTransferOperatorInn"}},[a("b-form-input",{attrs:{id:"moneyTransferOperatorInn",type:"text",size:"sm"},model:{value:t.model["agent_info.money_transfer_operator.inn"],callback:function(e){t.$set(t.model,"agent_info.money_transfer_operator.inn",e)},expression:"model['agent_info.money_transfer_operator.inn']"}})],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-7-4",modifiers:{"accordion-7-4":!0}}],attrs:{block:""}},[t._v("Атрибуты поставщика")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-7-4",accordion:"my-accordion2",role:"tabpanel"}},[a("b-card-body",[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{staticClass:"required",attrs:{label:"Телефон(ы)","label-for":"supplierPhones"}},[a("b-form-textarea",{attrs:{id:"supplierPhones",size:"sm","max-rows":"4",required:""},model:{value:t.supplierPhones,callback:function(e){t.supplierPhones=e},expression:"supplierPhones"}})],1)],1)],1)],1)],1)],1)],1)],1):t._e()],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-4",modifiers:{"accordion-4":!0}}],attrs:{block:"",variant:"info"}},[t._v("Позиции документа")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-4",accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-card-text",[t._v("\n                            В документе должна быть как минимум одна позиция.\n                        ")]),t._v(" "),t._l(t.receipt.data.items,(function(e,r){return[a("receipt-item",{key:r,attrs:{item:e,disabled:0!==t.receipt.state},on:{remove:function(e){return t.removeItem(r)}}}),t._v(" "),a("hr")]})),t._v(" "),a("b-button",{attrs:{variant:"primary",size:"sm",disabled:0!==t.receipt.state},on:{click:t.addItem}},[t._v("Добавить")])],2)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-5",modifiers:{"accordion-5":!0}}],attrs:{block:"",variant:"info"}},[t._v("Данные по оплате")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-5",accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-card-text",[t._v("\n                            TODO\n                        ")]),t._v(" "),a("b-form-group",{attrs:{disabled:0!==t.receipt.state}},[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Наличными","label-for":"paymentCash"}},[a("b-form-input",{attrs:{id:"paymentCash",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:t.receipt.data.payments.cash,callback:function(e){t.$set(t.receipt.data.payments,"cash",e)},expression:"receipt.data.payments.cash"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Безналичными","label-for":"paymentElectronic"}},[a("b-form-input",{attrs:{id:"paymentElectronic",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:t.receipt.data.payments.electronic,callback:function(e){t.$set(t.receipt.data.payments,"electronic",e)},expression:"receipt.data.payments.electronic"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Предоплатой","label-for":"paymentPrepaid"}},[a("b-form-input",{attrs:{id:"paymentPrepaid",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:t.receipt.data.payments.prepaid,callback:function(e){t.$set(t.receipt.data.payments,"prepaid",e)},expression:"receipt.data.payments.prepaid"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Постоплатой","label-for":"paymentPostpaid"}},[a("b-form-input",{attrs:{id:"paymentPostpaid",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:t.receipt.data.payments.postpaid,callback:function(e){t.$set(t.receipt.data.payments,"postpaid",e)},expression:"receipt.data.payments.postpaid"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Встр. предст.","label-for":"paymentOther"}},[a("b-form-input",{attrs:{id:"paymentOther",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:t.receipt.data.payments.other,callback:function(e){t.$set(t.receipt.data.payments,"other",e)},expression:"receipt.data.payments.other"}})],1)],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-6",modifiers:{"accordion-6":!0}}],attrs:{block:"",variant:"info"}},[t._v("НДС на чек")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-6",accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-card-text",[t._v("\n                            Необходимо передать либо сумму налога на позицию, либо сумму налога на чек. Если будет переданы и сумма налога на позицию и сумма налога на чек, сервис учтет только сумму налога на чек.\n                            "),t.receipt.data.vats?a("span",[t._v("В данный момент используются суммы налога на чек. Для возврата к использованию сумм налога на позицию, очистите все поля в этом разделе.")]):a("span",[t._v("В данный момент используются суммы налога на позицию. В полях ниже можно увидеть их расчетные величины.")])]),t._v(" "),a("b-form-group",{attrs:{disabled:0!==t.receipt.state}},[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Сумма расчета по чеку без НДС","label-for":"withoutVat"}},[a("b-form-input",{attrs:{id:"withoutVat",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:t.vatsPlaceholder.without_vat},model:{value:t.vatsWithoutVat,callback:function(e){t.vatsWithoutVat=t._n(e)},expression:"vatsWithoutVat"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Сумма расчета по чеку с НДС 0%","label-for":"withVat0"}},[a("b-form-input",{attrs:{id:"withVat0",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:t.vatsPlaceholder.with_vat0},model:{value:t.vatsWithVat0,callback:function(e){t.vatsWithVat0=t._n(e)},expression:"vatsWithVat0"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Сумма НДС чека по ставке 10%","label-for":"vat10"}},[a("b-form-input",{attrs:{id:"vat10",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:t.vatsPlaceholder.vat10},model:{value:t.vatsVat10,callback:function(e){t.vatsVat10=t._n(e)},expression:"vatsVat10"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Сумма НДС чека по ставке 20%","label-for":"vat20"}},[a("b-form-input",{attrs:{id:"vat20",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:t.vatsPlaceholder.vat20},model:{value:t.vatsVat20,callback:function(e){t.vatsVat20=t._n(e)},expression:"vatsVat20"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Сумма НДС чека по расч. ставке 10/110","label-for":"vat110"}},[a("b-form-input",{attrs:{id:"vat110",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:t.vatsPlaceholder.vat110},model:{value:t.vatsVat110,callback:function(e){t.vatsVat110=t._n(e)},expression:"vatsVat110"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Сумма НДС чека по расч. ставке 20/120","label-for":"vat120"}},[a("b-form-input",{attrs:{id:"vat120",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:t.vatsPlaceholder.vat120},model:{value:t.vatsVat120,callback:function(e){t.vatsVat120=t._n(e)},expression:"vatsVat120"}})],1)],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-8",modifiers:{"accordion-8":!0}}],attrs:{block:"",variant:"info"}},[t._v("Дополнительные реквизиты")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-8",accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-form-group",{attrs:{disabled:0!==t.receipt.state}},[a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-1"},[a("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{label:"Доп. реквизит чека","label-for":"additionalCheckProps"}},[a("b-form-input",{attrs:{id:"additionalCheckProps",type:"text",size:"sm",maxlength:"16"},model:{value:t.receipt.data.additional_check_props,callback:function(e){t.$set(t.receipt.data,"additional_check_props",e)},expression:"receipt.data.additional_check_props"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"5",sm:"8"}},[a("b-form-group",{attrs:{label:"ФИО кассира","label-for":"cashier"}},[a("b-form-input",{attrs:{id:"cashier",type:"text",size:"sm",maxlength:"64"},model:{value:t.receipt.data.cashier,callback:function(e){t.$set(t.receipt.data,"cashier",e)},expression:"receipt.data.cashier"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[a("b-form-group",{attrs:{label:"Наим. доп. рекв. пользователя","label-for":"additionalUserPropsName"}},[a("b-form-input",{attrs:{id:"additionalUserPropsName",type:"text",size:"sm",maxlength:"64"},model:{value:t.model["additional_user_props.name"],callback:function(e){t.$set(t.model,"additional_user_props.name",e)},expression:"model['additional_user_props.name']"}})],1)],1),t._v(" "),a("b-col",{attrs:{"align-self":"end",lg:"4",md:"8",sm:"12"}},[a("b-form-group",{attrs:{label:"Знач. доп. рекв. пользователя","label-for":"additionalUserPropsValue"}},[a("b-form-input",{attrs:{id:"additionalUserPropsValue",type:"text",size:"sm",maxlength:"256"},model:{value:t.model["additional_user_props.value"],callback:function(e){t.$set(t.model,"additional_user_props.value",e)},expression:"model['additional_user_props.value']"}})],1)],1)],1)],1)],1)],1)],1)],1),t._v(" "),t.receipt.result?a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-9",modifiers:{"accordion-9":!0}}],attrs:{block:"",variant:"info"}},[t._v("Результат обработки")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-9",accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-card-sub-title",{staticClass:"mb-3"},[t._v("Информация поставщика")]),t._v(" "),a("b-container",{attrs:{fluid:""}},[a("b-form-row",[a("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[a("b-form-group",{attrs:{description:"Дата и время"}},[t._v("\n                                        "+t._s(t.$moment(t.receipt.result.timestamp).format("DD.MM.YYYY HH:mm:ss"))+"\n                                    ")])],1),t._v(" "),a("b-col",{staticClass:"mb-3",attrs:{lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{description:"Внутренний идентификатор"}},[t._v("\n                                        "+t._s(t.receipt.result.internal_id)+"\n                                    ")])],1)],1)],1),t._v(" "),a("b-card-sub-title",{staticClass:"mb-3"},[t._v("Информация ОФД")]),t._v(" "),a("b-container",{attrs:{fluid:""}},[a("b-form-row",[a("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[a("b-form-group",{attrs:{description:"Дата и время"}},[t._v("\n                                        "+t._s(t.$moment(t.receipt.result.payload.receipt_datetime).format("DD.MM.YYYY HH:mm"))+"\n                                    ")])],1),t._v(" "),a("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[a("b-form-group",{attrs:{description:"Номер смены"}},[t._v("\n                                        "+t._s(t.receipt.result.payload.shift_number)+"\n                                    ")])],1),t._v(" "),a("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[a("b-form-group",{attrs:{description:"Номер чека в смене"}},[t._v("\n                                        "+t._s(t.receipt.result.payload.fiscal_receipt_number)+"\n                                    ")])],1),t._v(" "),a("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[a("b-form-group",{attrs:{description:"Сумма расчета"}},[t._v("\n                                        "+t._s(t.receipt.result.payload.total)+"\n                                    ")])],1),t._v(" "),a("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[a("b-form-group",{attrs:{description:"Рег. номер ККТ"}},[t._v("\n                                        "+t._s(t.receipt.result.payload.ecr_registration_number)+"\n                                    ")])],1),t._v(" "),a("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[a("b-form-group",{attrs:{description:"Номер ФН"}},[t._v("\n                                        "+t._s(t.receipt.result.payload.fn_number)+"\n                                    ")])],1),t._v(" "),a("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[a("b-form-group",{attrs:{description:"Фискальный номер документа"}},[t._v("\n                                        "+t._s(t.receipt.result.payload.fiscal_document_number)+"\n                                    ")])],1),t._v(" "),a("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[a("b-form-group",{attrs:{description:"Фискальный признак документа"}},[t._v("\n                                        "+t._s(t.receipt.result.payload.fiscal_document_attribute)+"\n                                    ")])],1),t._v(" "),a("b-col",{staticClass:"mb-3",attrs:{lg:"2",md:"3",sm:"4"}},[a("b-form-group",{attrs:{description:"Адрес сайта ФНС"}},[a("b-link",{attrs:{href:t.receipt.result.payload.fns_site,target:"_blank"}},[t._v(t._s(t.receipt.result.payload.fns_site))])],1)],1)],1)],1)],1)],1)],1):t._e(),t._v(" "),a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-10",modifiers:{"accordion-10":!0}}],attrs:{block:"",variant:"info"}},[t._v("Просмотр чека")])],1),t._v(" "),a("b-collapse",{attrs:{id:"accordion-10",accordion:"my-accordion",role:"tabpanel"},on:{show:function(e){t.showPreview=!0}}},[a("b-card-body",[t.showPreview?a("iframe",{attrs:{src:t.FiscalRegistrar.basePath+"/api/v1/receipts/"+t.receipt.id+"/preview",width:"100%"},on:{load:t.fitContent}}):t._e()])],1)],1)],1),t._v(" "),a("b-container",{attrs:{fluid:""}},[a("b-form-row",{staticClass:"my-3"},[a("b-col",{attrs:{lg:"12"}},[a("b-button",{staticClass:"mb-1",attrs:{type:"submit",variant:"primary",size:"sm",disabled:0!==t.receipt.state}},[t._v("Сохранить")]),t._v(" "),a("b-button",{staticClass:"mb-1",attrs:{size:"sm"},on:{click:t.printReceipt}},[t._v("Распечатать")]),t._v(" "),t.receipt.result?a("b-button",{staticClass:"mb-1",attrs:{size:"sm",href:t.receipt.result.payload.ofd_receipt_url,target:"_blank"}},[t._v("Просмотреть в ОФД")]):t._e()],1)],1)],1)],1):t._e()],1)}),[],!1,null,"6d6bf957",null).exports},792:(t,e,a)=>{a.d(e,{Z:()=>n});const r={data:function(){return{fields:[{key:"id",label:"#"},{key:"created_at",label:"Время"},{key:"connection",label:"Соединение"},{key:"operation",label:"Тип"},{key:"data.total",label:"Сумма"},{key:"state",label:"Статус"}],receipts:{}}},mounted:function(){this.getReceipts()},methods:{getReceipts:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$http.get(FiscalRegistrar.basePath+"/api/v1/receipts/?page="+e).then((function(e){t.receipts=e.data}))}}};const n=(0,a(900).Z)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-table",{attrs:{small:"",striped:"",hover:"",items:t.receipts.data,fields:t.fields},scopedSlots:t._u([{key:"cell(id)",fn:function(e){return[a("a",{attrs:{href:"receipts/"+e.value}},[t._v(t._s(e.value))])]}},{key:"cell(created_at)",fn:function(e){return[t._v("\n            "+t._s(t.$moment(e.value).format("DD.MM.YYYY HH:mm:ss"))+"\n        ")]}}])}),t._v(" "),a("pagination",{attrs:{data:t.receipts,limit:2,"show-disabled":!0,align:"center"},on:{"pagination-change-page":t.getReceipts}})],1)}),[],!1,null,null,null).exports}},t=>{var e=e=>t(t.s=e);t.O(0,[143,660],(()=>(e(569),e(347))));t.O()}]);