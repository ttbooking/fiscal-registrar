(self.webpackChunk=self.webpackChunk||[]).push([[260],{7726:(e,t,r)=>{"use strict";var a=r(538),n=r(6530),i=r(2783),o=r(381),s=r.n(o);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var a,n,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){s=!0,n=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw n}}return i}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}const m={computed:{FiscalRegistrar:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return FiscalRegistrar})),$echo:function(){return Echo.channel("fiscal-registrar")},agentTypeOptions:function(){return[{value:null,text:"нет"}].concat(p(this.buildOptions(this.dictionary.agentTypes)))},taxSystemOptions:function(){return[{value:null,text:"не выбрано"}].concat(p(this.buildOptions(this.dictionary.taxSystems)))}},methods:{formatTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DD.MM.YYYY HH:mm:ss";return s()(e).format(t)},buildOptions:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!==(t=r)&&void 0!==t||(r=function(e){var t=c(e,2);return{value:t[0],text:t[1]}}),Object.entries(e).map(r)},extractVat:function(e,t){return parseFloat((e-e/(1+this.dictionary.vatRates[t])).toFixed(2))},emptify:function(e){if(!e||"object"!==l(e))return e;for(var t in e)e[t]=this.emptify(e[t]),e[t]||(e[t]=null);return Object.values(e).every((function(e){return null===e}))&&(e=null),e},enumConnections:function(){var e=this;this.$http.get(FiscalRegistrar.basePath+"/api/v1/connection").then((function(t){e.connections=t.data}))}},data:function(){return{connections:{},dictionary:{operations:{sell:"приход",sell_refund:"возврат прихода",buy:"расход",buy_refund:"возврат расхода"},states:["не зарегистрирован","зарегистрирован","проведен"],agentTypes:{bank_paying_agent:"банковский платежный агент",bank_paying_subagent:"банковский платежный субагент",paying_agent:"платежный агент",paying_subagent:"платежный субагент",attorney:"поверенный",commission_agent:"комиссионер",another:"агент"},taxSystems:{osn:"общая система налогообложения",usn_income:"упрощенная система налогообложения (доходы)",usn_income_outcome:"упрощенная система налогообложения (доходы минус расходы)",envd:"единый налог на вмененный доход",esn:"единый сельскохозяйственный налог",patent:"патентная система налогообложения"},paymentMethods:{full_prepayment:"предоплата 100%",prepayment:"предоплата",advance:"аванс",full_payment:"полный расчет",partial_payment:"частичный расчет и кредит",credit:"передача в кредит",credit_payment:"оплата кредита"},paymentObjects:{commodity:"товар",excise:"подакцизный товар",job:"работа",service:"услуга",gambling_bet:"ставка азартной игры",gambling_prize:"выигрыш азартной игры",lottery:"лотерейный билет",lottery_prize:"выигрыш лотереи",intellectual_activity:"предоставление результатов интеллектуальной деятельности",payment:"платеж",agent_commission:"агентское вознаграждение",award:"взнос/штраф/вознаграждение/бонус",composite:"составной предмет расчета",another:"иной предмет расчета",property_right:"имущественное право","non-operating_gain":"внереализационный доход",insurance_premium:"страховые взносы",sales_tax:"торговый сбор",resort_fee:"курортный сбор",deposit:"залог",expense:"расход",pension_insurance_ip:"взносы на ОПС ИП",pension_insurance:"взносы на ОПС",medical_insurance_ip:"взносы на ОМС ИП",medical_insurance:"взносы на ОМС",social_insurance:"взносы на ОСС",casino_payment:"платеж казино"},vatTypes:{none:"нет",vat0:"0%",vat10:"10%",vat18:"18%",vat20:"20%",vat110:"10/110",vat118:"18/118",vat120:"20/120"},vatRates:{none:0,vat0:0,vat10:.1,vat18:.18,vat20:.2,vat110:10/110,vat118:18/118,vat120:20/120}}}}};var b=r(4554),f=r(9669),v=r.n(f),y=r(9578);const g=[{path:"/",redirect:"/receipts"},{path:"/receipts",name:"receipts",component:r(960).Z},{path:"/receipt/new",name:"new-receipt",component:r(101).Z},{path:"/receipt/from/:id",name:"new-receipt-from-existing",component:r(101).Z},{path:"/receipt/:id",name:"receipt",component:r(101).Z}];var h,_,x=r(8345),w=(r(3734),document.head.querySelector('meta[name="csrf-token"]'));v().defaults.headers.common["X-Requested-With"]="XMLHttpRequest",w&&(v().defaults.headers.common["X-CSRF-TOKEN"]=w.content),a.default.use(n.ZPm),a.default.use(i),a.default.use(x.Z),a.default.prototype.$http=v().create(),y.H.$http=v(),window.qs=r(129),window.Pusher=r(6606),window.Echo=new b.Z({broadcaster:"pusher",key:window.FiscalRegistrar.pusher.key,cluster:null!==(h=window.FiscalRegistrar.pusher.cluster)&&void 0!==h?h:"eu",forceTLS:null===(_=window.FiscalRegistrar.pusher.useTLS)||void 0===_||_}),window.FiscalRegistrar.basePath="/"+window.FiscalRegistrar.path;var k=window.FiscalRegistrar.basePath+"/";""!==window.FiscalRegistrar.path&&"/"!==window.FiscalRegistrar.path||(k="/",window.FiscalRegistrar.basePath="");var C=new x.Z({routes:g,mode:"history",base:k});a.default.component("pagination",r(1606)),a.default.mixin(m),new a.default({el:"#fiscal-registrar",router:C})},7666:(e,t,r)=>{"use strict";r.d(t,{Z:()=>b});var a=r(7757),n=r.n(a);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t,r,a,n,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var i=e.apply(t,r);function s(e){o(i,a,n,s,l,"next",e)}function l(e){o(i,a,n,s,l,"throw",e)}s(void 0)}))}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=m(e);if(t){var n=m(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(m,e);var t,r,a,i,o,u=d(m);function m(){return l(this,m),u.apply(this,arguments)}return t=m,r=[{key:"baseURL",value:function(){return FiscalRegistrar.basePath+"/api/v1"}},{key:"request",value:function(e){return this.$http.request(e)}},{key:"resource",value:function(){return"receipts"}},{key:"register",value:(o=s(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"POST",url:this.endpoint()+"/register"});case 2:return e.sent,this.state=1,e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"sync",value:(i=s(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"GET",url:this.endpoint()+"/report"});case 2:return t=e.sent,this.result=t.data,this.state=2,e.abrupt("return",this);case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}],r&&c(t.prototype,r),a&&c(t,a),m}(r(9578).H)},7429:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(1519),n=r.n(a)()((function(e){return e[1]}));n.push([e.id,"fieldset[data-v-7a108471]{margin:0}",""]);const i=n},4347:()=>{},101:(e,t,r)=>{"use strict";r.d(t,{Z:()=>x});var a=r(7757),n=r.n(a),i=r(7666);const o={props:["item","disabled"],computed:{id:function(){return this.$vnode.key+1},model:function(){return this.$deepModel(this.item)},vatSum:function(){return String(this.extractVat(this.item.sum,this.item.vat.type))},agentType:{get:function(){var e;return null!==(e=this.model["agent_info.type"])&&void 0!==e?e:null},set:function(e){this.model["agent_info.type"]=e}},payingAgentPhones:{get:function(){var e;return null===(e=this.model["agent_info.paying_agent.phones"])||void 0===e?void 0:e.join("\n")},set:function(e){e=e.split("\n").map((function(e){return e.trim()})).filter((function(e){return null!=e&&""!==e})),this.model["agent_info.paying_agent.phones"]=e.length?e:null}},receivePaymentsOperatorPhones:{get:function(){var e;return null===(e=this.model["agent_info.receive_payments_operator.phones"])||void 0===e?void 0:e.join("\n")},set:function(e){e=e.split("\n").map((function(e){return e.trim()})).filter((function(e){return null!=e&&""!==e})),this.model["agent_info.receive_payments_operator.phones"]=e.length?e:null}},moneyTransferOperatorPhones:{get:function(){var e;return null===(e=this.model["agent_info.money_transfer_operator.phones"])||void 0===e?void 0:e.join("\n")},set:function(e){e=e.split("\n").map((function(e){return e.trim()})).filter((function(e){return null!=e&&""!==e})),this.model["agent_info.money_transfer_operator.phones"]=e.length?e:null}},supplierPhones:{get:function(){var e;return null===(e=this.model["supplier_info.phones"])||void 0===e?void 0:e.join("\n")},set:function(e){e=e.split("\n").map((function(e){return e.trim()})).filter((function(e){return null!=e&&""!==e})),this.model["supplier_info.phones"]=e.length?e:null}}},watch:{"item.price":function(e){this.item.sum=e*this.item.quantity},"item.quantity":function(e){this.item.sum=this.item.price*e},"item.sum":function(e){this.item.vat.sum=this.extractVat(e,this.item.vat.type)},"item.vat.type":function(e){this.item.vat.sum=this.extractVat(this.item.sum,e)},"item.agent_info":{handler:function(e){this.item.agent_info=null===(null==e?void 0:e.type)?null:this.emptify(e)},deep:!0},"item.supplier_info":{handler:function(e){this.item.supplier_info=null===(null==e?void 0:e.type)?null:this.emptify(e)},deep:!0}}};var s=r(1900);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var a,n,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){s=!0,n=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw n}}return i}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=d(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function d(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function m(e,t,r,a,n,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var i=e.apply(t,r);function o(e){m(i,a,n,o,s,"next",e)}function s(e){m(i,a,n,o,s,"throw",e)}o(void 0)}))}}const f={components:{ReceiptItem:(0,s.Z)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"4",md:"6",sm:"12"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Наименование","label-for":"item"+e.id+"Name",description:"тег 1030"}},[r("b-form-input",{attrs:{id:"item"+e.id+"Name",type:"text",size:"sm",required:"",disabled:e.disabled},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Цена","label-for":"item"+e.id+"Price",description:"тег 1079"}},[r("b-form-input",{attrs:{id:"item"+e.id+"Price",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0",required:"",disabled:e.disabled},model:{value:e.item.price,callback:function(t){e.$set(e.item,"price",t)},expression:"item.price"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Кол-во","label-for":"item"+e.id+"Quantity",description:"тег 1023"}},[r("b-form-input",{attrs:{id:"item"+e.id+"Quantity",type:"number",min:".001",max:"99999.999",step:"any",size:"sm",placeholder:"1",required:"",disabled:e.disabled},model:{value:e.item.quantity,callback:function(t){e.$set(e.item,"quantity",t)},expression:"item.quantity"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Сумма","label-for":"item"+e.id+"Sum",description:"тег 1043"}},[r("b-form-input",{attrs:{id:"item"+e.id+"Sum",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0",required:"",disabled:e.disabled},model:{value:e.item.sum,callback:function(t){e.$set(e.item,"sum",t)},expression:"item.sum"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[r("b-form-group",{attrs:{label:"Ед. изм.","label-for":"item"+e.id+"MeasurementUnit",description:"тег 1197"}},[r("b-form-input",{attrs:{id:"item"+e.id+"MeasurementUnit",type:"text",size:"sm",placeholder:"шт.",maxlength:"16",disabled:e.disabled},model:{value:e.item.measurement_unit,callback:function(t){e.$set(e.item,"measurement_unit",t)},expression:"item.measurement_unit"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"2",sm:"4"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Способ расчета","label-for":"item"+e.id+"PaymentMethod",description:"тег 1214"}},[r("b-form-select",{attrs:{id:"item"+e.id+"PaymentMethod",size:"sm",options:e.buildOptions(e.dictionary.paymentMethods),disabled:e.disabled},model:{value:e.item.payment_method,callback:function(t){e.$set(e.item,"payment_method",t)},expression:"item.payment_method"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"2",sm:"4"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Предмет расчета","label-for":"item"+e.id+"PaymentObject",description:"тег 1212"}},[r("b-form-select",{attrs:{id:"item"+e.id+"PaymentObject",size:"sm",options:e.buildOptions(e.dictionary.paymentObjects),disabled:e.disabled},model:{value:e.item.payment_object,callback:function(t){e.$set(e.item,"payment_object",t)},expression:"item.payment_object"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[r("b-form-group",{staticClass:"required",attrs:{label:"НДС","label-for":"item"+e.id+"VatType",description:"тег 1199"}},[r("b-form-select",{attrs:{id:"item"+e.id+"VatType",size:"sm",options:e.buildOptions(e.dictionary.vatTypes),disabled:e.disabled},model:{value:e.item.vat.type,callback:function(t){e.$set(e.item.vat,"type",t)},expression:"item.vat.type"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"4"}},[r("b-form-group",{attrs:{label:"Сумма НДС","label-for":"item"+e.id+"VatSum",description:"тег 1200"}},[r("b-form-input",{attrs:{id:"item"+e.id+"VatSum",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:e.vatSum,disabled:e.disabled},model:{value:e.item.vat.sum,callback:function(t){e.$set(e.item.vat,"sum",t)},expression:"item.vat.sum"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Признак агента","label-for":"item"+e.id+"agentType",description:"тег 1222"}},[r("b-form-select",{attrs:{id:"item"+e.id+"agentType",size:"sm",options:e.agentTypeOptions,disabled:e.disabled},model:{value:e.agentType,callback:function(t){e.agentType=t},expression:"agentType"}})],1)],1),e._v(" "),r("b-col",{staticClass:"ml-auto mr-0",attrs:{"align-self":"end",lg:"1",md:"1",sm:"1"}},[r("b-form-group",{staticClass:"text-right"},[r("b-button",{attrs:{variant:"danger",size:"sm",title:"Удалить",disabled:e.disabled},on:{click:function(t){return e.$emit("remove")}}},[r("b",[e._v("×")])])],1)],1)],1),e._v(" "),null!==e.agentType?r("div",{staticClass:"accordion",attrs:{role:"tablist"}},[r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"receipt-item-"+e.id+"-paying-agent",expression:"'receipt-item-' + id + '-paying-agent'"}],attrs:{block:""}},[e._v("Атрибуты платежного агента")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-item-"+e.id+"-paying-agent",accordion:"receipt-item-"+e.id+"-agent-supplier-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Наименование операции","label-for":"item"+e.id+"payingAgentOperation",description:"тег 1044"}},[r("b-form-input",{attrs:{id:"item"+e.id+"payingAgentOperation",type:"text",size:"sm",disabled:e.disabled},model:{value:e.model["agent_info.paying_agent.operation"],callback:function(t){e.$set(e.model,"agent_info.paying_agent.operation",t)},expression:"model['agent_info.paying_agent.operation']"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"item"+e.id+"payingAgentPhones",description:"тег 1073"}},[r("b-form-textarea",{attrs:{id:"item"+e.id+"payingAgentPhones",size:"sm","max-rows":"4",disabled:e.disabled},model:{value:e.payingAgentPhones,callback:function(t){e.payingAgentPhones=t},expression:"payingAgentPhones"}})],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"receipt-item-"+e.id+"-receive-payments-operator",expression:"'receipt-item-' + id + '-receive-payments-operator'"}],attrs:{block:""}},[e._v("Атрибуты оператора по приему платежей")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-item-"+e.id+"-receive-payments-operator",accordion:"receipt-item-"+e.id+"-agent-supplier-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"item"+e.id+"receivePaymentsOperatorPhones",description:"тег 1074"}},[r("b-form-textarea",{attrs:{id:"item"+e.id+"receivePaymentsOperatorPhones",size:"sm","max-rows":"4",disabled:e.disabled},model:{value:e.receivePaymentsOperatorPhones,callback:function(t){e.receivePaymentsOperatorPhones=t},expression:"receivePaymentsOperatorPhones"}})],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"receipt-item-"+e.id+"-money-transfer-operator",expression:"'receipt-item-' + id + '-money-transfer-operator'"}],attrs:{block:""}},[e._v("Атрибуты оператора перевода")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-item-"+e.id+"-money-transfer-operator",accordion:"receipt-item-"+e.id+"-agent-supplier-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"item"+e.id+"moneyTransferOperatorPhones",description:"тег 1075"}},[r("b-form-textarea",{attrs:{id:"item"+e.id+"moneyTransferOperatorPhones",size:"sm","max-rows":"4",disabled:e.disabled},model:{value:e.moneyTransferOperatorPhones,callback:function(t){e.moneyTransferOperatorPhones=t},expression:"moneyTransferOperatorPhones"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Наименование","label-for":"item"+e.id+"moneyTransferOperatorName",description:"тег 1026"}},[r("b-form-input",{attrs:{id:"item"+e.id+"moneyTransferOperatorName",type:"text",size:"sm",disabled:e.disabled},model:{value:e.model["agent_info.money_transfer_operator.name"],callback:function(t){e.$set(e.model,"agent_info.money_transfer_operator.name",t)},expression:"model['agent_info.money_transfer_operator.name']"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Адрес","label-for":"item"+e.id+"moneyTransferOperatorAddress",description:"тег 1005"}},[r("b-form-input",{attrs:{id:"item"+e.id+"moneyTransferOperatorAddress",type:"text",size:"sm",disabled:e.disabled},model:{value:e.model["agent_info.money_transfer_operator.address"],callback:function(t){e.$set(e.model,"agent_info.money_transfer_operator.address",t)},expression:"model['agent_info.money_transfer_operator.address']"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"ИНН","label-for":"item"+e.id+"moneyTransferOperatorInn",description:"тег 1016"}},[r("b-form-input",{attrs:{id:"item"+e.id+"moneyTransferOperatorInn",type:"text",size:"sm",pattern:"\\d{10}|\\d{12}",maxlength:"12",disabled:e.disabled},model:{value:e.model["agent_info.money_transfer_operator.inn"],callback:function(t){e.$set(e.model,"agent_info.money_transfer_operator.inn",t)},expression:"model['agent_info.money_transfer_operator.inn']"}})],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"receipt-item-"+e.id+"-supplier",expression:"'receipt-item-' + id + '-supplier'"}],attrs:{block:""}},[e._v("Атрибуты поставщика")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-item-"+e.id+"-supplier",accordion:"receipt-item-"+e.id+"-agent-supplier-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Телефон(ы)","label-for":"item"+e.id+"supplierPhones",description:"тег 1171"}},[r("b-form-textarea",{attrs:{id:"item"+e.id+"supplierPhones",size:"sm","max-rows":"4",required:"",disabled:e.disabled},model:{value:e.supplierPhones,callback:function(t){e.supplierPhones=t},expression:"supplierPhones"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Наименование","label-for":"item"+e.id+"supplierName",description:"тег 1225"}},[r("b-form-input",{attrs:{id:"item"+e.id+"supplierName",type:"text",size:"sm",disabled:e.disabled},model:{value:e.model["supplier_info.name"],callback:function(t){e.$set(e.model,"supplier_info.name",t)},expression:"model['supplier_info.name']"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"ИНН","label-for":"item"+e.id+"supplierInn",description:"тег 1226"}},[r("b-form-input",{attrs:{id:"item"+e.id+"supplierInn",type:"text",size:"sm",pattern:"\\d{10}|\\d{12}",maxlength:"12",disabled:e.disabled},model:{value:e.model["supplier_info.inn"],callback:function(t){e.$set(e.model,"supplier_info.inn",t)},expression:"model['supplier_info.inn']"}})],1)],1)],1)],1)],1)],1)],1)],1):e._e()],1)}),[],!1,null,null,null).exports},data:function(){return{ready:!1,showPreview:!1,receipt:new i.Z,vats:{without_vat:null,with_vat0:null,vat10:null,vat20:null,vat110:null,vat120:null},agentInfo:{type:null,paying_agent:{operation:null,phones:null},receive_payments_operator:{phones:null},money_transfer_operator:{phones:null,name:null,address:null,inn:null}}}},mounted:function(){this.handleRoute(this.$route),this.enumConnections(),this.listenEvents()},methods:{handleRoute:function(e){var t=arguments,r=this;return b(n().mark((function a(){var i;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:i=t.length>1&&void 0!==t[1]?t[1]:null,a.t0=e.name,a.next="receipt"===a.t0?4:"new-receipt"===a.t0?7:"new-receipt-from-existing"===a.t0?9:15;break;case 4:return a.next=6,r.loadReceipt(e.params.id);case 6:return a.abrupt("break",15);case 7:return r.resetReceipt(),a.abrupt("break",15);case 9:if(null===i||"receipt"!==i.name||+e.params.id!=+i.params.id){a.next=13;break}r.shrinkReceipt(),a.next=15;break;case 13:return a.next=15,r.loadReceipt(e.params.id,!0);case 15:case"end":return a.stop()}}),a)})))()},listenEvents:function(){var e=this;this.$echo.listen(".receipt.processed",(function(t){t.id===e.receipt.id&&(e.receipt=t)}))},resetReceipt:function(){this.receipt=new i.Z({id:null,state:0,connection:null,operation:null,external_id:null,internal_id:null,payload:{client:{email:null,phone:null,name:null,inn:null},company:{name:null,email:null,inn:null,payment_address:null,payment_site:null,tax_system:null},agent_info:null,supplier_info:null,items:[],payments:{cash:0,electronic:0,prepaid:0,postpaid:0,other:0},vats:null,total:0,additional_check_props:null,cashier:null,additional_user_props:null},result:null}),this.ready=!0},shrinkReceipt:function(){this.receipt.id=null,this.receipt.state=0,this.receipt.external_id=null,this.receipt.internal_id=null,this.receipt.result=null},loadReceipt:function(e){var t=arguments,r=this;return b(n().mark((function a(){var o;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=t.length>1&&void 0!==t[1]&&t[1],r.ready=!1,a.next=4,i.Z.find(e);case 4:r.receipt=a.sent,o&&r.shrinkReceipt(),r.ready=!0;case 7:case"end":return a.stop()}}),a)})))()},saveReceipt:function(){var e=this;return b(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.receipt.save();case 3:e.receipt=t.sent,e.receipt.id&&e.$router.replace({name:"receipt",params:{id:e.receipt.id}}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object.values(t.t0.response.data.errors).forEach((function(t){return e.$bvToast.toast(t.map((function(t){return e.$createElement("div",t)})),{toaster:"b-toaster-bottom-right",variant:"danger",solid:!0,noCloseButton:!0})}));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},registerReceipt:function(){var e=this;return b(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.saveReceipt();case 2:return t.next=4,e.receipt.register();case 4:case"end":return t.stop()}}),t)})))()},syncReceipt:function(){var e=this;return b(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.receipt.sync();case 2:case"end":return t.stop()}}),t)})))()},deleteReceipt:function(){var e=this;return b(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!confirm("Удалить чек?")){t.next=4;break}return t.next=3,e.receipt.delete();case 3:e.$router.replace({name:"receipts"});case 4:case"end":return t.stop()}}),t)})))()},addItem:function(){this.receipt.payload.items.push({agent_info:null,country_code:null,declaration_number:null,excise:null,measurement_unit:null,name:"",nomenclature_code:null,payment_method:"full_prepayment",payment_object:"commodity",price:null,quantity:1,sum:null,supplier_info:null,user_data:null,vat:{sum:null,type:"vat20"}})},removeItem:function(e){this.receipt.payload.items.splice(e,1)},getVats:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r={without_vat:0,with_vat0:0,vat10:0,vat20:0,vat110:0,vat120:0};if(t){var a,n=p(this.receipt.payload.items);try{for(n.s();!(a=n.n()).done;){var i=a.value;switch(null!==(e=null==i?void 0:i.vat.type)&&void 0!==e?e:"none"){case"vat20":case"vat18":r.vat20+=this.extractVat(i.sum,i.vat.type);break;case"vat10":r.vat10+=this.extractVat(i.sum,i.vat.type);break;case"vat0":r.with_vat0+=i.sum;break;case"none":r.without_vat+=i.sum;break;case"vat120":case"vat118":r.vat120+=this.extractVat(i.sum,i.vat.type);break;case"vat110":r.vat110+=this.extractVat(i.sum,i.vat.type)}}}catch(e){n.e(e)}finally{n.f()}}return r},fitContent:function(e){e.target.style.height=e.target.contentDocument.body.scrollHeight+20+"px"},printReceipt:function(){var e=window.open(window.FiscalRegistrar.basePath+"/api/v1/receipts/"+this.receipt.id+"/preview","ReceiptPreview","popup,width=500,height=1000");e.onafterprint=e.close,e.onload=function(){e.setTimeout(e.print)}}},computed:{title:function(){return(this.receipt.id?0===this.receipt.state?"Редактирование":"Просмотр":"Создание")+" кассового чека"},model:function(){return this.$deepModel(this.receipt.payload)},selectConnections:function(){return[{value:null,text:"автоопределение"}].concat(c(this.buildOptions(this.connections,(function(e){var t=l(e,2);return{value:t[0],text:t[1].display_name}}))))},isClientEmailRequired:function(){return!this.receipt.payload.client.phone},isClientPhoneRequired:function(){return!this.receipt.payload.client.email},companyEmailPlaceholder:function(){var e,t,r;return null!==(e=null===(t=this.connections[this.receipt.connection])||void 0===t||null===(r=t.company)||void 0===r?void 0:r.email)&&void 0!==e?e:"contact@myshop.com"},companyNamePlaceholder:function(){var e,t,r;return null!==(e=null===(t=this.connections[this.receipt.connection])||void 0===t||null===(r=t.company)||void 0===r?void 0:r.name)&&void 0!==e?e:'ООО "Рога и Копыта"'},companyInnPlaceholder:function(){var e,t,r;return null!==(e=null===(t=this.connections[this.receipt.connection])||void 0===t||null===(r=t.company)||void 0===r?void 0:r.inn)&&void 0!==e?e:"1234567890"},companyPaymentSitePlaceholder:function(){var e,t,r;return null!==(e=null===(t=this.connections[this.receipt.connection])||void 0===t||null===(r=t.company)||void 0===r?void 0:r.payment_site)&&void 0!==e?e:"https://www.myshop.com"},companyPaymentAddressPlaceholder:function(){var e,t,r;return null!==(e=null===(t=this.connections[this.receipt.connection])||void 0===t||null===(r=t.company)||void 0===r?void 0:r.payment_address)&&void 0!==e?e:""},vatsPlaceholder:function(){return Object.fromEntries(Object.entries(this.getVats(!this.receipt.payload.vats)).map((function(e){var t=l(e,2),r=t[0],a=t[1];return[r,String(a)]})))},vatsWithoutVat:{get:function(){var e,t;return null!==(e=null===(t=this.receipt.payload.vats)||void 0===t?void 0:t.without_vat)&&void 0!==e?e:null},set:function(e){var t,r;null!==(r=(t=this.receipt.payload).vats)&&void 0!==r||(t.vats=this.vats),this.receipt.payload.vats.without_vat=e||null}},vatsWithVat0:{get:function(){var e,t;return null!==(e=null===(t=this.receipt.payload.vats)||void 0===t?void 0:t.with_vat0)&&void 0!==e?e:null},set:function(e){var t,r;null!==(r=(t=this.receipt.payload).vats)&&void 0!==r||(t.vats=this.vats),this.receipt.payload.vats.with_vat0=e||null}},vatsVat10:{get:function(){var e,t;return null!==(e=null===(t=this.receipt.payload.vats)||void 0===t?void 0:t.vat10)&&void 0!==e?e:null},set:function(e){var t,r;null!==(r=(t=this.receipt.payload).vats)&&void 0!==r||(t.vats=this.vats),this.receipt.payload.vats.vat10=e||null}},vatsVat20:{get:function(){var e,t;return null!==(e=null===(t=this.receipt.payload.vats)||void 0===t?void 0:t.vat20)&&void 0!==e?e:null},set:function(e){var t,r;null!==(r=(t=this.receipt.payload).vats)&&void 0!==r||(t.vats=this.vats),this.receipt.payload.vats.vat20=e||null}},vatsVat110:{get:function(){var e,t;return null!==(e=null===(t=this.receipt.payload.vats)||void 0===t?void 0:t.vat110)&&void 0!==e?e:null},set:function(e){var t,r;null!==(r=(t=this.receipt.payload).vats)&&void 0!==r||(t.vats=this.vats),this.receipt.payload.vats.vat110=e||null}},vatsVat120:{get:function(){var e,t;return null!==(e=null===(t=this.receipt.payload.vats)||void 0===t?void 0:t.vat120)&&void 0!==e?e:null},set:function(e){var t,r;null!==(r=(t=this.receipt.payload).vats)&&void 0!==r||(t.vats=this.vats),this.receipt.payload.vats.vat120=e||null}},agentType:{get:function(){var e,t;return null!==(e=null===(t=this.receipt.payload.agent_info)||void 0===t?void 0:t.type)&&void 0!==e?e:null},set:function(e){var t,r;null!==(r=(t=this.receipt.payload).agent_info)&&void 0!==r||(t.agent_info=this.agentInfo),this.receipt.payload.agent_info.type=e||null}},payingAgentPhones:{get:function(){var e;return null===(e=this.model["agent_info.paying_agent.phones"])||void 0===e?void 0:e.join("\n")},set:function(e){e=e.split("\n").map((function(e){return e.trim()})).filter((function(e){return null!=e&&""!==e})),this.model["agent_info.paying_agent.phones"]=e.length?e:null}},receivePaymentsOperatorPhones:{get:function(){var e;return null===(e=this.model["agent_info.receive_payments_operator.phones"])||void 0===e?void 0:e.join("\n")},set:function(e){e=e.split("\n").map((function(e){return e.trim()})).filter((function(e){return null!=e&&""!==e})),this.model["agent_info.receive_payments_operator.phones"]=e.length?e:null}},moneyTransferOperatorPhones:{get:function(){var e;return null===(e=this.model["agent_info.money_transfer_operator.phones"])||void 0===e?void 0:e.join("\n")},set:function(e){e=e.split("\n").map((function(e){return e.trim()})).filter((function(e){return null!=e&&""!==e})),this.model["agent_info.money_transfer_operator.phones"]=e.length?e:null}},supplierPhones:{get:function(){var e;return null===(e=this.model["supplier_info.phones"])||void 0===e?void 0:e.join("\n")},set:function(e){e=e.split("\n").map((function(e){return e.trim()})).filter((function(e){return null!=e&&""!==e})),this.model["supplier_info.phones"]=e.length?e:null}},resultPayloadFnsSite:function(){return/^https?:\/\//i.test(this.receipt.result.payload.fns_site)?this.receipt.result.payload.fns_site:"https://"+this.receipt.result.payload.fns_site}},watch:{$route:function(e,t){this.handleRoute(e,t)},"receipt.payload.items":{handler:function(e){this.receipt.payload.total=e.reduce((function(e,t){return e+t.sum}),0)},deep:!0},"receipt.payload.vats":{handler:function(e){null!==e&&Object.values(e).every((function(e){return null===e}))&&(this.receipt.payload.vats=null)},deep:!0},"receipt.payload.agent_info":{handler:function(e){this.receipt.payload.agent_info=null===(null==e?void 0:e.type)?null:this.emptify(e)},deep:!0}}},v=f;var y=r(3379),g=r.n(y),h=r(7429),_={insert:"head",singleton:!1};g()(h.Z,_);h.Z.locals;const x=(0,s.Z)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.ready?r("h2",{staticClass:"text-center"},[e._v(e._s(e.title))]):e._e(),e._v(" "),e.ready?r("b-form",{attrs:{validated:""},on:{submit:function(t){return t.preventDefault(),e.saveReceipt.apply(null,arguments)}}},[r("div",{staticClass:"accordion",attrs:{role:"tablist"}},[r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-attributes",modifiers:{"receipt-attributes":!0}}],attrs:{block:"",variant:"info"}},[e._v("Атрибуты документа")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-attributes",visible:"",accordion:"receipt-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-card-text",[e._v("\n                            TODO\n                        ")]),e._v(" "),r("b-form-group",{attrs:{disabled:0!==e.receipt.state}},[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Подключение","label-for":"receiptConnection"}},[r("b-form-select",{attrs:{id:"receiptConnection",size:"sm",options:e.selectConnections},model:{value:e.receipt.connection,callback:function(t){e.$set(e.receipt,"connection",t)},expression:"receipt.connection"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Операция","label-for":"receiptOperation"}},[r("b-form-select",{attrs:{id:"receiptOperation",size:"sm",required:"",options:e.buildOptions(e.dictionary.operations)},model:{value:e.receipt.operation,callback:function(t){e.$set(e.receipt,"operation",t)},expression:"receipt.operation"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Уникальный идентификатор","label-for":"receiptExternalId"}},[r("b-form-input",{attrs:{id:"receiptExternalId",type:"text",size:"sm"},model:{value:e.receipt.external_id,callback:function(t){e.$set(e.receipt,"external_id",t)},expression:"receipt.external_id"}})],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-client",modifiers:{"receipt-client":!0}}],attrs:{block:"",variant:"info"}},[e._v("Данные клиента")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-client",accordion:"receipt-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-card-text",[e._v("\n                            В запросе обязательно должно быть заполнено хотя бы одно из полей: "),r("code",[e._v("email")]),e._v(" или "),r("code",[e._v("phone")]),e._v("."),r("br"),e._v("\n                            Если заполнены оба поля, ОФД отправит электронный чек только на email.\n                        ")]),e._v(" "),r("b-form-group",{attrs:{disabled:0!==e.receipt.state}},[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{class:e.isClientEmailRequired&&"required",attrs:{label:"Электронный адрес","label-for":"clientEmail",description:"тег 1008"}},[r("b-form-input",{attrs:{id:"clientEmail",type:"email",size:"sm",placeholder:"user@domain.com",required:e.isClientEmailRequired},model:{value:e.receipt.payload.client.email,callback:function(t){e.$set(e.receipt.payload.client,"email",t)},expression:"receipt.payload.client.email"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{class:e.isClientPhoneRequired&&"required",attrs:{label:"Телефон","label-for":"clientPhone",description:"тег 1008"}},[r("b-form-input",{attrs:{id:"clientPhone",type:"tel",size:"sm",placeholder:"+79001234567",required:e.isClientPhoneRequired},model:{value:e.receipt.payload.client.phone,callback:function(t){e.$set(e.receipt.payload.client,"phone",t)},expression:"receipt.payload.client.phone"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Наименование","label-for":"clientName",description:"тег 1227"}},[r("b-form-input",{attrs:{id:"clientName",type:"text",size:"sm",placeholder:"Иван Иванович Иванов"},model:{value:e.receipt.payload.client.name,callback:function(t){e.$set(e.receipt.payload.client,"name",t)},expression:"receipt.payload.client.name"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"ИНН","label-for":"clientInn",description:"тег 1228"}},[r("b-form-input",{attrs:{id:"clientInn",type:"text",size:"sm",placeholder:"1234567890",pattern:"\\d{10}|\\d{12}",maxlength:"12"},model:{value:e.receipt.payload.client.inn,callback:function(t){e.$set(e.receipt.payload.client,"inn",t)},expression:"receipt.payload.client.inn"}})],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-company",modifiers:{"receipt-company":!0}}],attrs:{block:"",variant:"info"}},[e._v("Данные организации")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-company",accordion:"receipt-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-card-text",[e._v("\n                            Оставьте поля пустыми для автоматической подстановки параметров из конфигурации подключения при проводке чека.\n                        ")]),e._v(" "),r("b-form-group",{attrs:{disabled:0!==e.receipt.state}},[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Электронный адрес","label-for":"companyEmail",description:"тег 1117"}},[r("b-form-input",{attrs:{id:"companyEmail",type:"email",size:"sm",placeholder:e.companyEmailPlaceholder},model:{value:e.receipt.payload.company.email,callback:function(t){e.$set(e.receipt.payload.company,"email",t)},expression:"receipt.payload.company.email"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Наименование","label-for":"companyName",description:"тег 1048"}},[r("b-form-input",{attrs:{id:"companyName",type:"text",size:"sm",placeholder:e.companyNamePlaceholder},model:{value:e.receipt.payload.company.name,callback:function(t){e.$set(e.receipt.payload.company,"name",t)},expression:"receipt.payload.company.name"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"ИНН","label-for":"companyInn",description:"тег 1018"}},[r("b-form-input",{attrs:{id:"companyInn",type:"text",size:"sm",placeholder:e.companyInnPlaceholder,pattern:"\\d{10}|\\d{12}",maxlength:"12"},model:{value:e.receipt.payload.company.inn,callback:function(t){e.$set(e.receipt.payload.company,"inn",t)},expression:"receipt.payload.company.inn"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Система налогообложения","label-for":"taxSystem",description:"тег 1055"}},[r("b-form-select",{attrs:{id:"taxSystem",size:"sm",options:e.taxSystemOptions},model:{value:e.receipt.payload.company.tax_system,callback:function(t){e.$set(e.receipt.payload.company,"tax_system",t)},expression:"receipt.payload.company.tax_system"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Место расчетов","label-for":"companyPaymentSite",description:"тег 1187"}},[r("b-form-input",{attrs:{id:"companyPaymentSite",type:"text",size:"sm",placeholder:e.companyPaymentSitePlaceholder},model:{value:e.receipt.payload.company.payment_site,callback:function(t){e.$set(e.receipt.payload.company,"payment_site",t)},expression:"receipt.payload.company.payment_site"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Адрес расчетов","label-for":"companyPaymentAddress",description:"тег 1009"}},[r("b-form-input",{attrs:{id:"companyPaymentAddress",type:"text",size:"sm",placeholder:e.companyPaymentAddressPlaceholder},model:{value:e.receipt.payload.company.payment_address,callback:function(t){e.$set(e.receipt.payload.company,"payment_address",t)},expression:"receipt.payload.company.payment_address"}})],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-agent-supplier",modifiers:{"receipt-agent-supplier":!0}}],attrs:{block:"",variant:"info"}},[e._v("Данные агента и поставщика")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-agent-supplier",accordion:"receipt-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-card-text",[e._v("\n                            TODO\n                        ")]),e._v(" "),r("b-form-group",{attrs:{disabled:0!==e.receipt.state}},[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Признак агента","label-for":"agentType",description:"тег 1057"}},[r("b-form-select",{attrs:{id:"agentType",size:"sm",options:e.agentTypeOptions},model:{value:e.agentType,callback:function(t){e.agentType=t},expression:"agentType"}})],1)],1)],1)],1),e._v(" "),null!==e.agentType?r("div",{staticClass:"accordion",attrs:{role:"tablist"}},[r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-paying-agent",modifiers:{"receipt-paying-agent":!0}}],attrs:{block:""}},[e._v("Атрибуты платежного агента")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-paying-agent",accordion:"receipt-agent-supplier-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Наименование операции","label-for":"payingAgentOperation",description:"тег 1044"}},[r("b-form-input",{attrs:{id:"payingAgentOperation",type:"text",size:"sm"},model:{value:e.model["agent_info.paying_agent.operation"],callback:function(t){e.$set(e.model,"agent_info.paying_agent.operation",t)},expression:"model['agent_info.paying_agent.operation']"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"payingAgentPhones",description:"тег 1073"}},[r("b-form-textarea",{attrs:{id:"payingAgentPhones",size:"sm","max-rows":"4"},model:{value:e.payingAgentPhones,callback:function(t){e.payingAgentPhones=t},expression:"payingAgentPhones"}})],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-receive-payments-operator",modifiers:{"receipt-receive-payments-operator":!0}}],attrs:{block:""}},[e._v("Атрибуты оператора по приему платежей")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-receive-payments-operator",accordion:"receipt-agent-supplier-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"receivePaymentsOperatorPhones",description:"тег 1074"}},[r("b-form-textarea",{attrs:{id:"receivePaymentsOperatorPhones",size:"sm","max-rows":"4"},model:{value:e.receivePaymentsOperatorPhones,callback:function(t){e.receivePaymentsOperatorPhones=t},expression:"receivePaymentsOperatorPhones"}})],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-money-transfer-operator",modifiers:{"receipt-money-transfer-operator":!0}}],attrs:{block:""}},[e._v("Атрибуты оператора перевода")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-money-transfer-operator",accordion:"receipt-agent-supplier-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Телефон(ы)","label-for":"moneyTransferOperatorPhones",description:"тег 1075"}},[r("b-form-textarea",{attrs:{id:"moneyTransferOperatorPhones",size:"sm","max-rows":"4"},model:{value:e.moneyTransferOperatorPhones,callback:function(t){e.moneyTransferOperatorPhones=t},expression:"moneyTransferOperatorPhones"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Наименование","label-for":"moneyTransferOperatorName",description:"тег 1026"}},[r("b-form-input",{attrs:{id:"moneyTransferOperatorName",type:"text",size:"sm"},model:{value:e.model["agent_info.money_transfer_operator.name"],callback:function(t){e.$set(e.model,"agent_info.money_transfer_operator.name",t)},expression:"model['agent_info.money_transfer_operator.name']"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Адрес","label-for":"moneyTransferOperatorAddress",description:"тег 1005"}},[r("b-form-input",{attrs:{id:"moneyTransferOperatorAddress",type:"text",size:"sm"},model:{value:e.model["agent_info.money_transfer_operator.address"],callback:function(t){e.$set(e.model,"agent_info.money_transfer_operator.address",t)},expression:"model['agent_info.money_transfer_operator.address']"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"ИНН","label-for":"moneyTransferOperatorInn",description:"тег 1016"}},[r("b-form-input",{attrs:{id:"moneyTransferOperatorInn",type:"text",size:"sm",pattern:"\\d{10}|\\d{12}",maxlength:"12"},model:{value:e.model["agent_info.money_transfer_operator.inn"],callback:function(t){e.$set(e.model,"agent_info.money_transfer_operator.inn",t)},expression:"model['agent_info.money_transfer_operator.inn']"}})],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-supplier",modifiers:{"receipt-supplier":!0}}],attrs:{block:""}},[e._v("Атрибуты поставщика")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-supplier",accordion:"receipt-agent-supplier-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Телефон(ы)","label-for":"supplierPhones",description:"тег 1171"}},[r("b-form-textarea",{attrs:{id:"supplierPhones",size:"sm","max-rows":"4",required:""},model:{value:e.supplierPhones,callback:function(t){e.supplierPhones=t},expression:"supplierPhones"}})],1)],1)],1)],1)],1)],1)],1)],1):e._e()],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-items",modifiers:{"receipt-items":!0}}],attrs:{block:"",variant:"info"}},[e._v("Позиции документа")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-items",accordion:"receipt-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-card-text",[e._v("\n                            В документе должна быть как минимум одна позиция.\n                        ")]),e._v(" "),e._l(e.receipt.payload.items,(function(t,a){return[r("receipt-item",{key:a,attrs:{item:t,disabled:0!==e.receipt.state},on:{remove:function(t){return e.removeItem(a)}}}),e._v(" "),r("hr")]})),e._v(" "),r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"1",md:"2",sm:"3"}},[r("b-form-group",{staticClass:"required",attrs:{label:"Всего на сумму","label-for":"total",description:"тег 1020"}},[r("b-form-input",{attrs:{id:"total",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0",required:"",disabled:0!==e.receipt.state},model:{value:e.receipt.payload.total,callback:function(t){e.$set(e.receipt.payload,"total",t)},expression:"receipt.payload.total"}})],1)],1),e._v(" "),r("b-col",{staticClass:"mb-sm-3",attrs:{"align-self":"end",lg:"1",md:"2",sm:"3"}},[r("b-button",{staticClass:"mb-sm-4",attrs:{variant:"primary",size:"sm",disabled:0!==e.receipt.state},on:{click:e.addItem}},[e._v("Добавить")])],1)],1)],1)],2)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-payments",modifiers:{"receipt-payments":!0}}],attrs:{block:"",variant:"info"}},[e._v("Данные по оплате")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-payments",accordion:"receipt-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-card-text",[e._v("\n                            TODO\n                        ")]),e._v(" "),r("b-form-group",{attrs:{disabled:0!==e.receipt.state}},[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Наличными","label-for":"paymentCash",description:"тег 1031"}},[r("b-form-input",{attrs:{id:"paymentCash",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:e.receipt.payload.payments.cash,callback:function(t){e.$set(e.receipt.payload.payments,"cash",t)},expression:"receipt.payload.payments.cash"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Безналичными","label-for":"paymentElectronic",description:"тег 1081"}},[r("b-form-input",{attrs:{id:"paymentElectronic",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:e.receipt.payload.payments.electronic,callback:function(t){e.$set(e.receipt.payload.payments,"electronic",t)},expression:"receipt.payload.payments.electronic"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Предоплатой","label-for":"paymentPrepaid",description:"тег 1215"}},[r("b-form-input",{attrs:{id:"paymentPrepaid",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:e.receipt.payload.payments.prepaid,callback:function(t){e.$set(e.receipt.payload.payments,"prepaid",t)},expression:"receipt.payload.payments.prepaid"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Постоплатой","label-for":"paymentPostpaid",description:"тег 1216"}},[r("b-form-input",{attrs:{id:"paymentPostpaid",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:e.receipt.payload.payments.postpaid,callback:function(t){e.$set(e.receipt.payload.payments,"postpaid",t)},expression:"receipt.payload.payments.postpaid"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Встр. предст.","label-for":"paymentOther",description:"тег 1217"}},[r("b-form-input",{attrs:{id:"paymentOther",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:"0"},model:{value:e.receipt.payload.payments.other,callback:function(t){e.$set(e.receipt.payload.payments,"other",t)},expression:"receipt.payload.payments.other"}})],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-vats",modifiers:{"receipt-vats":!0}}],attrs:{block:"",variant:"info"}},[e._v("НДС на чек")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-vats",accordion:"receipt-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-card-text",[e._v("\n                            Необходимо передать либо сумму налога на позицию, либо сумму налога на чек. Если будет переданы и сумма налога на позицию и сумма налога на чек, сервис учтет только сумму налога на чек.\n                            "),e.receipt.payload.vats?r("span",[e._v("В данный момент используются суммы налога на чек. Для возврата к использованию сумм налога на позицию, очистите все поля в этом разделе.")]):r("span",[e._v("В данный момент используются суммы налога на позицию. В полях ниже можно увидеть их расчетные величины.")])]),e._v(" "),r("b-form-group",{attrs:{disabled:0!==e.receipt.state}},[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Сумма расчета по чеку без НДС","label-for":"withoutVat",description:"тег 1105"}},[r("b-form-input",{attrs:{id:"withoutVat",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:e.vatsPlaceholder.without_vat},model:{value:e.vatsWithoutVat,callback:function(t){e.vatsWithoutVat=e._n(t)},expression:"vatsWithoutVat"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Сумма расчета по чеку с НДС 0%","label-for":"withVat0",description:"тег 1104"}},[r("b-form-input",{attrs:{id:"withVat0",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:e.vatsPlaceholder.with_vat0},model:{value:e.vatsWithVat0,callback:function(t){e.vatsWithVat0=e._n(t)},expression:"vatsWithVat0"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Сумма НДС чека по ставке 10%","label-for":"vat10",description:"тег 1103"}},[r("b-form-input",{attrs:{id:"vat10",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:e.vatsPlaceholder.vat10},model:{value:e.vatsVat10,callback:function(t){e.vatsVat10=e._n(t)},expression:"vatsVat10"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Сумма НДС чека по ставке 20%","label-for":"vat20",description:"тег 1102"}},[r("b-form-input",{attrs:{id:"vat20",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:e.vatsPlaceholder.vat20},model:{value:e.vatsVat20,callback:function(t){e.vatsVat20=e._n(t)},expression:"vatsVat20"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Сумма НДС чека по расч. ставке 10/110","label-for":"vat110",description:"тег 1107"}},[r("b-form-input",{attrs:{id:"vat110",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:e.vatsPlaceholder.vat110},model:{value:e.vatsVat110,callback:function(t){e.vatsVat110=e._n(t)},expression:"vatsVat110"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Сумма НДС чека по расч. ставке 20/120","label-for":"vat120",description:"тег 1106"}},[r("b-form-input",{attrs:{id:"vat120",type:"number",min:"0",max:"42949672.95",step:".01",size:"sm",placeholder:e.vatsPlaceholder.vat120},model:{value:e.vatsVat120,callback:function(t){e.vatsVat120=e._n(t)},expression:"vatsVat120"}})],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-misc",modifiers:{"receipt-misc":!0}}],attrs:{block:"",variant:"info"}},[e._v("Дополнительные реквизиты")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-misc",accordion:"receipt-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-form-group",{attrs:{disabled:0!==e.receipt.state}},[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Доп. реквизит чека","label-for":"additionalCheckProps",description:"тег 1192"}},[r("b-form-input",{attrs:{id:"additionalCheckProps",type:"text",size:"sm",maxlength:"16"},model:{value:e.receipt.payload.additional_check_props,callback:function(t){e.$set(e.receipt.payload,"additional_check_props",t)},expression:"receipt.payload.additional_check_props"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"5",sm:"8"}},[r("b-form-group",{attrs:{label:"ФИО кассира","label-for":"cashier",description:"тег 1021"}},[r("b-form-input",{attrs:{id:"cashier",type:"text",size:"sm",maxlength:"64"},model:{value:e.receipt.payload.cashier,callback:function(t){e.$set(e.receipt.payload,"cashier",t)},expression:"receipt.payload.cashier"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"3",md:"4",sm:"6"}},[r("b-form-group",{attrs:{label:"Наим. доп. рекв. пользователя","label-for":"additionalUserPropsName",description:"тег 1085"}},[r("b-form-input",{attrs:{id:"additionalUserPropsName",type:"text",size:"sm",maxlength:"64"},model:{value:e.model["additional_user_props.name"],callback:function(t){e.$set(e.model,"additional_user_props.name",t)},expression:"model['additional_user_props.name']"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"4",md:"8",sm:"12"}},[r("b-form-group",{attrs:{label:"Знач. доп. рекв. пользователя","label-for":"additionalUserPropsValue",description:"тег 1086"}},[r("b-form-input",{attrs:{id:"additionalUserPropsValue",type:"text",size:"sm",maxlength:"256"},model:{value:e.model["additional_user_props.value"],callback:function(t){e.$set(e.model,"additional_user_props.value",t)},expression:"model['additional_user_props.value']"}})],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),e.receipt.result?r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-result",modifiers:{"receipt-result":!0}}],attrs:{block:"",variant:"info"}},[e._v("Результат обработки")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-result",accordion:"receipt-accordion",role:"tabpanel"}},[r("b-card-body",[r("b-card-sub-title",{staticClass:"mb-3"},[e._v("Информация поставщика")]),e._v(" "),r("b-container",{attrs:{fluid:""}},[r("b-form-row",[r("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[r("b-form-group",{attrs:{description:"Дата и время"}},[e._v("\n                                        "+e._s(e.formatTime(e.receipt.result.timestamp))+"\n                                    ")])],1),e._v(" "),r("b-col",{staticClass:"mb-3",attrs:{lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{description:"Внутренний идентификатор"}},[e._v("\n                                        "+e._s(e.receipt.result.internal_id)+"\n                                    ")])],1)],1)],1),e._v(" "),e.receipt.result.payload?r("b-card-sub-title",{staticClass:"mb-3"},[e._v("Информация ОФД")]):e._e(),e._v(" "),e.receipt.result.payload?r("b-container",{attrs:{fluid:""}},[r("b-form-row",[r("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[r("b-form-group",{attrs:{description:"Дата и время (тег 1012)"}},[e._v("\n                                        "+e._s(e.formatTime(e.receipt.result.payload.receipt_datetime,"DD.MM.YYYY HH:mm"))+"\n                                    ")])],1),e._v(" "),r("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[r("b-form-group",{attrs:{description:"Номер смены (тег 1038)"}},[e._v("\n                                        "+e._s(e.receipt.result.payload.shift_number)+"\n                                    ")])],1),e._v(" "),r("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[r("b-form-group",{attrs:{description:"Номер чека в смене (тег 1042)"}},[e._v("\n                                        "+e._s(e.receipt.result.payload.fiscal_receipt_number)+"\n                                    ")])],1),e._v(" "),r("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[r("b-form-group",{attrs:{description:"Сумма расчета (тег 1020)"}},[e._v("\n                                        "+e._s(e.receipt.result.payload.total)+"\n                                    ")])],1),e._v(" "),r("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[r("b-form-group",{attrs:{description:"Рег. номер ККТ (тег 1037)"}},[e._v("\n                                        "+e._s(e.receipt.result.payload.ecr_registration_number)+"\n                                    ")])],1),e._v(" "),r("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[r("b-form-group",{attrs:{description:"Номер ФН (тег 1041)"}},[e._v("\n                                        "+e._s(e.receipt.result.payload.fn_number)+"\n                                    ")])],1),e._v(" "),r("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[r("b-form-group",{attrs:{description:"Фискальный номер документа (тег 1040)"}},[e._v("\n                                        "+e._s(e.receipt.result.payload.fiscal_document_number)+"\n                                    ")])],1),e._v(" "),r("b-col",{staticClass:"mb-3",attrs:{lg:"1",md:"2",sm:"3"}},[r("b-form-group",{attrs:{description:"Фискальный признак документа (тег 1077)"}},[e._v("\n                                        "+e._s(e.receipt.result.payload.fiscal_document_attribute)+"\n                                    ")])],1),e._v(" "),r("b-col",{staticClass:"mb-3",attrs:{lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{description:"Адрес сайта ФНС (тег 1060)"}},[r("b-link",{attrs:{href:e.resultPayloadFnsSite,target:"_blank"}},[e._v(e._s(e.resultPayloadFnsSite))])],1)],1)],1)],1):e._e()],1)],1)],1):e._e(),e._v(" "),e.receipt.id?r("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[r("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[r("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.receipt-preview",modifiers:{"receipt-preview":!0}}],attrs:{block:"",variant:"info"}},[e._v("Просмотр чека")])],1),e._v(" "),r("b-collapse",{attrs:{id:"receipt-preview",accordion:"receipt-accordion",role:"tabpanel"},on:{show:function(t){e.showPreview=!0}}},[r("b-card-body",{staticClass:"px-0"},[e.showPreview?r("iframe",{attrs:{src:e.FiscalRegistrar.basePath+"/api/v1/receipts/"+e.receipt.id+"/preview",width:"100%"},on:{load:e.fitContent}}):e._e()])],1)],1):e._e()],1),e._v(" "),r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-3"},[r("b-col",{attrs:{sm:"8"}},[0===e.receipt.state?r("b-button",{staticClass:"mb-1",attrs:{type:"submit",variant:"primary",size:"sm"}},[e._v("Сохранить")]):e._e(),e._v(" "),e.receipt.id?r("b-button",{staticClass:"mb-1",attrs:{variant:"primary",size:"sm",to:{name:"new-receipt-from-existing",params:{id:e.receipt.id}}}},[e._v("Дублировать")]):e._e(),e._v(" "),0===e.receipt.state?r("b-button",{staticClass:"mb-1",attrs:{variant:"success",size:"sm"},on:{click:e.registerReceipt}},[e._v("Зарегистрировать")]):e._e(),e._v(" "),1===e.receipt.state?r("b-button",{staticClass:"mb-1",attrs:{variant:"warning",size:"sm"},on:{click:e.syncReceipt}},[e._v("Синхронизировать")]):e._e(),e._v(" "),e.receipt.id?r("b-button",{staticClass:"mb-1",attrs:{size:"sm"},on:{click:e.printReceipt}},[e._v("Распечатать")]):e._e(),e._v(" "),e.receipt.result?r("b-button",{staticClass:"mb-1",attrs:{size:"sm",href:e.receipt.result.payload.ofd_receipt_url,target:"_blank"}},[e._v("Просмотреть в ОФД")]):e._e(),e._v(" "),e.receipt.id&&0===e.receipt.state?r("b-button",{staticClass:"mb-1",attrs:{variant:"danger",size:"sm"},on:{click:e.deleteReceipt}},[e._v("Удалить")]):e._e()],1),e._v(" "),r("b-col",{staticClass:"text-right",attrs:{sm:"4"}},[r("b-button",{staticClass:"mb-1",attrs:{size:"sm",to:{name:"receipts"}}},[e._v("К списку")])],1)],1)],1)],1):e._e()],1)}),[],!1,null,"7a108471",null).exports},960:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var a=r(7757),n=r.n(a),i=r(7666);function o(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var a,n,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){s=!0,n=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw n}}return i}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function p(e,t,r,a,n,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var i=e.apply(t,r);function o(e){p(i,a,n,o,s,"next",e)}function s(e){p(i,a,n,o,s,"throw",e)}o(void 0)}))}}const u={data:function(){return{fields:[{key:"id",label:"#"},{key:"created_at",label:"Время"},{key:"connection",label:"Соединение"},{key:"operation",label:"Тип"},{key:"payload.total",label:"Сумма"},{key:"state",label:"Статус"}],receipts:{},query:{filter:{}},page:1}},mounted:function(){this.resetFilter(),this.populateQuery(),this.enumConnections(),this.getReceipts()},methods:{resetFilter:function(){this.query.filter={id:null,external_id:null,internal_id:null,created_from:null,created_to:null,connection:null,operation:null,min_total:null,max_total:null,state:null,email:null,phone:null,fn:null,i:null,fd:null}},populateQuery:function(){localStorage["fiscal-registrar.query"]&&(this.query=JSON.parse(localStorage["fiscal-registrar.query"])),localStorage["fiscal-registrar.page"]&&(this.page=+localStorage["fiscal-registrar.page"])},getReceipts:function(){var e=arguments,t=this;return d(n().mark((function r(){var a,o;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(a=e.length>0&&void 0!==e[0]?e[0]:null)&&(t.page=a),o=new i.Z,Object.entries(t.query.filter).filter((function(e){var t=s(e,2);t[0];return!!t[1]})).forEach((function(e){var t=s(e,2),r=t[0],a=t[1];return o.where(r,a)})),t.page&&o.page(t.page),r.next=7,o.get();case 7:t.receipts=r.sent;case 8:case"end":return r.stop()}}),r)})))()}},computed:{selectConnections:function(){return[{value:null,text:"любое"}].concat(o(this.buildOptions(this.connections,(function(e){var t=s(e,2);return{value:t[0],text:t[1].display_name}}))))},selectOperations:function(){return[{value:null,text:"все"}].concat(o(this.buildOptions(this.dictionary.operations)))},selectStates:function(){return[{value:null,text:"любой"}].concat(o(this.buildOptions(this.dictionary.states)))}},watch:{query:{handler:function(e){localStorage["fiscal-registrar.query"]=JSON.stringify(e),this.getReceipts(1)},deep:!0},page:function(e){localStorage["fiscal-registrar.page"]=e}}};const m=(0,r(1900).Z)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h2",{staticClass:"text-center"},[e._v("Кассовые чеки")]),e._v(" "),r("b-form-group",[r("b-container",{attrs:{fluid:""}},[r("b-form-row",{staticClass:"my-1"},[r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Порядковый номер","label-for":"receiptId"}},[r("b-form-input",{attrs:{id:"receiptId",type:"number",size:"sm",debounce:"500"},model:{value:e.query.filter.id,callback:function(t){e.$set(e.query.filter,"id",t)},expression:"query.filter.id"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Уникальный идентификатор","label-for":"receiptExternalId"}},[r("b-form-input",{attrs:{id:"receiptExternalId",type:"text",size:"sm",debounce:"500"},model:{value:e.query.filter.external_id,callback:function(t){e.$set(e.query.filter,"external_id",t)},expression:"query.filter.external_id"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Идентификатор поставщика","label-for":"receiptInternalId"}},[r("b-form-input",{attrs:{id:"receiptInternalId",type:"text",size:"sm",debounce:"500"},model:{value:e.query.filter.internal_id,callback:function(t){e.$set(e.query.filter,"internal_id",t)},expression:"query.filter.internal_id"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Время создания от","label-for":"receiptCreatedFrom"}},[r("b-form-input",{attrs:{id:"receiptCreatedFrom",type:"datetime-local",size:"sm"},model:{value:e.query.filter.created_from,callback:function(t){e.$set(e.query.filter,"created_from",t)},expression:"query.filter.created_from"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Время создания до","label-for":"receiptCreatedTo"}},[r("b-form-input",{attrs:{id:"receiptCreatedTo",type:"datetime-local",size:"sm"},model:{value:e.query.filter.created_to,callback:function(t){e.$set(e.query.filter,"created_to",t)},expression:"query.filter.created_to"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Соединение","label-for":"receiptConnection"}},[r("b-form-select",{attrs:{id:"receiptConnection",size:"sm",options:e.selectConnections},model:{value:e.query.filter.connection,callback:function(t){e.$set(e.query.filter,"connection",t)},expression:"query.filter.connection"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Операция","label-for":"receiptOperation"}},[r("b-form-select",{attrs:{id:"receiptOperation",size:"sm",options:e.selectOperations},model:{value:e.query.filter.operation,callback:function(t){e.$set(e.query.filter,"operation",t)},expression:"query.filter.operation"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Сумма от","label-for":"receiptMinTotal"}},[r("b-form-input",{attrs:{id:"receiptMinTotal",type:"number",min:"0",max:e.query.filter.max_total||42949672.95,step:".01",size:"sm",debounce:"500"},model:{value:e.query.filter.min_total,callback:function(t){e.$set(e.query.filter,"min_total",t)},expression:"query.filter.min_total"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Сумма до","label-for":"receiptMaxTotal"}},[r("b-form-input",{attrs:{id:"receiptMaxTotal",type:"number",min:e.query.filter.min_total||0,max:"42949672.95",step:".01",size:"sm",debounce:"500"},model:{value:e.query.filter.max_total,callback:function(t){e.$set(e.query.filter,"max_total",t)},expression:"query.filter.max_total"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Статус","label-for":"receiptState"}},[r("b-form-select",{attrs:{id:"receiptState",size:"sm",options:e.selectStates},model:{value:e.query.filter.state,callback:function(t){e.$set(e.query.filter,"state",t)},expression:"query.filter.state"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"E-mail клиента","label-for":"receiptClientEmail"}},[r("b-form-input",{attrs:{id:"receiptClientEmail",type:"email",size:"sm",placeholder:"user@domain.com",debounce:"500"},model:{value:e.query.filter.email,callback:function(t){e.$set(e.query.filter,"email",t)},expression:"query.filter.email"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"Телефон клиента","label-for":"receiptClientPhone"}},[r("b-form-input",{attrs:{id:"receiptClientPhone",type:"tel",size:"sm",placeholder:"+79001234567",debounce:"500"},model:{value:e.query.filter.phone,callback:function(t){e.$set(e.query.filter,"phone",t)},expression:"query.filter.phone"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"ФН","label-for":"receiptFnNumber"}},[r("b-form-input",{attrs:{id:"receiptFnNumber",type:"number",size:"sm",debounce:"500"},model:{value:e.query.filter.fn,callback:function(t){e.$set(e.query.filter,"fn",t)},expression:"query.filter.fn"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"ФД №","label-for":"receiptFiscalDocumentNumber"}},[r("b-form-input",{attrs:{id:"receiptFiscalDocumentNumber",type:"number",size:"sm",debounce:"500"},model:{value:e.query.filter.i,callback:function(t){e.$set(e.query.filter,"i",t)},expression:"query.filter.i"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{attrs:{label:"ФПД","label-for":"receiptFiscalDocumentAttribute"}},[r("b-form-input",{attrs:{id:"receiptFiscalDocumentAttribute",type:"number",size:"sm",debounce:"500"},model:{value:e.query.filter.fd,callback:function(t){e.$set(e.query.filter,"fd",t)},expression:"query.filter.fd"}})],1)],1),e._v(" "),r("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[r("b-form-group",{staticClass:"text-center"},[r("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:e.resetFilter}},[e._v("Очистить фильтр")])],1)],1)],1)],1)],1),e._v(" "),r("b-table",{attrs:{small:"",striped:"",hover:"",items:e.receipts.data,fields:e.fields},scopedSlots:e._u([{key:"cell(id)",fn:function(t){return[r("b-link",{attrs:{to:{name:"receipt",params:{id:t.value}}}},[e._v(e._s(t.value))])]}},{key:"cell(created_at)",fn:function(t){return[e._v("\n            "+e._s(e.formatTime(t.value))+"\n        ")]}},{key:"cell(connection)",fn:function(t){return[e._v("\n            "+e._s(t.value?e.connections[t.value].display_name:"-")+"\n        ")]}},{key:"cell(operation)",fn:function(t){return[e._v("\n            "+e._s(t.value?e.dictionary.operations[t.value]:"-")+"\n        ")]}},{key:"cell(payload.total)",fn:function(t){return[r("div",{staticClass:"text-right"},[e._v(e._s(t.value))])]}},{key:"cell(state)",fn:function(t){return[e._v("\n            "+e._s(e.dictionary.states[t.value])+"\n        ")]}}])}),e._v(" "),r("pagination",{attrs:{data:e.receipts,limit:2,"show-disabled":!0,align:"center"},on:{"pagination-change-page":e.getReceipts}}),e._v(" "),r("b-button",{attrs:{to:{name:"new-receipt"},variant:"primary",size:"sm"}},[e._v("Создать")])],1)}),[],!1,null,null,null).exports},4654:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[143,660],(()=>(t(7726),t(4347))));e.O()}]);