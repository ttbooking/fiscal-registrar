{"version":3,"file":"receipt-RODyGupe.js","sources":["../../../resources/js/components/ReceiptItem.vue","../../../resources/js/screens/receipt.vue"],"sourcesContent":["<script>\nexport default {\n    props: [\"item\", \"disabled\"],\n\n    computed: {\n        id() {\n            return this.$vnode.key + 1;\n        },\n\n        model() {\n            return this.$deepModel(this.item);\n        },\n\n        vatSum() {\n            return String(this.extractVat(this.item.sum, this.item.vat.type));\n        },\n\n        agentType: {\n            get: function () {\n                return this.model[\"agent_info.type\"] ?? null;\n            },\n            set: function (val) {\n                this.model[\"agent_info.type\"] = val;\n            },\n        },\n\n        payingAgentPhones: {\n            get: function () {\n                return this.model[\"agent_info.paying_agent.phones\"]?.join(\"\\n\");\n            },\n            set: function (phones) {\n                phones = phones\n                    .split(\"\\n\")\n                    .map((phone) => phone.trim())\n                    .filter((phone) => phone != null && phone !== \"\");\n                this.model[\"agent_info.paying_agent.phones\"] = phones.length ? phones : null;\n            },\n        },\n\n        receivePaymentsOperatorPhones: {\n            get: function () {\n                return this.model[\"agent_info.receive_payments_operator.phones\"]?.join(\"\\n\");\n            },\n            set: function (phones) {\n                phones = phones\n                    .split(\"\\n\")\n                    .map((phone) => phone.trim())\n                    .filter((phone) => phone != null && phone !== \"\");\n                this.model[\"agent_info.receive_payments_operator.phones\"] = phones.length ? phones : null;\n            },\n        },\n\n        moneyTransferOperatorPhones: {\n            get: function () {\n                return this.model[\"agent_info.money_transfer_operator.phones\"]?.join(\"\\n\");\n            },\n            set: function (phones) {\n                phones = phones\n                    .split(\"\\n\")\n                    .map((phone) => phone.trim())\n                    .filter((phone) => phone != null && phone !== \"\");\n                this.model[\"agent_info.money_transfer_operator.phones\"] = phones.length ? phones : null;\n            },\n        },\n\n        supplierPhones: {\n            get: function () {\n                return this.model[\"supplier_info.phones\"]?.join(\"\\n\");\n            },\n            set: function (phones) {\n                phones = phones\n                    .split(\"\\n\")\n                    .map((phone) => phone.trim())\n                    .filter((phone) => phone != null && phone !== \"\");\n                this.model[\"supplier_info.phones\"] = phones.length ? phones : null;\n            },\n        },\n    },\n\n    watch: {\n        \"item.price\": function (price) {\n            this.item.sum = price * this.item.quantity;\n        },\n\n        \"item.quantity\": function (quantity) {\n            this.item.sum = this.item.price * quantity;\n        },\n\n        \"item.sum\": function (sum) {\n            this.item.vat.sum = this.extractVat(sum, this.item.vat.type);\n        },\n\n        \"item.vat.type\": function (vatType) {\n            this.item.vat.sum = this.extractVat(this.item.sum, vatType);\n        },\n\n        \"item.agent_info\": {\n            handler: function (agent_info) {\n                this.item.agent_info = agent_info?.type === null ? null : this.emptify(agent_info);\n            },\n            deep: true,\n        },\n\n        \"item.supplier_info\": {\n            handler: function (supplier_info) {\n                this.item.supplier_info = supplier_info?.type === null ? null : this.emptify(supplier_info);\n            },\n            deep: true,\n        },\n    },\n};\n</script>\n\n<template>\n    <b-container fluid>\n        <b-form-row class=\"my-1\">\n            <b-col align-self=\"end\" lg=\"4\" md=\"6\" sm=\"12\">\n                <b-form-group\n                    label=\"Наименование\"\n                    :label-for=\"'item' + id + 'Name'\"\n                    description=\"тег 1030\"\n                    class=\"required\"\n                >\n                    <b-form-input\n                        :id=\"'item' + id + 'Name'\"\n                        type=\"text\"\n                        size=\"sm\"\n                        required\n                        v-model=\"item.name\"\n                        :disabled=\"disabled\"\n                    ></b-form-input>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"1\" md=\"2\" sm=\"4\">\n                <b-form-group label=\"Цена\" :label-for=\"'item' + id + 'Price'\" description=\"тег 1079\" class=\"required\">\n                    <b-form-input\n                        :id=\"'item' + id + 'Price'\"\n                        type=\"number\"\n                        min=\"0\"\n                        max=\"42949672.95\"\n                        step=\".01\"\n                        size=\"sm\"\n                        placeholder=\"0\"\n                        required\n                        v-model.number=\"item.price\"\n                        :disabled=\"disabled\"\n                    ></b-form-input>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"1\" md=\"2\" sm=\"4\">\n                <b-form-group\n                    label=\"Кол-во\"\n                    :label-for=\"'item' + id + 'Quantity'\"\n                    description=\"тег 1023\"\n                    class=\"required\"\n                >\n                    <b-form-input\n                        :id=\"'item' + id + 'Quantity'\"\n                        type=\"number\"\n                        min=\".001\"\n                        max=\"99999.999\"\n                        step=\"any\"\n                        size=\"sm\"\n                        placeholder=\"1\"\n                        required\n                        v-model.number=\"item.quantity\"\n                        :disabled=\"disabled\"\n                    ></b-form-input>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"1\" md=\"2\" sm=\"4\">\n                <b-form-group label=\"Сумма\" :label-for=\"'item' + id + 'Sum'\" description=\"тег 1043\" class=\"required\">\n                    <b-form-input\n                        :id=\"'item' + id + 'Sum'\"\n                        type=\"number\"\n                        min=\"0\"\n                        max=\"42949672.95\"\n                        step=\".01\"\n                        size=\"sm\"\n                        placeholder=\"0\"\n                        required\n                        v-model.number=\"item.sum\"\n                        :disabled=\"disabled\"\n                    ></b-form-input>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"1\" md=\"2\" sm=\"4\">\n                <b-form-group label=\"Ед. изм.\" :label-for=\"'item' + id + 'MeasurementUnit'\" description=\"тег 1197\">\n                    <b-form-input\n                        :id=\"'item' + id + 'MeasurementUnit'\"\n                        type=\"text\"\n                        size=\"sm\"\n                        placeholder=\"шт.\"\n                        maxlength=\"16\"\n                        v-model=\"item.measurement_unit\"\n                        :disabled=\"disabled\"\n                    ></b-form-input>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"2\" md=\"2\" sm=\"4\">\n                <b-form-group\n                    label=\"Способ расчета\"\n                    :label-for=\"'item' + id + 'PaymentMethod'\"\n                    description=\"тег 1214\"\n                    class=\"required\"\n                >\n                    <b-form-select\n                        :id=\"'item' + id + 'PaymentMethod'\"\n                        size=\"sm\"\n                        v-model=\"item.payment_method\"\n                        :options=\"buildOptions(dictionary.paymentMethods)\"\n                        :disabled=\"disabled\"\n                    ></b-form-select>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"2\" md=\"2\" sm=\"4\">\n                <b-form-group\n                    label=\"Предмет расчета\"\n                    :label-for=\"'item' + id + 'PaymentObject'\"\n                    description=\"тег 1212\"\n                    class=\"required\"\n                >\n                    <b-form-select\n                        :id=\"'item' + id + 'PaymentObject'\"\n                        size=\"sm\"\n                        v-model=\"item.payment_object\"\n                        :options=\"buildOptions(dictionary.paymentObjects)\"\n                        :disabled=\"disabled\"\n                    ></b-form-select>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"1\" md=\"2\" sm=\"4\">\n                <b-form-group label=\"НДС\" :label-for=\"'item' + id + 'VatType'\" description=\"тег 1199\" class=\"required\">\n                    <b-form-select\n                        :id=\"'item' + id + 'VatType'\"\n                        size=\"sm\"\n                        v-model=\"item.vat.type\"\n                        :options=\"buildOptions(dictionary.vatTypes)\"\n                        :disabled=\"disabled\"\n                    ></b-form-select>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"1\" md=\"2\" sm=\"4\">\n                <b-form-group label=\"Сумма НДС\" :label-for=\"'item' + id + 'VatSum'\" description=\"тег 1200\">\n                    <b-form-input\n                        :id=\"'item' + id + 'VatSum'\"\n                        type=\"number\"\n                        min=\"0\"\n                        max=\"42949672.95\"\n                        step=\".01\"\n                        size=\"sm\"\n                        :placeholder=\"vatSum\"\n                        v-model.number=\"item.vat.sum\"\n                        :disabled=\"disabled\"\n                    ></b-form-input>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                <b-form-group label=\"Признак агента\" :label-for=\"'item' + id + 'agentType'\" description=\"тег 1222\">\n                    <b-form-select\n                        :id=\"'item' + id + 'agentType'\"\n                        size=\"sm\"\n                        v-model=\"agentType\"\n                        :options=\"agentTypeOptions\"\n                        :disabled=\"disabled\"\n                    ></b-form-select>\n                </b-form-group>\n            </b-col>\n            <b-col align-self=\"end\" lg=\"1\" md=\"1\" sm=\"1\" class=\"ml-auto mr-0\">\n                <b-form-group class=\"text-right\">\n                    <b-button variant=\"danger\" size=\"sm\" title=\"Удалить\" @click=\"$emit('remove')\" :disabled=\"disabled\"\n                        ><b>&times;</b></b-button\n                    >\n                </b-form-group>\n            </b-col>\n        </b-form-row>\n        <div class=\"accordion\" role=\"tablist\" v-if=\"agentType !== null\">\n            <b-card no-body class=\"mb-1\">\n                <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                    <b-button block v-b-toggle=\"'receipt-item-' + id + '-paying-agent'\"\n                        >Атрибуты платежного агента</b-button\n                    >\n                </b-card-header>\n                <b-collapse\n                    :id=\"'receipt-item-' + id + '-paying-agent'\"\n                    :accordion=\"'receipt-item-' + id + '-agent-supplier-accordion'\"\n                    role=\"tabpanel\"\n                >\n                    <b-card-body>\n                        <b-container fluid>\n                            <b-form-row class=\"my-1\">\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"Наименование операции\"\n                                        :label-for=\"'item' + id + 'payingAgentOperation'\"\n                                        description=\"тег 1044\"\n                                    >\n                                        <b-form-input\n                                            :id=\"'item' + id + 'payingAgentOperation'\"\n                                            type=\"text\"\n                                            size=\"sm\"\n                                            v-model=\"model['agent_info.paying_agent.operation']\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-input>\n                                    </b-form-group>\n                                </b-col>\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"Телефон(ы)\"\n                                        :label-for=\"'item' + id + 'payingAgentPhones'\"\n                                        description=\"тег 1073\"\n                                    >\n                                        <b-form-textarea\n                                            :id=\"'item' + id + 'payingAgentPhones'\"\n                                            size=\"sm\"\n                                            max-rows=\"4\"\n                                            v-model=\"payingAgentPhones\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-textarea>\n                                    </b-form-group>\n                                </b-col>\n                            </b-form-row>\n                        </b-container>\n                    </b-card-body>\n                </b-collapse>\n            </b-card>\n\n            <b-card no-body class=\"mb-1\">\n                <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                    <b-button block v-b-toggle=\"'receipt-item-' + id + '-receive-payments-operator'\"\n                        >Атрибуты оператора по приему платежей</b-button\n                    >\n                </b-card-header>\n                <b-collapse\n                    :id=\"'receipt-item-' + id + '-receive-payments-operator'\"\n                    :accordion=\"'receipt-item-' + id + '-agent-supplier-accordion'\"\n                    role=\"tabpanel\"\n                >\n                    <b-card-body>\n                        <b-container fluid>\n                            <b-form-row class=\"my-1\">\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"Телефон(ы)\"\n                                        :label-for=\"'item' + id + 'receivePaymentsOperatorPhones'\"\n                                        description=\"тег 1074\"\n                                    >\n                                        <b-form-textarea\n                                            :id=\"'item' + id + 'receivePaymentsOperatorPhones'\"\n                                            size=\"sm\"\n                                            max-rows=\"4\"\n                                            v-model=\"receivePaymentsOperatorPhones\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-textarea>\n                                    </b-form-group>\n                                </b-col>\n                            </b-form-row>\n                        </b-container>\n                    </b-card-body>\n                </b-collapse>\n            </b-card>\n\n            <b-card no-body class=\"mb-1\">\n                <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                    <b-button block v-b-toggle=\"'receipt-item-' + id + '-money-transfer-operator'\"\n                        >Атрибуты оператора перевода</b-button\n                    >\n                </b-card-header>\n                <b-collapse\n                    :id=\"'receipt-item-' + id + '-money-transfer-operator'\"\n                    :accordion=\"'receipt-item-' + id + '-agent-supplier-accordion'\"\n                    role=\"tabpanel\"\n                >\n                    <b-card-body>\n                        <b-container fluid>\n                            <b-form-row class=\"my-1\">\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"Телефон(ы)\"\n                                        :label-for=\"'item' + id + 'moneyTransferOperatorPhones'\"\n                                        description=\"тег 1075\"\n                                    >\n                                        <b-form-textarea\n                                            :id=\"'item' + id + 'moneyTransferOperatorPhones'\"\n                                            size=\"sm\"\n                                            max-rows=\"4\"\n                                            v-model=\"moneyTransferOperatorPhones\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-textarea>\n                                    </b-form-group>\n                                </b-col>\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"Наименование\"\n                                        :label-for=\"'item' + id + 'moneyTransferOperatorName'\"\n                                        description=\"тег 1026\"\n                                    >\n                                        <b-form-input\n                                            :id=\"'item' + id + 'moneyTransferOperatorName'\"\n                                            type=\"text\"\n                                            size=\"sm\"\n                                            v-model=\"model['agent_info.money_transfer_operator.name']\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-input>\n                                    </b-form-group>\n                                </b-col>\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"Адрес\"\n                                        :label-for=\"'item' + id + 'moneyTransferOperatorAddress'\"\n                                        description=\"тег 1005\"\n                                    >\n                                        <b-form-input\n                                            :id=\"'item' + id + 'moneyTransferOperatorAddress'\"\n                                            type=\"text\"\n                                            size=\"sm\"\n                                            v-model=\"model['agent_info.money_transfer_operator.address']\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-input>\n                                    </b-form-group>\n                                </b-col>\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"ИНН\"\n                                        :label-for=\"'item' + id + 'moneyTransferOperatorInn'\"\n                                        description=\"тег 1016\"\n                                    >\n                                        <b-form-input\n                                            :id=\"'item' + id + 'moneyTransferOperatorInn'\"\n                                            type=\"text\"\n                                            size=\"sm\"\n                                            pattern=\"\\d{10}|\\d{12}\"\n                                            maxlength=\"12\"\n                                            v-model=\"model['agent_info.money_transfer_operator.inn']\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-input>\n                                    </b-form-group>\n                                </b-col>\n                            </b-form-row>\n                        </b-container>\n                    </b-card-body>\n                </b-collapse>\n            </b-card>\n\n            <b-card no-body class=\"mb-1\">\n                <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                    <b-button block v-b-toggle=\"'receipt-item-' + id + '-supplier'\">Атрибуты поставщика</b-button>\n                </b-card-header>\n                <b-collapse\n                    :id=\"'receipt-item-' + id + '-supplier'\"\n                    :accordion=\"'receipt-item-' + id + '-agent-supplier-accordion'\"\n                    role=\"tabpanel\"\n                >\n                    <b-card-body>\n                        <b-container fluid>\n                            <b-form-row class=\"my-1\">\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"Телефон(ы)\"\n                                        :label-for=\"'item' + id + 'supplierPhones'\"\n                                        description=\"тег 1171\"\n                                        class=\"required\"\n                                    >\n                                        <b-form-textarea\n                                            :id=\"'item' + id + 'supplierPhones'\"\n                                            size=\"sm\"\n                                            max-rows=\"4\"\n                                            required\n                                            v-model=\"supplierPhones\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-textarea>\n                                    </b-form-group>\n                                </b-col>\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"Наименование\"\n                                        :label-for=\"'item' + id + 'supplierName'\"\n                                        description=\"тег 1225\"\n                                    >\n                                        <b-form-input\n                                            :id=\"'item' + id + 'supplierName'\"\n                                            type=\"text\"\n                                            size=\"sm\"\n                                            v-model=\"model['supplier_info.name']\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-input>\n                                    </b-form-group>\n                                </b-col>\n                                <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                    <b-form-group\n                                        label=\"ИНН\"\n                                        :label-for=\"'item' + id + 'supplierInn'\"\n                                        description=\"тег 1226\"\n                                    >\n                                        <b-form-input\n                                            :id=\"'item' + id + 'supplierInn'\"\n                                            type=\"text\"\n                                            size=\"sm\"\n                                            pattern=\"\\d{10}|\\d{12}\"\n                                            maxlength=\"12\"\n                                            v-model=\"model['supplier_info.inn']\"\n                                            :disabled=\"disabled\"\n                                        ></b-form-input>\n                                    </b-form-group>\n                                </b-col>\n                            </b-form-row>\n                        </b-container>\n                    </b-card-body>\n                </b-collapse>\n            </b-card>\n        </div>\n    </b-container>\n</template>\n","<script>\nimport Receipt from \"../models/Receipt\";\nimport ReceiptItem from \"../components/ReceiptItem.vue\";\n\nexport default {\n    components: {\n        ReceiptItem,\n    },\n\n    data() {\n        return {\n            ready: false,\n            showPreview: false,\n            receipt: new Receipt(),\n            vats: {\n                without_vat: null,\n                with_vat0: null,\n                vat10: null,\n                vat20: null,\n                vat110: null,\n                vat120: null,\n            },\n            agentInfo: {\n                type: null,\n                paying_agent: {\n                    operation: null,\n                    phones: null,\n                },\n                receive_payments_operator: {\n                    phones: null,\n                },\n                money_transfer_operator: {\n                    phones: null,\n                    name: null,\n                    address: null,\n                    inn: null,\n                },\n            },\n        };\n    },\n\n    mounted() {\n        this.handleRoute(this.$route);\n        this.enumConnections();\n        this.listenEvents();\n    },\n\n    methods: {\n        async handleRoute(to, from = null) {\n            switch (to.name) {\n                case \"receipt\":\n                    await this.loadReceipt(to.params.id);\n                    break;\n                case \"new-receipt\":\n                    this.resetReceipt();\n                    break;\n                case \"new-receipt-from-existing\":\n                    from !== null && from.name === \"receipt\" && +to.params.id === +from.params.id\n                        ? this.shrinkReceipt()\n                        : await this.loadReceipt(to.params.id, true);\n            }\n        },\n\n        listenEvents() {\n            this.$echo.listen(\".receipt.processed\", (receipt) => {\n                if (receipt.id === this.receipt.id) {\n                    this.receipt = receipt;\n                }\n            });\n        },\n\n        resetReceipt() {\n            this.receipt = new Receipt({\n                id: null,\n                state: 0,\n                connection: null,\n                operation: null,\n                external_id: null,\n                internal_id: null,\n                payload: {\n                    client: {\n                        email: null,\n                        phone: null,\n                        name: null,\n                        inn: null,\n                    },\n                    company: {\n                        name: null,\n                        email: null,\n                        inn: null,\n                        payment_address: null,\n                        payment_site: null,\n                        tax_system: null,\n                    },\n                    agent_info: null,\n                    supplier_info: null,\n                    items: [],\n                    payments: {\n                        cash: 0,\n                        electronic: 0,\n                        prepaid: 0,\n                        postpaid: 0,\n                        other: 0,\n                    },\n                    vats: null,\n                    total: 0,\n                    additional_check_props: null,\n                    cashier: null,\n                    additional_user_props: null,\n                },\n                result: null,\n            });\n            this.ready = true;\n        },\n\n        shrinkReceipt() {\n            this.receipt.id = null;\n            this.receipt.state = 0;\n            this.receipt.external_id = null;\n            this.receipt.internal_id = null;\n            this.receipt.result = null;\n        },\n\n        async loadReceipt(id, asTemplate = false) {\n            this.ready = false;\n            this.receipt = await Receipt.find(id);\n            asTemplate && this.shrinkReceipt();\n            this.ready = true;\n        },\n\n        async saveReceipt() {\n            try {\n                const isNew = !this.receipt.id;\n                this.receipt = await this.receipt.save();\n                isNew && this.$router.replace({ name: \"receipt\", params: { id: this.receipt.id } });\n            } catch (error) {\n                Object.values(error.response.data.errors).forEach((msgBag) =>\n                    this.$bvToast.toast(\n                        msgBag.map((msg) => this.$createElement(\"div\", msg)),\n                        {\n                            toaster: \"b-toaster-bottom-right\",\n                            variant: \"danger\",\n                            solid: true,\n                            noCloseButton: true,\n                        },\n                    ),\n                );\n            }\n        },\n\n        async registerReceipt() {\n            await this.saveReceipt();\n            this.receipt = await this.receipt.register();\n        },\n\n        async syncReceipt() {\n            await this.receipt.sync();\n        },\n\n        async deleteReceipt() {\n            if (confirm(\"Удалить чек?\")) {\n                await this.receipt.delete();\n                this.$router.replace({ name: \"receipts\" });\n            }\n        },\n\n        addItem() {\n            this.receipt.payload.items.push({\n                agent_info: null,\n                country_code: null,\n                declaration_number: null,\n                excise: null,\n                measurement_unit: null,\n                name: \"\",\n                nomenclature_code: null,\n                payment_method: \"full_prepayment\",\n                payment_object: \"commodity\",\n                price: null,\n                quantity: 1,\n                sum: null,\n                supplier_info: null,\n                user_data: null,\n                vat: {\n                    sum: null,\n                    type: \"vat20\",\n                },\n            });\n        },\n\n        removeItem(id) {\n            this.receipt.payload.items.splice(id, 1);\n        },\n\n        getVats(calc = false) {\n            const vats = {\n                without_vat: 0,\n                with_vat0: 0,\n                vat10: 0,\n                vat20: 0,\n                vat110: 0,\n                vat120: 0,\n            };\n\n            if (calc) {\n                for (const item of this.receipt.payload.items) {\n                    switch (item?.vat.type ?? \"none\") {\n                        case \"vat20\":\n                        case \"vat18\":\n                            vats.vat20 += this.extractVat(item.sum, item.vat.type);\n                            break;\n                        case \"vat10\":\n                            vats.vat10 += this.extractVat(item.sum, item.vat.type);\n                            break;\n                        case \"vat0\":\n                            vats.with_vat0 += item.sum;\n                            break;\n                        case \"none\":\n                            vats.without_vat += item.sum;\n                            break;\n                        case \"vat120\":\n                        case \"vat118\":\n                            vats.vat120 += this.extractVat(item.sum, item.vat.type);\n                            break;\n                        case \"vat110\":\n                            vats.vat110 += this.extractVat(item.sum, item.vat.type);\n                    }\n                }\n            }\n\n            return vats;\n        },\n\n        fitContent(event) {\n            event.target.style.height = event.target.contentDocument.body.scrollHeight + 20 + \"px\";\n        },\n\n        printReceipt() {\n            let printWindow = window.open(\n                window.FiscalRegistrar.basePath + \"/api/v1/receipts/\" + this.receipt.id + \"/preview\",\n                \"ReceiptPreview\",\n                \"popup,width=500,height=1000\",\n            );\n            printWindow.onafterprint = printWindow.close;\n            printWindow.onload = function () {\n                printWindow.setTimeout(printWindow.print);\n            };\n        },\n    },\n\n    computed: {\n        title() {\n            const action = !this.receipt.id ? \"Создание\" : this.receipt.state === 0 ? \"Редактирование\" : \"Просмотр\";\n            return action + \" кассового чека\";\n        },\n\n        model() {\n            return this.$deepModel(this.receipt.payload);\n        },\n\n        selectConnections() {\n            return [\n                { value: null, text: \"автоопределение\" },\n                ...this.buildOptions(this.connections, ([name, data]) => ({ value: name, text: data.display_name })),\n            ];\n        },\n\n        isClientEmailRequired() {\n            return !this.receipt.payload.client.phone;\n        },\n\n        isClientPhoneRequired() {\n            return !this.receipt.payload.client.email;\n        },\n\n        companyEmailPlaceholder() {\n            return this.connections[this.receipt.connection]?.company?.email ?? \"contact@myshop.com\";\n        },\n\n        companyNamePlaceholder() {\n            return this.connections[this.receipt.connection]?.company?.name ?? 'ООО \"Рога и Копыта\"';\n        },\n\n        companyInnPlaceholder() {\n            return this.connections[this.receipt.connection]?.company?.inn ?? \"1234567890\";\n        },\n\n        companyPaymentSitePlaceholder() {\n            return this.connections[this.receipt.connection]?.company?.payment_site ?? \"https://www.myshop.com\";\n        },\n\n        companyPaymentAddressPlaceholder() {\n            return this.connections[this.receipt.connection]?.company?.payment_address ?? \"\";\n        },\n\n        vatsPlaceholder() {\n            return Object.fromEntries(\n                Object.entries(this.getVats(!this.receipt.payload.vats)).map(([key, val]) => [key, String(val)]),\n            );\n        },\n\n        vatsWithoutVat: {\n            get: function () {\n                return this.receipt.payload.vats?.without_vat ?? null;\n            },\n            set: function (val) {\n                this.receipt.payload.vats ??= this.vats;\n                this.receipt.payload.vats.without_vat = val || null;\n            },\n        },\n\n        vatsWithVat0: {\n            get: function () {\n                return this.receipt.payload.vats?.with_vat0 ?? null;\n            },\n            set: function (val) {\n                this.receipt.payload.vats ??= this.vats;\n                this.receipt.payload.vats.with_vat0 = val || null;\n            },\n        },\n\n        vatsVat10: {\n            get: function () {\n                return this.receipt.payload.vats?.vat10 ?? null;\n            },\n            set: function (val) {\n                this.receipt.payload.vats ??= this.vats;\n                this.receipt.payload.vats.vat10 = val || null;\n            },\n        },\n\n        vatsVat20: {\n            get: function () {\n                return this.receipt.payload.vats?.vat20 ?? null;\n            },\n            set: function (val) {\n                this.receipt.payload.vats ??= this.vats;\n                this.receipt.payload.vats.vat20 = val || null;\n            },\n        },\n\n        vatsVat110: {\n            get: function () {\n                return this.receipt.payload.vats?.vat110 ?? null;\n            },\n            set: function (val) {\n                this.receipt.payload.vats ??= this.vats;\n                this.receipt.payload.vats.vat110 = val || null;\n            },\n        },\n\n        vatsVat120: {\n            get: function () {\n                return this.receipt.payload.vats?.vat120 ?? null;\n            },\n            set: function (val) {\n                this.receipt.payload.vats ??= this.vats;\n                this.receipt.payload.vats.vat120 = val || null;\n            },\n        },\n\n        agentType: {\n            get: function () {\n                return this.receipt.payload.agent_info?.type ?? null;\n            },\n            set: function (val) {\n                this.receipt.payload.agent_info ??= this.agentInfo;\n                this.receipt.payload.agent_info.type = val || null;\n            },\n        },\n\n        payingAgentPhones: {\n            get: function () {\n                return this.model[\"agent_info.paying_agent.phones\"]?.join(\"\\n\");\n            },\n            set: function (phones) {\n                phones = phones\n                    .split(\"\\n\")\n                    .map((phone) => phone.trim())\n                    .filter((phone) => phone != null && phone !== \"\");\n                this.model[\"agent_info.paying_agent.phones\"] = phones.length ? phones : null;\n            },\n        },\n\n        receivePaymentsOperatorPhones: {\n            get: function () {\n                return this.model[\"agent_info.receive_payments_operator.phones\"]?.join(\"\\n\");\n            },\n            set: function (phones) {\n                phones = phones\n                    .split(\"\\n\")\n                    .map((phone) => phone.trim())\n                    .filter((phone) => phone != null && phone !== \"\");\n                this.model[\"agent_info.receive_payments_operator.phones\"] = phones.length ? phones : null;\n            },\n        },\n\n        moneyTransferOperatorPhones: {\n            get: function () {\n                return this.model[\"agent_info.money_transfer_operator.phones\"]?.join(\"\\n\");\n            },\n            set: function (phones) {\n                phones = phones\n                    .split(\"\\n\")\n                    .map((phone) => phone.trim())\n                    .filter((phone) => phone != null && phone !== \"\");\n                this.model[\"agent_info.money_transfer_operator.phones\"] = phones.length ? phones : null;\n            },\n        },\n\n        supplierPhones: {\n            get: function () {\n                return this.model[\"supplier_info.phones\"]?.join(\"\\n\");\n            },\n            set: function (phones) {\n                phones = phones\n                    .split(\"\\n\")\n                    .map((phone) => phone.trim())\n                    .filter((phone) => phone != null && phone !== \"\");\n                this.model[\"supplier_info.phones\"] = phones.length ? phones : null;\n            },\n        },\n\n        resultPayloadFnsSite() {\n            return /^https?:\\/\\//i.test(this.receipt.result.payload.fns_site)\n                ? this.receipt.result.payload.fns_site\n                : \"https://\" + this.receipt.result.payload.fns_site;\n        },\n    },\n\n    watch: {\n        $route(to, from) {\n            this.handleRoute(to, from);\n        },\n\n        \"receipt.payload.items\": {\n            handler: function (items) {\n                this.receipt.payload.total = items.reduce((total, item) => total + item.sum, 0);\n            },\n            deep: true,\n        },\n\n        \"receipt.payload.vats\": {\n            handler: function (vats) {\n                if (vats === null) return;\n                Object.values(vats).every((vat) => vat === null) && (this.receipt.payload.vats = null);\n            },\n            deep: true,\n        },\n\n        \"receipt.payload.agent_info\": {\n            handler: function (agent_info) {\n                this.receipt.payload.agent_info = agent_info?.type === null ? null : this.emptify(agent_info);\n            },\n            deep: true,\n        },\n    },\n};\n</script>\n\n<style scoped>\nfieldset {\n    margin: 0;\n}\n</style>\n\n<template>\n    <div>\n        <h2 class=\"text-center\" v-if=\"ready\">{{ title }}</h2>\n        <b-form validated v-if=\"ready\" @submit.prevent=\"saveReceipt\">\n            <div class=\"accordion\" role=\"tablist\">\n                <b-card no-body class=\"mb-1\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-attributes variant=\"info\">Атрибуты документа</b-button>\n                    </b-card-header>\n                    <b-collapse id=\"receipt-attributes\" visible accordion=\"receipt-accordion\" role=\"tabpanel\">\n                        <b-card-body>\n                            <b-card-text> TODO </b-card-text>\n                            <b-form-group :disabled=\"receipt.state !== 0\">\n                                <b-container fluid>\n                                    <b-form-row class=\"my-1\">\n                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                            <b-form-group\n                                                label=\"Подключение\"\n                                                label-for=\"receiptConnection\"\n                                                class=\"required\"\n                                            >\n                                                <b-form-select\n                                                    id=\"receiptConnection\"\n                                                    size=\"sm\"\n                                                    v-model=\"receipt.connection\"\n                                                    :options=\"selectConnections\"\n                                                ></b-form-select>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                            <b-form-group\n                                                label=\"Операция\"\n                                                label-for=\"receiptOperation\"\n                                                class=\"required\"\n                                            >\n                                                <b-form-select\n                                                    id=\"receiptOperation\"\n                                                    size=\"sm\"\n                                                    required\n                                                    v-model=\"receipt.operation\"\n                                                    :options=\"buildOptions(dictionary.operations)\"\n                                                ></b-form-select>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                            <b-form-group\n                                                label=\"Уникальный идентификатор\"\n                                                label-for=\"receiptExternalId\"\n                                            >\n                                                <b-form-input\n                                                    id=\"receiptExternalId\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    v-model=\"receipt.external_id\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                    </b-form-row>\n                                </b-container>\n                            </b-form-group>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n\n                <b-card no-body class=\"mb-1\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-client variant=\"info\">Данные клиента</b-button>\n                    </b-card-header>\n                    <b-collapse id=\"receipt-client\" accordion=\"receipt-accordion\" role=\"tabpanel\">\n                        <b-card-body>\n                            <b-card-text>\n                                В запросе обязательно должно быть заполнено хотя бы одно из полей:\n                                <code>email</code> или <code>phone</code>.<br />\n                                Если заполнены оба поля, ОФД отправит электронный чек только на email.\n                            </b-card-text>\n                            <b-form-group :disabled=\"receipt.state !== 0\">\n                                <b-container fluid>\n                                    <b-form-row class=\"my-1\">\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Электронный адрес\"\n                                                label-for=\"clientEmail\"\n                                                description=\"тег 1008\"\n                                                :class=\"isClientEmailRequired && 'required'\"\n                                            >\n                                                <b-form-input\n                                                    id=\"clientEmail\"\n                                                    type=\"email\"\n                                                    size=\"sm\"\n                                                    placeholder=\"user@domain.com\"\n                                                    :required=\"isClientEmailRequired\"\n                                                    v-model=\"receipt.payload.client.email\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Телефон\"\n                                                label-for=\"clientPhone\"\n                                                description=\"тег 1008\"\n                                                :class=\"isClientPhoneRequired && 'required'\"\n                                            >\n                                                <b-form-input\n                                                    id=\"clientPhone\"\n                                                    type=\"tel\"\n                                                    size=\"sm\"\n                                                    placeholder=\"+79001234567\"\n                                                    :required=\"isClientPhoneRequired\"\n                                                    v-model=\"receipt.payload.client.phone\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Наименование\"\n                                                label-for=\"clientName\"\n                                                description=\"тег 1227\"\n                                            >\n                                                <b-form-input\n                                                    id=\"clientName\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    placeholder=\"Иван Иванович Иванов\"\n                                                    v-model=\"receipt.payload.client.name\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group label=\"ИНН\" label-for=\"clientInn\" description=\"тег 1228\">\n                                                <b-form-input\n                                                    id=\"clientInn\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    placeholder=\"1234567890\"\n                                                    pattern=\"\\d{10}|\\d{12}\"\n                                                    maxlength=\"12\"\n                                                    v-model=\"receipt.payload.client.inn\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                    </b-form-row>\n                                </b-container>\n                            </b-form-group>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n\n                <b-card no-body class=\"mb-1\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-company variant=\"info\">Данные организации</b-button>\n                    </b-card-header>\n                    <b-collapse id=\"receipt-company\" accordion=\"receipt-accordion\" role=\"tabpanel\">\n                        <b-card-body>\n                            <b-card-text>\n                                Оставьте поля пустыми для автоматической подстановки параметров из конфигурации\n                                подключения при проводке чека.\n                            </b-card-text>\n                            <b-form-group :disabled=\"receipt.state !== 0\">\n                                <b-container fluid>\n                                    <b-form-row class=\"my-1\">\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Электронный адрес\"\n                                                label-for=\"companyEmail\"\n                                                description=\"тег 1117\"\n                                            >\n                                                <b-form-input\n                                                    id=\"companyEmail\"\n                                                    type=\"email\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"companyEmailPlaceholder\"\n                                                    v-model=\"receipt.payload.company.email\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Наименование\"\n                                                label-for=\"companyName\"\n                                                description=\"тег 1048\"\n                                            >\n                                                <b-form-input\n                                                    id=\"companyName\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"companyNamePlaceholder\"\n                                                    v-model=\"receipt.payload.company.name\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group label=\"ИНН\" label-for=\"companyInn\" description=\"тег 1018\">\n                                                <b-form-input\n                                                    id=\"companyInn\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"companyInnPlaceholder\"\n                                                    pattern=\"\\d{10}|\\d{12}\"\n                                                    maxlength=\"12\"\n                                                    v-model=\"receipt.payload.company.inn\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Система налогообложения\"\n                                                label-for=\"taxSystem\"\n                                                description=\"тег 1055\"\n                                            >\n                                                <b-form-select\n                                                    id=\"taxSystem\"\n                                                    size=\"sm\"\n                                                    v-model=\"receipt.payload.company.tax_system\"\n                                                    :options=\"taxSystemOptions\"\n                                                ></b-form-select>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Место расчетов\"\n                                                label-for=\"companyPaymentSite\"\n                                                description=\"тег 1187\"\n                                            >\n                                                <b-form-input\n                                                    id=\"companyPaymentSite\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"companyPaymentSitePlaceholder\"\n                                                    v-model=\"receipt.payload.company.payment_site\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Адрес расчетов\"\n                                                label-for=\"companyPaymentAddress\"\n                                                description=\"тег 1009\"\n                                            >\n                                                <b-form-input\n                                                    id=\"companyPaymentAddress\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"companyPaymentAddressPlaceholder\"\n                                                    v-model=\"receipt.payload.company.payment_address\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                    </b-form-row>\n                                </b-container>\n                            </b-form-group>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n\n                <b-card no-body class=\"mb-1\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-agent-supplier variant=\"info\"\n                            >Данные агента и поставщика</b-button\n                        >\n                    </b-card-header>\n                    <b-collapse id=\"receipt-agent-supplier\" accordion=\"receipt-accordion\" role=\"tabpanel\">\n                        <b-card-body>\n                            <b-card-text> TODO </b-card-text>\n                            <b-form-group :disabled=\"receipt.state !== 0\">\n                                <b-container fluid>\n                                    <b-form-row class=\"my-1\">\n                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                            <b-form-group\n                                                label=\"Признак агента\"\n                                                label-for=\"agentType\"\n                                                description=\"тег 1057\"\n                                            >\n                                                <b-form-select\n                                                    id=\"agentType\"\n                                                    size=\"sm\"\n                                                    v-model=\"agentType\"\n                                                    :options=\"agentTypeOptions\"\n                                                ></b-form-select>\n                                            </b-form-group>\n                                        </b-col>\n                                    </b-form-row>\n                                </b-container>\n\n                                <div class=\"accordion\" role=\"tablist\" v-if=\"agentType !== null\">\n                                    <b-card no-body class=\"mb-1\">\n                                        <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                                            <b-button block v-b-toggle.receipt-paying-agent\n                                                >Атрибуты платежного агента</b-button\n                                            >\n                                        </b-card-header>\n                                        <b-collapse\n                                            id=\"receipt-paying-agent\"\n                                            accordion=\"receipt-agent-supplier-accordion\"\n                                            role=\"tabpanel\"\n                                        >\n                                            <b-card-body>\n                                                <b-container fluid>\n                                                    <b-form-row class=\"my-1\">\n                                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                                            <b-form-group\n                                                                label=\"Наименование операции\"\n                                                                label-for=\"payingAgentOperation\"\n                                                                description=\"тег 1044\"\n                                                            >\n                                                                <b-form-input\n                                                                    id=\"payingAgentOperation\"\n                                                                    type=\"text\"\n                                                                    size=\"sm\"\n                                                                    v-model=\"model['agent_info.paying_agent.operation']\"\n                                                                ></b-form-input>\n                                                            </b-form-group>\n                                                        </b-col>\n                                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                                            <b-form-group\n                                                                label=\"Телефон(ы)\"\n                                                                label-for=\"payingAgentPhones\"\n                                                                description=\"тег 1073\"\n                                                            >\n                                                                <b-form-textarea\n                                                                    id=\"payingAgentPhones\"\n                                                                    size=\"sm\"\n                                                                    max-rows=\"4\"\n                                                                    v-model=\"payingAgentPhones\"\n                                                                ></b-form-textarea>\n                                                            </b-form-group>\n                                                        </b-col>\n                                                    </b-form-row>\n                                                </b-container>\n                                            </b-card-body>\n                                        </b-collapse>\n                                    </b-card>\n\n                                    <b-card no-body class=\"mb-1\">\n                                        <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                                            <b-button block v-b-toggle.receipt-receive-payments-operator\n                                                >Атрибуты оператора по приему платежей</b-button\n                                            >\n                                        </b-card-header>\n                                        <b-collapse\n                                            id=\"receipt-receive-payments-operator\"\n                                            accordion=\"receipt-agent-supplier-accordion\"\n                                            role=\"tabpanel\"\n                                        >\n                                            <b-card-body>\n                                                <b-container fluid>\n                                                    <b-form-row class=\"my-1\">\n                                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                                            <b-form-group\n                                                                label=\"Телефон(ы)\"\n                                                                label-for=\"receivePaymentsOperatorPhones\"\n                                                                description=\"тег 1074\"\n                                                            >\n                                                                <b-form-textarea\n                                                                    id=\"receivePaymentsOperatorPhones\"\n                                                                    size=\"sm\"\n                                                                    max-rows=\"4\"\n                                                                    v-model=\"receivePaymentsOperatorPhones\"\n                                                                ></b-form-textarea>\n                                                            </b-form-group>\n                                                        </b-col>\n                                                    </b-form-row>\n                                                </b-container>\n                                            </b-card-body>\n                                        </b-collapse>\n                                    </b-card>\n\n                                    <b-card no-body class=\"mb-1\">\n                                        <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                                            <b-button block v-b-toggle.receipt-money-transfer-operator\n                                                >Атрибуты оператора перевода</b-button\n                                            >\n                                        </b-card-header>\n                                        <b-collapse\n                                            id=\"receipt-money-transfer-operator\"\n                                            accordion=\"receipt-agent-supplier-accordion\"\n                                            role=\"tabpanel\"\n                                        >\n                                            <b-card-body>\n                                                <b-container fluid>\n                                                    <b-form-row class=\"my-1\">\n                                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                                            <b-form-group\n                                                                label=\"Телефон(ы)\"\n                                                                label-for=\"moneyTransferOperatorPhones\"\n                                                                description=\"тег 1075\"\n                                                            >\n                                                                <b-form-textarea\n                                                                    id=\"moneyTransferOperatorPhones\"\n                                                                    size=\"sm\"\n                                                                    max-rows=\"4\"\n                                                                    v-model=\"moneyTransferOperatorPhones\"\n                                                                ></b-form-textarea>\n                                                            </b-form-group>\n                                                        </b-col>\n                                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                                            <b-form-group\n                                                                label=\"Наименование\"\n                                                                label-for=\"moneyTransferOperatorName\"\n                                                                description=\"тег 1026\"\n                                                            >\n                                                                <b-form-input\n                                                                    id=\"moneyTransferOperatorName\"\n                                                                    type=\"text\"\n                                                                    size=\"sm\"\n                                                                    v-model=\"\n                                                                        model['agent_info.money_transfer_operator.name']\n                                                                    \"\n                                                                ></b-form-input>\n                                                            </b-form-group>\n                                                        </b-col>\n                                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                                            <b-form-group\n                                                                label=\"Адрес\"\n                                                                label-for=\"moneyTransferOperatorAddress\"\n                                                                description=\"тег 1005\"\n                                                            >\n                                                                <b-form-input\n                                                                    id=\"moneyTransferOperatorAddress\"\n                                                                    type=\"text\"\n                                                                    size=\"sm\"\n                                                                    v-model=\"\n                                                                        model[\n                                                                            'agent_info.money_transfer_operator.address'\n                                                                        ]\n                                                                    \"\n                                                                ></b-form-input>\n                                                            </b-form-group>\n                                                        </b-col>\n                                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                                            <b-form-group\n                                                                label=\"ИНН\"\n                                                                label-for=\"moneyTransferOperatorInn\"\n                                                                description=\"тег 1016\"\n                                                            >\n                                                                <b-form-input\n                                                                    id=\"moneyTransferOperatorInn\"\n                                                                    type=\"text\"\n                                                                    size=\"sm\"\n                                                                    pattern=\"\\d{10}|\\d{12}\"\n                                                                    maxlength=\"12\"\n                                                                    v-model=\"\n                                                                        model['agent_info.money_transfer_operator.inn']\n                                                                    \"\n                                                                ></b-form-input>\n                                                            </b-form-group>\n                                                        </b-col>\n                                                    </b-form-row>\n                                                </b-container>\n                                            </b-card-body>\n                                        </b-collapse>\n                                    </b-card>\n\n                                    <b-card no-body class=\"mb-1\">\n                                        <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                                            <b-button block v-b-toggle.receipt-supplier>Атрибуты поставщика</b-button>\n                                        </b-card-header>\n                                        <b-collapse\n                                            id=\"receipt-supplier\"\n                                            accordion=\"receipt-agent-supplier-accordion\"\n                                            role=\"tabpanel\"\n                                        >\n                                            <b-card-body>\n                                                <b-container fluid>\n                                                    <b-form-row class=\"my-1\">\n                                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                                            <b-form-group\n                                                                label=\"Телефон(ы)\"\n                                                                label-for=\"supplierPhones\"\n                                                                description=\"тег 1171\"\n                                                                class=\"required\"\n                                                            >\n                                                                <b-form-textarea\n                                                                    id=\"supplierPhones\"\n                                                                    size=\"sm\"\n                                                                    max-rows=\"4\"\n                                                                    required\n                                                                    v-model=\"supplierPhones\"\n                                                                ></b-form-textarea>\n                                                            </b-form-group>\n                                                        </b-col>\n                                                    </b-form-row>\n                                                </b-container>\n                                            </b-card-body>\n                                        </b-collapse>\n                                    </b-card>\n                                </div>\n                            </b-form-group>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n\n                <b-card no-body class=\"mb-1\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-items variant=\"info\">Позиции документа</b-button>\n                    </b-card-header>\n                    <b-collapse id=\"receipt-items\" accordion=\"receipt-accordion\" role=\"tabpanel\">\n                        <b-card-body>\n                            <b-card-text> В документе должна быть как минимум одна позиция. </b-card-text>\n                            <template v-for=\"(item, id) in receipt.payload.items\">\n                                <receipt-item\n                                    :key=\"id\"\n                                    :item=\"item\"\n                                    :disabled=\"receipt.state !== 0\"\n                                    @remove=\"removeItem(id)\"\n                                ></receipt-item>\n                                <hr />\n                            </template>\n                            <b-container fluid>\n                                <b-form-row class=\"my-1\">\n                                    <b-col align-self=\"end\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group\n                                            label=\"Всего на сумму\"\n                                            label-for=\"total\"\n                                            description=\"тег 1020\"\n                                            class=\"required\"\n                                        >\n                                            <b-form-input\n                                                id=\"total\"\n                                                type=\"number\"\n                                                min=\"0\"\n                                                max=\"42949672.95\"\n                                                step=\".01\"\n                                                size=\"sm\"\n                                                placeholder=\"0\"\n                                                required\n                                                v-model.number=\"receipt.payload.total\"\n                                                :disabled=\"receipt.state !== 0\"\n                                            ></b-form-input>\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-sm-3\" align-self=\"end\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-button\n                                            class=\"mb-sm-4\"\n                                            variant=\"primary\"\n                                            size=\"sm\"\n                                            @click=\"addItem\"\n                                            :disabled=\"receipt.state !== 0\"\n                                            >Добавить</b-button\n                                        >\n                                    </b-col>\n                                </b-form-row>\n                            </b-container>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n\n                <b-card no-body class=\"mb-1\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-payments variant=\"info\">Данные по оплате</b-button>\n                    </b-card-header>\n                    <b-collapse id=\"receipt-payments\" accordion=\"receipt-accordion\" role=\"tabpanel\">\n                        <b-card-body>\n                            <b-card-text> TODO </b-card-text>\n                            <b-form-group :disabled=\"receipt.state !== 0\">\n                                <b-container fluid>\n                                    <b-form-row class=\"my-1\">\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Наличными\"\n                                                label-for=\"paymentCash\"\n                                                description=\"тег 1031\"\n                                            >\n                                                <b-form-input\n                                                    id=\"paymentCash\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    placeholder=\"0\"\n                                                    v-model.number=\"receipt.payload.payments.cash\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Безналичными\"\n                                                label-for=\"paymentElectronic\"\n                                                description=\"тег 1081\"\n                                            >\n                                                <b-form-input\n                                                    id=\"paymentElectronic\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    placeholder=\"0\"\n                                                    v-model.number=\"receipt.payload.payments.electronic\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Предоплатой\"\n                                                label-for=\"paymentPrepaid\"\n                                                description=\"тег 1215\"\n                                            >\n                                                <b-form-input\n                                                    id=\"paymentPrepaid\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    placeholder=\"0\"\n                                                    v-model.number=\"receipt.payload.payments.prepaid\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Постоплатой\"\n                                                label-for=\"paymentPostpaid\"\n                                                description=\"тег 1216\"\n                                            >\n                                                <b-form-input\n                                                    id=\"paymentPostpaid\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    placeholder=\"0\"\n                                                    v-model.number=\"receipt.payload.payments.postpaid\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Встр. предст.\"\n                                                label-for=\"paymentOther\"\n                                                description=\"тег 1217\"\n                                            >\n                                                <b-form-input\n                                                    id=\"paymentOther\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    placeholder=\"0\"\n                                                    v-model.number=\"receipt.payload.payments.other\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                    </b-form-row>\n                                </b-container>\n                            </b-form-group>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n\n                <b-card no-body class=\"mb-1\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-vats variant=\"info\">НДС на чек</b-button>\n                    </b-card-header>\n                    <b-collapse id=\"receipt-vats\" accordion=\"receipt-accordion\" role=\"tabpanel\">\n                        <b-card-body>\n                            <b-card-text>\n                                Необходимо передать либо сумму налога на позицию, либо сумму налога на чек. Если будет\n                                переданы и сумма налога на позицию и сумма налога на чек, сервис учтет только сумму\n                                налога на чек.\n                                <span v-if=\"receipt.payload.vats\"\n                                    >В данный момент используются суммы налога на чек. Для возврата к использованию сумм\n                                    налога на позицию, очистите все поля в этом разделе.</span\n                                >\n                                <span v-else\n                                    >В данный момент используются суммы налога на позицию. В полях ниже можно увидеть их\n                                    расчетные величины.</span\n                                >\n                            </b-card-text>\n                            <b-form-group :disabled=\"receipt.state !== 0\">\n                                <b-container fluid>\n                                    <b-form-row class=\"my-1\">\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Сумма расчета по чеку без НДС\"\n                                                label-for=\"withoutVat\"\n                                                description=\"тег 1105\"\n                                            >\n                                                <b-form-input\n                                                    id=\"withoutVat\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"vatsPlaceholder.without_vat\"\n                                                    v-model.number=\"vatsWithoutVat\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Сумма расчета по чеку с НДС 0%\"\n                                                label-for=\"withVat0\"\n                                                description=\"тег 1104\"\n                                            >\n                                                <b-form-input\n                                                    id=\"withVat0\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"vatsPlaceholder.with_vat0\"\n                                                    v-model.number=\"vatsWithVat0\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Сумма НДС чека по ставке 10%\"\n                                                label-for=\"vat10\"\n                                                description=\"тег 1103\"\n                                            >\n                                                <b-form-input\n                                                    id=\"vat10\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"vatsPlaceholder.vat10\"\n                                                    v-model.number=\"vatsVat10\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Сумма НДС чека по ставке 20%\"\n                                                label-for=\"vat20\"\n                                                description=\"тег 1102\"\n                                            >\n                                                <b-form-input\n                                                    id=\"vat20\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"vatsPlaceholder.vat20\"\n                                                    v-model.number=\"vatsVat20\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Сумма НДС чека по расч. ставке 10/110\"\n                                                label-for=\"vat110\"\n                                                description=\"тег 1107\"\n                                            >\n                                                <b-form-input\n                                                    id=\"vat110\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"vatsPlaceholder.vat110\"\n                                                    v-model.number=\"vatsVat110\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Сумма НДС чека по расч. ставке 20/120\"\n                                                label-for=\"vat120\"\n                                                description=\"тег 1106\"\n                                            >\n                                                <b-form-input\n                                                    id=\"vat120\"\n                                                    type=\"number\"\n                                                    min=\"0\"\n                                                    max=\"42949672.95\"\n                                                    step=\".01\"\n                                                    size=\"sm\"\n                                                    :placeholder=\"vatsPlaceholder.vat120\"\n                                                    v-model.number=\"vatsVat120\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                    </b-form-row>\n                                </b-container>\n                            </b-form-group>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n\n                <b-card no-body class=\"mb-1\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-misc variant=\"info\">Дополнительные реквизиты</b-button>\n                    </b-card-header>\n                    <b-collapse id=\"receipt-misc\" accordion=\"receipt-accordion\" role=\"tabpanel\">\n                        <b-card-body>\n                            <b-form-group :disabled=\"receipt.state !== 0\">\n                                <b-container fluid>\n                                    <b-form-row class=\"my-1\">\n                                        <b-col align-self=\"end\" lg=\"2\" md=\"3\" sm=\"4\">\n                                            <b-form-group\n                                                label=\"Доп. реквизит чека\"\n                                                label-for=\"additionalCheckProps\"\n                                                description=\"тег 1192\"\n                                            >\n                                                <b-form-input\n                                                    id=\"additionalCheckProps\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    maxlength=\"16\"\n                                                    v-model=\"receipt.payload.additional_check_props\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"3\" md=\"5\" sm=\"8\">\n                                            <b-form-group\n                                                label=\"ФИО кассира\"\n                                                label-for=\"cashier\"\n                                                description=\"тег 1021\"\n                                            >\n                                                <b-form-input\n                                                    id=\"cashier\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    maxlength=\"64\"\n                                                    v-model=\"receipt.payload.cashier\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"3\" md=\"4\" sm=\"6\">\n                                            <b-form-group\n                                                label=\"Наим. доп. рекв. пользователя\"\n                                                label-for=\"additionalUserPropsName\"\n                                                description=\"тег 1085\"\n                                            >\n                                                <b-form-input\n                                                    id=\"additionalUserPropsName\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    maxlength=\"64\"\n                                                    v-model=\"model['additional_user_props.name']\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                        <b-col align-self=\"end\" lg=\"4\" md=\"8\" sm=\"12\">\n                                            <b-form-group\n                                                label=\"Знач. доп. рекв. пользователя\"\n                                                label-for=\"additionalUserPropsValue\"\n                                                description=\"тег 1086\"\n                                            >\n                                                <b-form-input\n                                                    id=\"additionalUserPropsValue\"\n                                                    type=\"text\"\n                                                    size=\"sm\"\n                                                    maxlength=\"256\"\n                                                    v-model=\"model['additional_user_props.value']\"\n                                                ></b-form-input>\n                                            </b-form-group>\n                                        </b-col>\n                                    </b-form-row>\n                                </b-container>\n                            </b-form-group>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n\n                <b-card no-body class=\"mb-1\" v-if=\"receipt.result\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-result variant=\"info\">Результат обработки</b-button>\n                    </b-card-header>\n                    <b-collapse id=\"receipt-result\" accordion=\"receipt-accordion\" role=\"tabpanel\">\n                        <b-card-body>\n                            <b-card-sub-title class=\"mb-3\">Информация поставщика</b-card-sub-title>\n                            <b-container fluid>\n                                <b-form-row>\n                                    <b-col class=\"mb-3\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group description=\"Дата и время\">\n                                            {{ formatTime(receipt.result.timestamp) }}\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-3\" lg=\"2\" md=\"3\" sm=\"4\">\n                                        <b-form-group description=\"Внутренний идентификатор\">\n                                            {{ receipt.result.internal_id }}\n                                        </b-form-group>\n                                    </b-col>\n                                </b-form-row>\n                            </b-container>\n                            <b-card-sub-title class=\"mb-3\" v-if=\"receipt.result.payload\"\n                                >Информация ОФД</b-card-sub-title\n                            >\n                            <b-container fluid v-if=\"receipt.result.payload\">\n                                <b-form-row>\n                                    <b-col class=\"mb-3\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group description=\"Дата и время (тег 1012)\">\n                                            {{\n                                                formatTime(receipt.result.payload.receipt_datetime, \"DD.MM.YYYY HH:mm\")\n                                            }}\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-3\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group description=\"Номер смены (тег 1038)\">\n                                            {{ receipt.result.payload.shift_number }}\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-3\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group description=\"Номер чека в смене (тег 1042)\">\n                                            {{ receipt.result.payload.fiscal_receipt_number }}\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-3\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group description=\"Сумма расчета (тег 1020)\">\n                                            {{ receipt.result.payload.total }}\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-3\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group description=\"Рег. номер ККТ (тег 1037)\">\n                                            {{ receipt.result.payload.ecr_registration_number }}\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-3\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group description=\"Номер ФН (тег 1041)\">\n                                            {{ receipt.result.payload.fn_number }}\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-3\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group description=\"Фискальный номер документа (тег 1040)\">\n                                            {{ receipt.result.payload.fiscal_document_number }}\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-3\" lg=\"1\" md=\"2\" sm=\"3\">\n                                        <b-form-group description=\"Фискальный признак документа (тег 1077)\">\n                                            {{ receipt.result.payload.fiscal_document_attribute }}\n                                        </b-form-group>\n                                    </b-col>\n                                    <b-col class=\"mb-3\" lg=\"2\" md=\"3\" sm=\"4\">\n                                        <b-form-group description=\"Адрес сайта ФНС (тег 1060)\">\n                                            <b-link :href=\"resultPayloadFnsSite\" target=\"_blank\">{{\n                                                resultPayloadFnsSite\n                                            }}</b-link>\n                                        </b-form-group>\n                                    </b-col>\n                                </b-form-row>\n                            </b-container>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n\n                <b-card no-body class=\"mb-1\" v-if=\"receipt.id\">\n                    <b-card-header header-tag=\"header\" class=\"p-1\" role=\"tab\">\n                        <b-button block v-b-toggle.receipt-preview variant=\"info\">Просмотр чека</b-button>\n                    </b-card-header>\n                    <b-collapse\n                        id=\"receipt-preview\"\n                        @show=\"showPreview = true\"\n                        accordion=\"receipt-accordion\"\n                        role=\"tabpanel\"\n                    >\n                        <b-card-body class=\"px-0\">\n                            <iframe\n                                v-if=\"showPreview\"\n                                :src=\"FiscalRegistrar.basePath + '/api/v1/receipts/' + receipt.id + '/preview'\"\n                                width=\"100%\"\n                                @load=\"fitContent\"\n                            ></iframe>\n                        </b-card-body>\n                    </b-collapse>\n                </b-card>\n            </div>\n            <b-container fluid>\n                <b-form-row class=\"my-3\">\n                    <b-col sm=\"8\">\n                        <b-button v-if=\"receipt.state === 0\" class=\"mb-1\" type=\"submit\" variant=\"primary\" size=\"sm\"\n                            >Сохранить</b-button\n                        >\n                        <b-button\n                            v-if=\"receipt.id\"\n                            class=\"mb-1\"\n                            variant=\"primary\"\n                            size=\"sm\"\n                            :to=\"{ name: 'new-receipt-from-existing', params: { id: receipt.id } }\"\n                            >Дублировать</b-button\n                        >\n                        <b-button\n                            v-if=\"receipt.state === 0\"\n                            class=\"mb-1\"\n                            variant=\"success\"\n                            size=\"sm\"\n                            @click=\"registerReceipt\"\n                            >Зарегистрировать</b-button\n                        >\n                        <b-button\n                            v-if=\"receipt.state === 1\"\n                            class=\"mb-1\"\n                            variant=\"warning\"\n                            size=\"sm\"\n                            @click=\"syncReceipt\"\n                            >Синхронизировать</b-button\n                        >\n                        <b-button v-if=\"receipt.id\" class=\"mb-1\" size=\"sm\" @click=\"printReceipt\">Распечатать</b-button>\n                        <b-button\n                            v-if=\"receipt.result\"\n                            class=\"mb-1\"\n                            size=\"sm\"\n                            :href=\"receipt.result.payload.ofd_receipt_url\"\n                            target=\"_blank\"\n                            >Просмотреть в ОФД</b-button\n                        >\n                        <b-button\n                            v-if=\"receipt.id && receipt.state === 0\"\n                            class=\"mb-1\"\n                            variant=\"danger\"\n                            size=\"sm\"\n                            @click=\"deleteReceipt\"\n                            >Удалить</b-button\n                        >\n                    </b-col>\n                    <b-col class=\"text-right\" sm=\"4\">\n                        <b-button class=\"mb-1\" size=\"sm\" :to=\"{ name: 'receipts' }\">К списку</b-button>\n                    </b-col>\n                </b-form-row>\n            </b-container>\n        </b-form>\n    </div>\n</template>\n"],"names":["_sfc_main","val","_a","phones","phone","price","quantity","sum","vatType","agent_info","supplier_info","ReceiptItem","Receipt","to","from","receipt","id","asTemplate","isNew","error","msgBag","msg","calc","vats","item","event","printWindow","name","data","_b","key","items","total","vat"],"mappings":"yFACA,MAAAA,EAAA,CACA,MAAA,CAAA,OAAA,UAAA,EAEA,SAAA,CACA,IAAA,CACA,OAAA,KAAA,OAAA,IAAA,CACA,EAEA,OAAA,CACA,OAAA,KAAA,WAAA,KAAA,IAAA,CACA,EAEA,QAAA,CACA,OAAA,OAAA,KAAA,WAAA,KAAA,KAAA,IAAA,KAAA,KAAA,IAAA,IAAA,CAAA,CACA,EAEA,UAAA,CACA,IAAA,UAAA,CACA,OAAA,KAAA,MAAA,iBAAA,GAAA,IACA,EACA,IAAA,SAAAC,EAAA,CACA,KAAA,MAAA,iBAAA,EAAAA,CACA,CACA,EAEA,kBAAA,CACA,IAAA,UAAA,OACA,OAAAC,EAAA,KAAA,MAAA,gCAAA,IAAA,YAAAA,EAAA,KAAA;AAAA,EACA,EACA,IAAA,SAAAC,EAAA,CACAA,EAAAA,EACA,MAAA;AAAA,CAAA,EACA,IAAAC,GAAAA,EAAA,KAAA,CAAA,EACA,OAAAA,GAAAA,GAAA,MAAAA,IAAA,EAAA,EACA,KAAA,MAAA,gCAAA,EAAAD,EAAA,OAAAA,EAAA,IACA,CACA,EAEA,8BAAA,CACA,IAAA,UAAA,OACA,OAAAD,EAAA,KAAA,MAAA,6CAAA,IAAA,YAAAA,EAAA,KAAA;AAAA,EACA,EACA,IAAA,SAAAC,EAAA,CACAA,EAAAA,EACA,MAAA;AAAA,CAAA,EACA,IAAAC,GAAAA,EAAA,KAAA,CAAA,EACA,OAAAA,GAAAA,GAAA,MAAAA,IAAA,EAAA,EACA,KAAA,MAAA,6CAAA,EAAAD,EAAA,OAAAA,EAAA,IACA,CACA,EAEA,4BAAA,CACA,IAAA,UAAA,OACA,OAAAD,EAAA,KAAA,MAAA,2CAAA,IAAA,YAAAA,EAAA,KAAA;AAAA,EACA,EACA,IAAA,SAAAC,EAAA,CACAA,EAAAA,EACA,MAAA;AAAA,CAAA,EACA,IAAAC,GAAAA,EAAA,KAAA,CAAA,EACA,OAAAA,GAAAA,GAAA,MAAAA,IAAA,EAAA,EACA,KAAA,MAAA,2CAAA,EAAAD,EAAA,OAAAA,EAAA,IACA,CACA,EAEA,eAAA,CACA,IAAA,UAAA,OACA,OAAAD,EAAA,KAAA,MAAA,sBAAA,IAAA,YAAAA,EAAA,KAAA;AAAA,EACA,EACA,IAAA,SAAAC,EAAA,CACAA,EAAAA,EACA,MAAA;AAAA,CAAA,EACA,IAAAC,GAAAA,EAAA,KAAA,CAAA,EACA,OAAAA,GAAAA,GAAA,MAAAA,IAAA,EAAA,EACA,KAAA,MAAA,sBAAA,EAAAD,EAAA,OAAAA,EAAA,IACA,CACA,CACA,EAEA,MAAA,CACA,aAAA,SAAAE,EAAA,CACA,KAAA,KAAA,IAAAA,EAAA,KAAA,KAAA,QACA,EAEA,gBAAA,SAAAC,EAAA,CACA,KAAA,KAAA,IAAA,KAAA,KAAA,MAAAA,CACA,EAEA,WAAA,SAAAC,EAAA,CACA,KAAA,KAAA,IAAA,IAAA,KAAA,WAAAA,EAAA,KAAA,KAAA,IAAA,IAAA,CACA,EAEA,gBAAA,SAAAC,EAAA,CACA,KAAA,KAAA,IAAA,IAAA,KAAA,WAAA,KAAA,KAAA,IAAAA,CAAA,CACA,EAEA,kBAAA,CACA,QAAA,SAAAC,EAAA,CACA,KAAA,KAAA,YAAAA,GAAA,YAAAA,EAAA,QAAA,KAAA,KAAA,KAAA,QAAAA,CAAA,CACA,EACA,KAAA,EACA,EAEA,qBAAA,CACA,QAAA,SAAAC,EAAA,CACA,KAAA,KAAA,eAAAA,GAAA,YAAAA,EAAA,QAAA,KAAA,KAAA,KAAA,QAAAA,CAAA,CACA,EACA,KAAA,EACA,CACA,CACA,82XC1GAV,EAAA,CACA,WAAA,CACA,YAAAW,CACA,EAEA,MAAA,CACA,MAAA,CACA,MAAA,GACA,YAAA,GACA,QAAA,IAAAC,EACA,KAAA,CACA,YAAA,KACA,UAAA,KACA,MAAA,KACA,MAAA,KACA,OAAA,KACA,OAAA,IACA,EACA,UAAA,CACA,KAAA,KACA,aAAA,CACA,UAAA,KACA,OAAA,IACA,EACA,0BAAA,CACA,OAAA,IACA,EACA,wBAAA,CACA,OAAA,KACA,KAAA,KACA,QAAA,KACA,IAAA,IACA,CACA,CACA,CACA,EAEA,SAAA,CACA,KAAA,YAAA,KAAA,MAAA,EACA,KAAA,gBAAA,EACA,KAAA,aAAA,CACA,EAEA,QAAA,CACA,MAAA,YAAAC,EAAAC,EAAA,KAAA,CACA,OAAAD,EAAA,KAAA,CACA,IAAA,UACA,MAAA,KAAA,YAAAA,EAAA,OAAA,EAAA,EACA,MACA,IAAA,cACA,KAAA,aAAA,EACA,MACA,IAAA,4BACAC,IAAA,MAAAA,EAAA,OAAA,WAAA,CAAAD,EAAA,OAAA,IAAA,CAAAC,EAAA,OAAA,GACA,KAAA,cAAA,EACA,MAAA,KAAA,YAAAD,EAAA,OAAA,GAAA,EAAA,CACA,CACA,EAEA,cAAA,CACA,KAAA,MAAA,OAAA,qBAAAE,GAAA,CACAA,EAAA,KAAA,KAAA,QAAA,KACA,KAAA,QAAAA,EAEA,CAAA,CACA,EAEA,cAAA,CACA,KAAA,QAAA,IAAAH,EAAA,CACA,GAAA,KACA,MAAA,EACA,WAAA,KACA,UAAA,KACA,YAAA,KACA,YAAA,KACA,QAAA,CACA,OAAA,CACA,MAAA,KACA,MAAA,KACA,KAAA,KACA,IAAA,IACA,EACA,QAAA,CACA,KAAA,KACA,MAAA,KACA,IAAA,KACA,gBAAA,KACA,aAAA,KACA,WAAA,IACA,EACA,WAAA,KACA,cAAA,KACA,MAAA,CAAA,EACA,SAAA,CACA,KAAA,EACA,WAAA,EACA,QAAA,EACA,SAAA,EACA,MAAA,CACA,EACA,KAAA,KACA,MAAA,EACA,uBAAA,KACA,QAAA,KACA,sBAAA,IACA,EACA,OAAA,IACA,CAAA,EACA,KAAA,MAAA,EACA,EAEA,eAAA,CACA,KAAA,QAAA,GAAA,KACA,KAAA,QAAA,MAAA,EACA,KAAA,QAAA,YAAA,KACA,KAAA,QAAA,YAAA,KACA,KAAA,QAAA,OAAA,IACA,EAEA,MAAA,YAAAI,EAAAC,EAAA,GAAA,CACA,KAAA,MAAA,GACA,KAAA,QAAA,MAAAL,EAAA,KAAAI,CAAA,EACAC,GAAA,KAAA,gBACA,KAAA,MAAA,EACA,EAEA,MAAA,aAAA,CACA,GAAA,CACA,MAAAC,EAAA,CAAA,KAAA,QAAA,GACA,KAAA,QAAA,MAAA,KAAA,QAAA,KAAA,EACAA,GAAA,KAAA,QAAA,QAAA,CAAA,KAAA,UAAA,OAAA,CAAA,GAAA,KAAA,QAAA,EAAA,CAAA,CAAA,CACA,OAAAC,EAAA,CACA,OAAA,OAAAA,EAAA,SAAA,KAAA,MAAA,EAAA,QAAAC,GACA,KAAA,SAAA,MACAA,EAAA,IAAAC,GAAA,KAAA,eAAA,MAAAA,CAAA,CAAA,EACA,CACA,QAAA,yBACA,QAAA,SACA,MAAA,GACA,cAAA,EACA,CACA,CACA,CACA,CACA,EAEA,MAAA,iBAAA,CACA,MAAA,KAAA,cACA,KAAA,QAAA,MAAA,KAAA,QAAA,SAAA,CACA,EAEA,MAAA,aAAA,CACA,MAAA,KAAA,QAAA,MACA,EAEA,MAAA,eAAA,CACA,QAAA,cAAA,IACA,MAAA,KAAA,QAAA,SACA,KAAA,QAAA,QAAA,CAAA,KAAA,UAAA,CAAA,EAEA,EAEA,SAAA,CACA,KAAA,QAAA,QAAA,MAAA,KAAA,CACA,WAAA,KACA,aAAA,KACA,mBAAA,KACA,OAAA,KACA,iBAAA,KACA,KAAA,GACA,kBAAA,KACA,eAAA,kBACA,eAAA,YACA,MAAA,KACA,SAAA,EACA,IAAA,KACA,cAAA,KACA,UAAA,KACA,IAAA,CACA,IAAA,KACA,KAAA,OACA,CACA,CAAA,CACA,EAEA,WAAAL,EAAA,CACA,KAAA,QAAA,QAAA,MAAA,OAAAA,EAAA,CAAA,CACA,EAEA,QAAAM,EAAA,GAAA,CACA,MAAAC,EAAA,CACA,YAAA,EACA,UAAA,EACA,MAAA,EACA,MAAA,EACA,OAAA,EACA,OAAA,CACA,EAEA,GAAAD,EACA,UAAAE,KAAA,KAAA,QAAA,QAAA,MACA,QAAAA,GAAA,YAAAA,EAAA,IAAA,OAAA,OAAA,CACA,IAAA,QACA,IAAA,QACAD,EAAA,OAAA,KAAA,WAAAC,EAAA,IAAAA,EAAA,IAAA,IAAA,EACA,MACA,IAAA,QACAD,EAAA,OAAA,KAAA,WAAAC,EAAA,IAAAA,EAAA,IAAA,IAAA,EACA,MACA,IAAA,OACAD,EAAA,WAAAC,EAAA,IACA,MACA,IAAA,OACAD,EAAA,aAAAC,EAAA,IACA,MACA,IAAA,SACA,IAAA,SACAD,EAAA,QAAA,KAAA,WAAAC,EAAA,IAAAA,EAAA,IAAA,IAAA,EACA,MACA,IAAA,SACAD,EAAA,QAAA,KAAA,WAAAC,EAAA,IAAAA,EAAA,IAAA,IAAA,CACA,CAIA,OAAAD,CACA,EAEA,WAAAE,EAAA,CACAA,EAAA,OAAA,MAAA,OAAAA,EAAA,OAAA,gBAAA,KAAA,aAAA,GAAA,IACA,EAEA,cAAA,CACA,IAAAC,EAAA,OAAA,KACA,OAAA,gBAAA,SAAA,oBAAA,KAAA,QAAA,GAAA,WACA,iBACA,6BACA,EACAA,EAAA,aAAAA,EAAA,MACAA,EAAA,OAAA,UAAA,CACAA,EAAA,WAAAA,EAAA,KAAA,CACA,CACA,CACA,EAEA,SAAA,CACA,OAAA,CAEA,OADA,KAAA,QAAA,GAAA,KAAA,QAAA,QAAA,EAAA,iBAAA,WAAA,YACA,iBACA,EAEA,OAAA,CACA,OAAA,KAAA,WAAA,KAAA,QAAA,OAAA,CACA,EAEA,mBAAA,CACA,MAAA,CACA,CAAA,MAAA,KAAA,KAAA,iBAAA,EACA,GAAA,KAAA,aAAA,KAAA,YAAA,CAAA,CAAAC,EAAAC,CAAA,KAAA,CAAA,MAAAD,EAAA,KAAAC,EAAA,YAAA,EAAA,CACA,CACA,EAEA,uBAAA,CACA,MAAA,CAAA,KAAA,QAAA,QAAA,OAAA,KACA,EAEA,uBAAA,CACA,MAAA,CAAA,KAAA,QAAA,QAAA,OAAA,KACA,EAEA,yBAAA,SACA,QAAAC,GAAA3B,EAAA,KAAA,YAAA,KAAA,QAAA,UAAA,IAAA,YAAAA,EAAA,UAAA,YAAA2B,EAAA,QAAA,oBACA,EAEA,wBAAA,SACA,QAAAA,GAAA3B,EAAA,KAAA,YAAA,KAAA,QAAA,UAAA,IAAA,YAAAA,EAAA,UAAA,YAAA2B,EAAA,OAAA,qBACA,EAEA,uBAAA,SACA,QAAAA,GAAA3B,EAAA,KAAA,YAAA,KAAA,QAAA,UAAA,IAAA,YAAAA,EAAA,UAAA,YAAA2B,EAAA,MAAA,YACA,EAEA,+BAAA,SACA,QAAAA,GAAA3B,EAAA,KAAA,YAAA,KAAA,QAAA,UAAA,IAAA,YAAAA,EAAA,UAAA,YAAA2B,EAAA,eAAA,wBACA,EAEA,kCAAA,SACA,QAAAA,GAAA3B,EAAA,KAAA,YAAA,KAAA,QAAA,UAAA,IAAA,YAAAA,EAAA,UAAA,YAAA2B,EAAA,kBAAA,EACA,EAEA,iBAAA,CACA,OAAA,OAAA,YACA,OAAA,QAAA,KAAA,QAAA,CAAA,KAAA,QAAA,QAAA,IAAA,CAAA,EAAA,IAAA,CAAA,CAAAC,EAAA7B,CAAA,IAAA,CAAA6B,EAAA,OAAA7B,CAAA,CAAA,CAAA,CACA,CACA,EAEA,eAAA,CACA,IAAA,UAAA,OACA,QAAAC,EAAA,KAAA,QAAA,QAAA,OAAA,YAAAA,EAAA,cAAA,IACA,EACA,IAAA,SAAAD,EAAA,QACAC,EAAA,KAAA,QAAA,SAAA,OAAAA,EAAA,KAAA,KAAA,MACA,KAAA,QAAA,QAAA,KAAA,YAAAD,GAAA,IACA,CACA,EAEA,aAAA,CACA,IAAA,UAAA,OACA,QAAAC,EAAA,KAAA,QAAA,QAAA,OAAA,YAAAA,EAAA,YAAA,IACA,EACA,IAAA,SAAAD,EAAA,QACAC,EAAA,KAAA,QAAA,SAAA,OAAAA,EAAA,KAAA,KAAA,MACA,KAAA,QAAA,QAAA,KAAA,UAAAD,GAAA,IACA,CACA,EAEA,UAAA,CACA,IAAA,UAAA,OACA,QAAAC,EAAA,KAAA,QAAA,QAAA,OAAA,YAAAA,EAAA,QAAA,IACA,EACA,IAAA,SAAAD,EAAA,QACAC,EAAA,KAAA,QAAA,SAAA,OAAAA,EAAA,KAAA,KAAA,MACA,KAAA,QAAA,QAAA,KAAA,MAAAD,GAAA,IACA,CACA,EAEA,UAAA,CACA,IAAA,UAAA,OACA,QAAAC,EAAA,KAAA,QAAA,QAAA,OAAA,YAAAA,EAAA,QAAA,IACA,EACA,IAAA,SAAAD,EAAA,QACAC,EAAA,KAAA,QAAA,SAAA,OAAAA,EAAA,KAAA,KAAA,MACA,KAAA,QAAA,QAAA,KAAA,MAAAD,GAAA,IACA,CACA,EAEA,WAAA,CACA,IAAA,UAAA,OACA,QAAAC,EAAA,KAAA,QAAA,QAAA,OAAA,YAAAA,EAAA,SAAA,IACA,EACA,IAAA,SAAAD,EAAA,QACAC,EAAA,KAAA,QAAA,SAAA,OAAAA,EAAA,KAAA,KAAA,MACA,KAAA,QAAA,QAAA,KAAA,OAAAD,GAAA,IACA,CACA,EAEA,WAAA,CACA,IAAA,UAAA,OACA,QAAAC,EAAA,KAAA,QAAA,QAAA,OAAA,YAAAA,EAAA,SAAA,IACA,EACA,IAAA,SAAAD,EAAA,QACAC,EAAA,KAAA,QAAA,SAAA,OAAAA,EAAA,KAAA,KAAA,MACA,KAAA,QAAA,QAAA,KAAA,OAAAD,GAAA,IACA,CACA,EAEA,UAAA,CACA,IAAA,UAAA,OACA,QAAAC,EAAA,KAAA,QAAA,QAAA,aAAA,YAAAA,EAAA,OAAA,IACA,EACA,IAAA,SAAAD,EAAA,QACAC,EAAA,KAAA,QAAA,SAAA,aAAAA,EAAA,WAAA,KAAA,WACA,KAAA,QAAA,QAAA,WAAA,KAAAD,GAAA,IACA,CACA,EAEA,kBAAA,CACA,IAAA,UAAA,OACA,OAAAC,EAAA,KAAA,MAAA,gCAAA,IAAA,YAAAA,EAAA,KAAA;AAAA,EACA,EACA,IAAA,SAAAC,EAAA,CACAA,EAAAA,EACA,MAAA;AAAA,CAAA,EACA,IAAAC,GAAAA,EAAA,KAAA,CAAA,EACA,OAAAA,GAAAA,GAAA,MAAAA,IAAA,EAAA,EACA,KAAA,MAAA,gCAAA,EAAAD,EAAA,OAAAA,EAAA,IACA,CACA,EAEA,8BAAA,CACA,IAAA,UAAA,OACA,OAAAD,EAAA,KAAA,MAAA,6CAAA,IAAA,YAAAA,EAAA,KAAA;AAAA,EACA,EACA,IAAA,SAAAC,EAAA,CACAA,EAAAA,EACA,MAAA;AAAA,CAAA,EACA,IAAAC,GAAAA,EAAA,KAAA,CAAA,EACA,OAAAA,GAAAA,GAAA,MAAAA,IAAA,EAAA,EACA,KAAA,MAAA,6CAAA,EAAAD,EAAA,OAAAA,EAAA,IACA,CACA,EAEA,4BAAA,CACA,IAAA,UAAA,OACA,OAAAD,EAAA,KAAA,MAAA,2CAAA,IAAA,YAAAA,EAAA,KAAA;AAAA,EACA,EACA,IAAA,SAAAC,EAAA,CACAA,EAAAA,EACA,MAAA;AAAA,CAAA,EACA,IAAAC,GAAAA,EAAA,KAAA,CAAA,EACA,OAAAA,GAAAA,GAAA,MAAAA,IAAA,EAAA,EACA,KAAA,MAAA,2CAAA,EAAAD,EAAA,OAAAA,EAAA,IACA,CACA,EAEA,eAAA,CACA,IAAA,UAAA,OACA,OAAAD,EAAA,KAAA,MAAA,sBAAA,IAAA,YAAAA,EAAA,KAAA;AAAA,EACA,EACA,IAAA,SAAAC,EAAA,CACAA,EAAAA,EACA,MAAA;AAAA,CAAA,EACA,IAAAC,GAAAA,EAAA,KAAA,CAAA,EACA,OAAAA,GAAAA,GAAA,MAAAA,IAAA,EAAA,EACA,KAAA,MAAA,sBAAA,EAAAD,EAAA,OAAAA,EAAA,IACA,CACA,EAEA,sBAAA,CACA,MAAA,gBAAA,KAAA,KAAA,QAAA,OAAA,QAAA,QAAA,EACA,KAAA,QAAA,OAAA,QAAA,SACA,WAAA,KAAA,QAAA,OAAA,QAAA,QACA,CACA,EAEA,MAAA,CACA,OAAAU,EAAAC,EAAA,CACA,KAAA,YAAAD,EAAAC,CAAA,CACA,EAEA,wBAAA,CACA,QAAA,SAAAiB,EAAA,CACA,KAAA,QAAA,QAAA,MAAAA,EAAA,OAAA,CAAAC,EAAAR,IAAAQ,EAAAR,EAAA,IAAA,CAAA,CACA,EACA,KAAA,EACA,EAEA,uBAAA,CACA,QAAA,SAAAD,EAAA,CACAA,IAAA,MACA,OAAA,OAAAA,CAAA,EAAA,MAAAU,GAAAA,IAAA,IAAA,IAAA,KAAA,QAAA,QAAA,KAAA,KACA,EACA,KAAA,EACA,EAEA,6BAAA,CACA,QAAA,SAAAxB,EAAA,CACA,KAAA,QAAA,QAAA,YAAAA,GAAA,YAAAA,EAAA,QAAA,KAAA,KAAA,KAAA,QAAAA,CAAA,CACA,EACA,KAAA,EACA,CACA,CACA;;;;;;;;"}