import{n as s,R as n}from"./_plugin-vue2_normalizer.6058cad7.js";import"./vendor.18f190ae.js";const o={data(){return{fields:[{key:"id",label:"#",sortable:!0},{key:"created_at",label:"\u0412\u0440\u0435\u043C\u044F",sortable:!0},{key:"connection",label:"\u0421\u043E\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u0435",sortable:!0},{key:"operation",label:"\u0422\u0438\u043F",sortable:!0},{key:"payload.total",label:"\u0421\u0443\u043C\u043C\u0430",sortable:!0},{key:"state",label:"\u0421\u0442\u0430\u0442\u0443\u0441",sortable:!0}],aliases:{"payload.total":"total"},receipts:{},page:1}},mounted(){this.populateQuery(),this.enumConnections(),this.getReceipts()},methods:{populateQuery(){sessionStorage["fiscal-registrar.page"]&&(this.page=+sessionStorage["fiscal-registrar.page"])},async getReceipts(l=null){var r;l&&(this.page=l);const e=new n;Object.entries(this.query.filter).filter(([a,i])=>!!i).forEach(([a,i])=>e.where(a,i));let t=(r=this.aliases[this.query.sort.by])!=null?r:this.query.sort.by;this.query.sort.desc&&(t="-"+t),e.orderBy(t),this.page&&e.page(this.page),this.receipts=await e.get()}},computed:{selectConnections(){return[{value:null,text:"\u043B\u044E\u0431\u043E\u0435"},...this.buildOptions(this.connections,([l,e])=>({value:l,text:e.display_name}))]},selectOperations(){return[{value:null,text:"\u0432\u0441\u0435"},...this.buildOptions(this.dictionary.operations)]},selectStates(){return[{value:null,text:"\u043B\u044E\u0431\u043E\u0439"},...this.buildOptions(this.dictionary.states)]}},watch:{query:{handler:function(l){this.getReceipts(1)},deep:!0},page:function(l){sessionStorage["fiscal-registrar.page"]=l}}};var c=function(){var e=this,t=e._self._c;return t("div",[t("h2",{staticClass:"text-center"},[e._v("\u041A\u0430\u0441\u0441\u043E\u0432\u044B\u0435 \u0447\u0435\u043A\u0438")]),e.query.hideFilter?e._e():t("b-form-group",[t("b-container",{attrs:{fluid:""}},[t("b-form-row",{staticClass:"my-1"},[t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u041F\u043E\u0440\u044F\u0434\u043A\u043E\u0432\u044B\u0439 \u043D\u043E\u043C\u0435\u0440","label-for":"receiptId"}},[t("b-form-input",{attrs:{id:"receiptId",type:"number",size:"sm",debounce:"500"},model:{value:e.query.filter.id,callback:function(r){e.$set(e.query.filter,"id",e._n(r))},expression:"query.filter.id"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0423\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u044B\u0439 \u0438\u0434\u0435\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u043E\u0440","label-for":"receiptExternalId"}},[t("b-form-input",{attrs:{id:"receiptExternalId",type:"text",size:"sm",debounce:"500"},model:{value:e.query.filter.external_id,callback:function(r){e.$set(e.query.filter,"external_id",r)},expression:"query.filter.external_id"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0418\u0434\u0435\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u043E\u0440 \u043F\u043E\u0441\u0442\u0430\u0432\u0449\u0438\u043A\u0430","label-for":"receiptInternalId"}},[t("b-form-input",{attrs:{id:"receiptInternalId",type:"text",size:"sm",debounce:"500"},model:{value:e.query.filter.internal_id,callback:function(r){e.$set(e.query.filter,"internal_id",r)},expression:"query.filter.internal_id"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0412\u0440\u0435\u043C\u044F \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F \u043E\u0442","label-for":"receiptCreatedFrom"}},[t("b-form-input",{attrs:{id:"receiptCreatedFrom",type:"datetime-local",size:"sm"},model:{value:e.query.filter.created_from,callback:function(r){e.$set(e.query.filter,"created_from",r)},expression:"query.filter.created_from"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0412\u0440\u0435\u043C\u044F \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F \u0434\u043E","label-for":"receiptCreatedTo"}},[t("b-form-input",{attrs:{id:"receiptCreatedTo",type:"datetime-local",size:"sm"},model:{value:e.query.filter.created_to,callback:function(r){e.$set(e.query.filter,"created_to",r)},expression:"query.filter.created_to"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0421\u043E\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u0435","label-for":"receiptConnection"}},[t("b-form-select",{attrs:{id:"receiptConnection",size:"sm",options:e.selectConnections},model:{value:e.query.filter.connection,callback:function(r){e.$set(e.query.filter,"connection",r)},expression:"query.filter.connection"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u041E\u043F\u0435\u0440\u0430\u0446\u0438\u044F","label-for":"receiptOperation"}},[t("b-form-select",{attrs:{id:"receiptOperation",size:"sm",options:e.selectOperations},model:{value:e.query.filter.operation,callback:function(r){e.$set(e.query.filter,"operation",r)},expression:"query.filter.operation"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0421\u0443\u043C\u043C\u0430 \u043E\u0442","label-for":"receiptMinTotal"}},[t("b-form-input",{attrs:{id:"receiptMinTotal",type:"number",min:"0",max:e.query.filter.max_total||4294967295e-2,step:".01",size:"sm",debounce:"500"},model:{value:e.query.filter.min_total,callback:function(r){e.$set(e.query.filter,"min_total",e._n(r))},expression:"query.filter.min_total"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0421\u0443\u043C\u043C\u0430 \u0434\u043E","label-for":"receiptMaxTotal"}},[t("b-form-input",{attrs:{id:"receiptMaxTotal",type:"number",min:e.query.filter.min_total||0,max:"42949672.95",step:".01",size:"sm",debounce:"500"},model:{value:e.query.filter.max_total,callback:function(r){e.$set(e.query.filter,"max_total",e._n(r))},expression:"query.filter.max_total"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0421\u0442\u0430\u0442\u0443\u0441","label-for":"receiptState"}},[t("b-form-select",{attrs:{id:"receiptState",size:"sm",options:e.selectStates},model:{value:e.query.filter.state,callback:function(r){e.$set(e.query.filter,"state",r)},expression:"query.filter.state"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"E-mail \u043A\u043B\u0438\u0435\u043D\u0442\u0430","label-for":"receiptClientEmail"}},[t("b-form-input",{attrs:{id:"receiptClientEmail",type:"email",size:"sm",placeholder:"user@domain.com",debounce:"500"},model:{value:e.query.filter.email,callback:function(r){e.$set(e.query.filter,"email",r)},expression:"query.filter.email"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D \u043A\u043B\u0438\u0435\u043D\u0442\u0430","label-for":"receiptClientPhone"}},[t("b-form-input",{attrs:{id:"receiptClientPhone",type:"tel",size:"sm",placeholder:"+79001234567",debounce:"500"},model:{value:e.query.filter.phone,callback:function(r){e.$set(e.query.filter,"phone",r)},expression:"query.filter.phone"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0424\u041D","label-for":"receiptFnNumber"}},[t("b-form-input",{attrs:{id:"receiptFnNumber",type:"number",size:"sm",debounce:"500"},model:{value:e.query.filter.fn,callback:function(r){e.$set(e.query.filter,"fn",e._n(r))},expression:"query.filter.fn"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0424\u0414 \u2116","label-for":"receiptFiscalDocumentNumber"}},[t("b-form-input",{attrs:{id:"receiptFiscalDocumentNumber",type:"number",size:"sm",debounce:"500"},model:{value:e.query.filter.i,callback:function(r){e.$set(e.query.filter,"i",e._n(r))},expression:"query.filter.i"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{attrs:{label:"\u0424\u041F\u0414","label-for":"receiptFiscalDocumentAttribute"}},[t("b-form-input",{attrs:{id:"receiptFiscalDocumentAttribute",type:"number",size:"sm",debounce:"500"},model:{value:e.query.filter.fd,callback:function(r){e.$set(e.query.filter,"fd",e._n(r))},expression:"query.filter.fd"}})],1)],1),t("b-col",{attrs:{"align-self":"end",lg:"2",md:"3",sm:"4"}},[t("b-form-group",{staticClass:"text-center"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:e.resetFilter}},[e._v("\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C \u0444\u0438\u043B\u044C\u0442\u0440")])],1)],1)],1)],1)],1),t("b-table",{attrs:{small:"",striped:"",hover:"",items:e.receipts.data,fields:e.fields,"no-local-sorting":"","sort-by":e.query.sort.by,"sort-desc":e.query.sort.desc},on:{"update:sortBy":function(r){return e.$set(e.query.sort,"by",r)},"update:sort-by":function(r){return e.$set(e.query.sort,"by",r)},"update:sortDesc":function(r){return e.$set(e.query.sort,"desc",r)},"update:sort-desc":function(r){return e.$set(e.query.sort,"desc",r)}},scopedSlots:e._u([{key:"cell(id)",fn:function(r){return[t("b-link",{attrs:{to:{name:"receipt",params:{id:r.value}}}},[e._v(e._s(r.value))])]}},{key:"cell(created_at)",fn:function(r){return[e._v(" "+e._s(e.formatTime(r.value))+" ")]}},{key:"cell(connection)",fn:function(r){return[e._v(" "+e._s(r.value?e.connections[r.value].display_name:"-")+" ")]}},{key:"cell(operation)",fn:function(r){return[e._v(" "+e._s(r.value?e.dictionary.operations[r.value]:"-")+" ")]}},{key:"cell(payload.total)",fn:function(r){return[t("div",{staticClass:"text-right"},[e._v(e._s(r.value))])]}},{key:"cell(state)",fn:function(r){return[e._v(" "+e._s(e.dictionary.states[r.value])+" ")]}}])}),t("pagination",{attrs:{data:e.receipts,limit:2,"show-disabled":!0,align:"center"},on:{"pagination-change-page":e.getReceipts}}),e.query.hideCreateButton?e._e():t("b-button",{attrs:{to:{name:"new-receipt"},variant:"primary",size:"sm"}},[e._v("\u0421\u043E\u0437\u0434\u0430\u0442\u044C")])],1)},u=[],f=s(o,c,u,!1,null,null,null,null);const d=f.exports;export{d as default};
